<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="_suplerCeart">
	<!--
     * SQL 명      : _suplerCeart.buyingRequestListCount
     * 기능(설명)  : 견적요청서 관리 목록 조회 총 건수
     * 작   성   자  : (주)엔키소프트
     * 작   성   일  : 2017-01-05
    -->
	<select id="buyingRequestListCount" parameterType="map" resultType="int">
	    /* 공급자씨앗 > 상세정보(견적)요청 답변관리 - 리스트카운트(/korean/pt/suplerCeart/BD_buyingRequestList.do) */ 
	    /*_suplerCeart.buyingRequestListCnt*/
        SELECT COUNT(1) AS totalCount 
          FROM TCN_NOTIFY_SPLY_I A
    INNER JOIN TCN_BID_NOTIFY_I B
            ON A.NOTIFY_NUM = B.NOTIFY_NUM
           AND A.NOTIFY_SEQ = B.NOTIFY_SEQ
     LEFT JOIN TCM_WISHORDER_INFO_I C
            ON B.USER_ID = C.USER_ID
           AND B.GRP_SEQ = C.GRP_SEQ
     LEFT JOIN TUM_SVC_STOR_I D
            ON B.USER_ID   = D.USER_ID
           AND D.LANG_CODE = #{langCode}
     LEFT JOIN TST_GOOD_INFO_I E
            ON A.GOODS_CODE = E.GOODS_CODE
         WHERE A.USER_ID    = #{suplerId}
         <choose>
             <when test="searchDiv01 == 1001">
                 <if test="searchKeyWord != null  and searchKeyWord != ''">
                     AND C.AUDITLOG_NM LIKE '%'||#{searchKeyWord}||'%'
                 </if>
             </when>
             <when test="searchDiv01 == 1002">
                 <if test="searchKeyWord != null  and searchKeyWord != ''">
                     AND B.REAL_DMND_ORGN LIKE '%'||#{searchKeyWord}||'%'
                 </if>
             </when>
         </choose>
         <if test="searchDiv02 != null  and searchDiv02 != ''">
             AND A.ASK_APPLY_CD = #{searchDiv02}
         </if>
    </select>

	<!--
     * SQL 명      : _suplerCeart.buyingRequestList
     * 기능(설명)  : 견적요청서 관리 목록 조회
     * 작   성   자  : (주)엔키소프트
     * 작   성   일  : 2017-01-05
    -->
    <select id="buyingRequestList" parameterType="map" resultType="SuplerCeartVO">
    	/* 공급자씨앗 > 상세정보(견적)요청 답변관리 - 리스트(/korean/pt/suplerCeart/BD_buyingRequestList.do) */
    	/*_suplerCeart.buyingRequestList*/
        SELECT Y.* 
          FROM (SELECT ROWNUM NUM
                     , X.*
                  FROM (
                        SELECT A.NOTIFY_NUM                     AS notifyNum
                             , A.NOTIFY_SEQ                     AS notifySeq
                             , B.USER_ID                        AS endsUserId
                             , #{suplerId}                      AS suplerId
                             , C.AUDITLOG_NM                    AS auditlogNm
                             , A.GOODS_CODE                     AS goodsCode
                             , DECODE(E.GOODS_KND_CD, '1001','PaaS', '1002','SaaS', '1003','IaaS', '1004','SCS') AS goodsKndCd /* 구분*/
                             , E.GOODS_NM                       AS goodsNm
                             , NVL(A.BID_FINISH_GBN, 'N')       AS bidFinishGbn
                             , D.LANG_STORE_NM                  AS endsStoreNm
                             , B.REAL_DMND_ORGN                 AS realDmndOrgn
                             , TO_CHAR(B.RPLY_DT, 'YYYY-MM-DD') AS rplyDt
                             , A.ASK_APPLY_CD                   AS askApplyCd
                             , F.INDVDLZ_CD_NM                  AS askApplyNm
                             , NVL(A.BID_SUSS_GBN, 'N')         AS bidSussGbn
                             , NVL(A.CNTR_GBN, 'N')             AS cntrGbn
                          FROM TCN_NOTIFY_SPLY_I A
                    INNER JOIN TCN_BID_NOTIFY_I B
                            ON A.NOTIFY_NUM = B.NOTIFY_NUM
                           AND A.NOTIFY_SEQ = B.NOTIFY_SEQ
                     LEFT JOIN TCM_WISHORDER_INFO_I C
                            ON B.USER_ID = C.USER_ID
                           AND B.GRP_SEQ = C.GRP_SEQ
                     LEFT JOIN TUM_SVC_STOR_I D
                            ON B.USER_ID   = D.USER_ID
                           AND D.LANG_CODE = #{langCode}
                     LEFT JOIN TST_GOOD_INFO_I E
                            ON A.GOODS_CODE = E.GOODS_CODE
                     LEFT JOIN OP_CODE_INDVDLZ F
                            ON F.GROUP_CD = '2043'
                           AND A.ASK_APPLY_CD = F.INDVDLZ_CD
                         WHERE A.USER_ID    = #{suplerId}
                         <choose>
                             <when test="searchDiv01 == 1001">
                                 <if test="searchKeyWord != null  and searchKeyWord != ''">
                                     AND C.AUDITLOG_NM LIKE '%'||#{searchKeyWord}||'%'
                                 </if>
                             </when>
                             <when test="searchDiv01 == 1002">
                                 <if test="searchKeyWord != null  and searchKeyWord != ''">
                                     AND B.REAL_DMND_ORGN LIKE '%'||#{searchKeyWord}||'%'
                                 </if>
                             </when>
                         </choose>
                         <if test="searchDiv02 != null  and searchDiv02 != ''">
                             AND A.ASK_APPLY_CD = #{searchDiv02}
                         </if>
                         ORDER BY A.NOTIFY_NUM DESC, A.NOTIFY_SEQ DESC
			           ) X WHERE ROWNUM &lt;= #{pagingEndNum}
		    ) Y WHERE NUM &gt;= #{pagingStartNum}
    </select>


	<!--
     * SQL 명      : _suplerCeart.buyingRequestListExcel
     * 기능(설명)  : 견적요청서 관리 목록 조회(엑셀 다운용)
     * 작   성   자  : (주)엔키소프트
     * 작   성   일  : 2017-01-05
    -->
    <select id="buyingRequestListExcel" parameterType="map" resultType="SuplerCeartVO">
    	/*_suplerCeart.buyingRequestListExcel*/
        SELECT A.NOTIFY_NUM                     AS notifyNum
             , A.NOTIFY_SEQ                     AS notifySeq
             , B.USER_ID                        AS endsUserId
             , #{suplerId}                      AS suplerId
             , C.AUDITLOG_NM                    AS auditlogNm
             , A.GOODS_CODE                     AS goodsCode
             , DECODE(E.GOODS_KND_CD, '1001','PaaS', '1002','SaaS', '1003','IaaS', '1004','SCS') AS goodsKndCd /* 구분*/
             , E.GOODS_NM                       AS goodsNm
             , NVL(A.BID_FINISH_GBN, 'N')       AS bidFinishGbn
             , D.LANG_STORE_NM                  AS endsStoreNm
             , B.REAL_DMND_ORGN                 AS realDmndOrgn
             , TO_CHAR(B.RPLY_DT, 'YYYY-MM-DD') AS rplyDt
             , A.ASK_APPLY_CD                   AS askApplyCd
             , F.INDVDLZ_CD_NM                  AS askApplyNm
             , NVL(A.BID_SUSS_GBN, 'N')         AS bidSussGbn
             , NVL(A.CNTR_GBN, 'N')             AS cntrGbn
          FROM TCN_NOTIFY_SPLY_I A
    INNER JOIN TCN_BID_NOTIFY_I B
            ON A.NOTIFY_NUM = B.NOTIFY_NUM
           AND A.NOTIFY_SEQ = B.NOTIFY_SEQ
     LEFT JOIN TCM_WISHORDER_INFO_I C
            ON B.USER_ID = C.USER_ID
           AND B.GRP_SEQ = C.GRP_SEQ
     LEFT JOIN TUM_SVC_STOR_I D
            ON B.USER_ID   = D.USER_ID
           AND D.LANG_CODE = #{langCode}
     LEFT JOIN TST_GOOD_INFO_I E
            ON A.GOODS_CODE = E.GOODS_CODE
     LEFT JOIN OP_CODE_INDVDLZ F
            ON F.GROUP_CD = '2043'
           AND A.ASK_APPLY_CD = F.INDVDLZ_CD
         WHERE A.USER_ID    = #{suplerId}
         <choose>
             <when test="searchDiv01 == 1001">
                 <if test="searchKeyWord != null  and searchKeyWord != ''">
                     AND C.AUDITLOG_NM LIKE '%'||#{searchKeyWord}||'%'
                 </if>
             </when>
             <when test="searchDiv01 == 1002">
                 <if test="searchKeyWord != null  and searchKeyWord != ''">
                     AND D.LANG_STORE_NM LIKE '%'||#{searchKeyWord}||'%'
                 </if>
             </when>
         </choose>
         <if test="searchDiv02 != null  and searchDiv02 != ''">
             AND A.ASK_APPLY_CD = #{searchDiv02}
         </if>
         ORDER BY A.NOTIFY_NUM DESC, A.NOTIFY_SEQ DESC
    </select>

    <!--
     * SQL 명      : _suplerCeart.updateSplyConfmGbn
     * 기능(설명)  : 입찰공고 공급자 확인정보의 확인여부 update
     * 작   성   자  : (주)엔키소프트
     * 작   성   일  : 2017-01-05
    -->
    <update id="updateSplyConfmGbn">
        /*_suplerCeart.updateSplyConfmGbn*/
        UPDATE TCN_NOTIFY_SPLY_I SET CONFM_GBN = 'Y'
         WHERE NOTIFY_NUM = #{notifyNum}
           AND NOTIFY_SEQ = #{notifySeq}
           AND USER_ID    = #{suplerId}
    </update>

    <!--
     * SQL 명      : _suplerCeart.suplerCeartBidNotifyInfo
     * 기능(설명)  : 입찰공고정보 조회 - 공급자씨앗
     * 작   성   자  : (주)엔키소프트
     * 작   성   일  : 2017-01-05
    -->
    <select id="suplerCeartBidNotifyInfo" parameterType="map" resultType="SuplerCeartBidNotifyVO">
    	/* 공급자씨앗 > 상세정보(견적)요청 답변관리 - 아이템클릭(/korean/pt/suplerCeart/BD_requestDetailView.do) - 입찰공고 마스터 조회 */
        /*_suplerCeart.suplerCeartBidNotifyInfo*/
        SELECT A.NOTIFY_NUM                       AS notifyNum
             , A.NOTIFY_SEQ                       AS notifySeq
             , A.BID_GBN_CD                       AS bidGbnCd
             , B.INDVDLZ_CD_NM                    AS bidGbnNm
             , A.GOOD_KND_CD                      AS goodKndCd
             , C.INDVDLZ_CD_NM                    AS goodKndNm
             , A.USER_ID                          AS endsUserId
             , O.USER_NM                          AS endsUserNm 
             , DECRYPT(O.MBTLNUM ,'P007')         AS endsMbtlnum
             , DECRYPT(O.EMAIL,'P008')            AS endsEmail
             , A.GRP_SEQ                          AS grpSeq
             , A.BID_KND_CD                       AS bidKndCd
             , D.INDVDLZ_CD_NM                    AS bidKndNm
             , A.BID_CLASS_CD                     AS bidClassCd
             , E.INDVDLZ_CD_NM                    AS bidClassNm
             , A.CNTR_MOTHOD                      AS cntrMothod
             , F.INDVDLZ_CD_NM                    AS cntrMothodNm
             , A.OPTL_CNTR_FILE                   AS optlCntrFile
             , G.LOCAL_ORGINL_NM                  AS optlCntrFileOrgNm
             , G.FILE_ID                          AS optlCntrFileId
             , G.FILE_SIZE                        AS optlCntrFileSize
             , G.FILE_TY                          AS optlCntrFileTy
             , A.REAL_DMND_ORGN                   AS realDmndOrgn
             , A.GOODS_CHARGER_NM                 AS goodsChargerNm
             , A.GOODS_CHARGER_CTTPC              AS goodsChargerCttpc
             , A.USER_POSITION                    AS userPosition
             , A.LINK_ORGN_URL                    AS linkOrgnUrl
             , A.BID_NOTIFY_NM                    AS bidNotifyNm
             , TO_CHAR(A.STRT_DT, 'YYYY-MM-DD')   AS strtDt
             , TO_CHAR(A.STRT_DT, 'HH24')         AS strtTime
             , TO_CHAR(A.CLSE_DT, 'YYYY-MM-DD')   AS clseDt
             , TO_CHAR(A.CLSE_DT, 'HH24')         AS clseTime
             , TO_CHAR(A.OPEN_DT, 'YYYY-MM-DD')   AS openDt
             , TO_CHAR(A.OPEN_DT, 'HH24')         AS openTime
             , A.AREA_LIMIT1                      AS areaLimit1
             , H.INDVDLZ_CD_NM                    AS areaLimit1Nm
             , A.AREA_LIMIT2                      AS areaLimit2
             , I.INDVDLZ_CD_NM                    AS areaLimit2Nm
             , A.AREA_LIMIT3                      AS areaLimit3
             , J.INDVDLZ_CD_NM                    AS areaLimit3Nm
             , A.CATY_LIMIT_ENTR                  AS catyLimitEntr
             , A.CATY_LIMIT_VNTR                  AS catyLimitVntr
             , A.CATY_LIMIT_SOC                   AS catyLimitSoc
             , A.CATY_LIMIT_WOMN                  AS catyLimitWomn
             , A.CATY_LIMIT_DIAD                  AS catyLimitDiad
             , A.CATY_LIMIT_ETC                   AS catyLimitEtc
             , A.CATY_LIMIT_ETC_COMT              AS catyLimitEtcComt
             , A.HOPE_PUCH_AMT                    AS hopePuchAmt
             , A.VAT_GBN                          AS vatGbn
             , TO_CHAR(A.DELY_DT, 'YYYY-MM-DD')   AS delyDt
             , TO_CHAR(A.DELY_DT, 'HH24')         AS delyTime
             , A.TALK_GBN                         AS talkGbn
             , TO_CHAR(A.RPLY_DT, 'YYYY-MM-DD')   AS rplyDt
             , TO_CHAR(A.RPLY_DT, 'HH24')         AS rplyTime
             , A.DELY_PLAC                        AS delyPlac
             , A.DELY_FILE                        AS delyFile
             , K.LOCAL_ORGINL_NM                  AS delyFileOrgNm
             , K.FILE_ID                          AS delyFileId
             , K.FILE_SIZE                        AS delyFileSize
             , K.FILE_TY                          AS delyFileTy
             , A.NOTIFY_CONT                      AS notifyCont
             , A.BID_PGES_STAT                    AS bidPgesStat
             , L.INDVDLZ_CD_NM                    AS bidPgesStatNm
             , A.BID_CHNG_CAUSE                   AS bidChngCause
             , A.ENTR_DT                          AS entrDt
             , A.UPDT_DT                          AS updtDt
             , TO_CHAR(A.CNCL_DT,'YYYY-MM-DD')    AS cnclDt
             , A.BAFF_NM                          AS baffNm
             , TO_DATE(A.REAL_OPEN_DT,'YYYYMMDD') AS realOpenDt
             , A.REAL_OPEN_TM                     AS realOpenTm
             , M.EVAL_CAUSE                       AS evalCause
             , M.EVAL_SHEET_FILE                  AS evalSheetFile
             , N.LOCAL_ORGINL_NM                  AS evalSheetFileOrgNm
             , N.FILE_ID                          AS evalSheetFileId
             , N.FILE_SIZE                        AS evalSheetFileSize
             , N.FILE_TY                          AS evalSheetFileTy
             , CASE WHEN A.CLSE_DT &lt; SYSDATETIME OR
                         A.BID_PGES_STAT IN ('1004','1005','1006','1007','1011') THEN 'N'
                                                                                 ELSE 'Y'
                                                                                  END extendTermYn /*공고 종료여부*/
          FROM TCN_BID_NOTIFY_I A
               LEFT JOIN OP_CODE_INDVDLZ B
                      ON B.LANG_CODE  = '00'
                     AND B.GROUP_CD   = '2037'
                     AND A.BID_GBN_CD = B.INDVDLZ_CD
               LEFT JOIN OP_CODE_INDVDLZ C
                      ON C.LANG_CODE   = '00'
                     AND C.GROUP_CD    = '1005'
                     AND A.GOOD_KND_CD = C.INDVDLZ_CD
               LEFT JOIN OP_CODE_INDVDLZ D
                      ON D.LANG_CODE  = '00'
                     AND D.GROUP_CD   = '2038'
                     AND A.BID_KND_CD = D.INDVDLZ_CD
               LEFT JOIN OP_CODE_INDVDLZ E
                      ON E.LANG_CODE    = '00'
                     AND E.GROUP_CD     = '2039'
                     AND A.BID_CLASS_CD = E.INDVDLZ_CD
               LEFT JOIN OP_CODE_INDVDLZ F
                      ON F.LANG_CODE   = '00'
                     AND F.GROUP_CD    = '2040'
                     AND A.CNTR_MOTHOD = F.INDVDLZ_CD
               LEFT JOIN OP_FILE G
                      ON A.OPTL_CNTR_FILE = G.FILE_SEQ
               LEFT JOIN OP_CODE_INDVDLZ H
                      ON H.LANG_CODE   = '00'
                     AND H.GROUP_CD    = '2036'
                     AND A.AREA_LIMIT1 = H.INDVDLZ_CD
               LEFT JOIN OP_CODE_INDVDLZ I
                      ON I.LANG_CODE   = '00'
                     AND I.GROUP_CD    = '2036'
                     AND A.AREA_LIMIT2 = I.INDVDLZ_CD
               LEFT JOIN OP_CODE_INDVDLZ J
                      ON J.LANG_CODE   = '00'
                     AND J.GROUP_CD    = '2036'
                     AND A.AREA_LIMIT3 = J.INDVDLZ_CD
               LEFT JOIN OP_FILE K
                      ON A.DELY_FILE = K.FILE_SEQ
               LEFT JOIN OP_CODE_INDVDLZ L
                      ON L.LANG_CODE     = '00'
                     AND L.GROUP_CD      = '2044'
                     AND A.BID_PGES_STAT = L.INDVDLZ_CD
               LEFT JOIN TCN_NOTIFY_SPLY_I M
                      ON A.NOTIFY_NUM = M.NOTIFY_NUM
                     AND A.NOTIFY_SEQ = M.NOTIFY_SEQ
                     AND NVL(M.BID_SUSS_GBN, 'N') = 'Y'
               LEFT JOIN OP_FILE N
                      ON M.EVAL_SHEET_FILE = N.FILE_SEQ
               LEFT JOIN OP_USER O
                      ON A.USER_ID   = O.USER_ID
         WHERE A.NOTIFY_NUM = #{notifyNum}
           AND A.NOTIFY_SEQ = #{notifySeq}
    </select>

    <!--
     * SQL 명      : _suplerCeart.selectSuplerCeartNotifySplyInfo
     * 기능(설명)  : 입찰공고 공급자 확인정보 조회
     * 작   성   자  : (주)엔키소프트
     * 작   성   일  : 2017-01-05
    -->
    <select id="selectSuplerCeartNotifySplyInfo" parameterType="map" resultType="SuplerCeartNotifySplyVO">
    	/* 공급자씨앗 > 상세정보(견적)요청 답변관리 - 아이템클릭(/korean/pt/suplerCeart/BD_requestDetailView.do) - 공급자의 확인정보 조회 */
        /*_suplerCeart.selectSuplerCeartNotifySplyInfo*/
        SELECT A.NOTIFY_NUM                    AS notifyNum
             , A.NOTIFY_SEQ                    AS notifySeq
             , A.USER_ID                       AS suplerId
             , G.LANG_STORE_NM                 AS suplerNm
             , A.GOODS_CODE                    AS goodsCode
             , B.GOODS_NM                      AS goodsName
             , A.CONFM_GBN                     AS confmGbn
             , A.ASK_APPLY_CD                  AS askApplyCd
             , C.INDVDLZ_CD_NM                 AS askApplyNm
             , A.BID_PGES_STAT                 AS bidPgesStat
             , D.INDVDLZ_CD_NM                 AS bidPgesStatNm
             , A.BID_SUSS_GBN                  AS bidSussGbn
             , A.BID_SUSS_DT                   AS bidSussDt
             , A.EVAL_SHEET_FILE               AS evalSheetFile
             , E.LOCAL_ORGINL_NM               AS evalSheetFileOrgNm
             , A.CNTR_GBN                      AS cntrGbn
             , A.SPLY_AMT                      AS splyAmt
             , A.VAT_GBN                       AS vatGbn
             , A.ADD_ANSWER                    AS addAnswer
             , A.SPLY_NOTE                     AS splyNote
             , A.SPLY_FILE                     AS splyFile
             , F.LOCAL_ORGINL_NM               AS splyFileOrgNm
             , F.FILE_ID                       AS splyFileId
             , F.FILE_SIZE                     AS splyFileSize
             , F.FILE_TY                       AS splyFileTy
             , TO_CHAR(A.ENTR_DT,'YYYY-MM-DD') AS entrDt
             , G.STORE_CHARGER_NM              AS storeChargerNm
             , DECRYPT(H.EMAIL,'P008')         AS reprsntEmail
             , G.REPRSNT_TELNO                 AS reprsntTelno
             , DECRYPT(H.MBTLNUM ,'P007')      AS mbtlnum
             , I.BIZRNO                        AS bizrno
          FROM TCN_NOTIFY_SPLY_I A
               INNER JOIN TST_GOOD_INFO_I B
                       ON A.GOODS_CODE = B.GOODS_CODE
                LEFT JOIN OP_CODE_INDVDLZ C
                      ON C.GROUP_CD     = '2043'
                     AND A.ASK_APPLY_CD = C.INDVDLZ_CD
                LEFT JOIN OP_CODE_INDVDLZ D
                      ON D.GROUP_CD      = '2044'
                     AND A.BID_PGES_STAT = D.INDVDLZ_CD
                LEFT JOIN OP_FILE E
                       ON A.EVAL_SHEET_FILE = E.FILE_SEQ
                LEFT JOIN OP_FILE F
                       ON A.SPLY_FILE = F.FILE_SEQ
                LEFT JOIN TUM_SVC_STOR_I G
                       ON A.USER_ID = G.USER_ID
                      AND G.LANG_CODE = '00'
                LEFT JOIN OP_USER H
                       ON A.USER_ID = H.USER_ID
                LEFT JOIN OP_USER_ENTRPRS_OPTION I
                       ON G.USER_ID = I.USER_ID
         WHERE A.NOTIFY_NUM = #{notifyNum}
           AND A.NOTIFY_SEQ = #{notifySeq}
           <if test="suplerId != null  and suplerId != ''">
           AND A.USER_ID    = #{suplerId}
           </if>
         ORDER BY A.ENTR_DT
    </select>

    <!--
     * SQL 명      : _suplerCeart.selectSuplerCeartInfoByPass
     * 기능(설명)  : 상세정보(견적)요청서 PaaS 조회
     * 작   성   자  : (주)엔키소프트
     * 작   성   일  : 2017-01-06
    -->
    <select id="selectSuplerCeartInfoByPass" parameterType="map" resultType="SuplerCeartPaasVO">
        /*_suplerCeart.selectSuplerCeartInfoByPass*/
        SELECT A.NOTIFY_NUM      AS notifyNum
             , A.NOTIFY_SEQ      AS notifySeq
             , A.USER_ID         AS endsUserId
             , #{suplerId}       AS suplerId
             , 'Y'               AS consumerYn
             , A.APPLY_GBN       AS applyGbn
             , A.LANG_SYS        AS langSys
             , A.FRAMEWORK_SYS   AS frameworkSys
             , A.CACHE_SYS       AS cacheSys
             , A.DBMS_SYS        AS dbmsSys
             , A.FAST_DEPLOY_SYS AS fastDeploySys
             , A.ETC_SYS         AS etcSys
          FROM TCN_BID_PAAS_I A
         WHERE A.NOTIFY_NUM = #{notifyNum}
           AND A.NOTIFY_SEQ = #{notifySeq}
           AND A.USER_ID    = #{endsUserId}
        UNION ALL
        SELECT A.NOTIFY_NUM      AS notifyNum
             , A.NOTIFY_SEQ      AS notifySeq
             , A.USER_ID         AS endsUserId
             , B.USER_ID         AS suplerId
             , 'N'               AS consumerYn
             , B.APPLY_GBN       AS applyGbn
             , B.LANG_SYS        AS langSys
             , B.FRAMEWORK_SYS   AS frameworkSys
             , B.CACHE_SYS       AS cacheSys
             , B.DBMS_SYS        AS dbmsSys
             , B.FAST_DEPLOY_SYS AS fastDeploySys
             , B.ETC_SYS         AS etcSys
          FROM TCN_BID_PAAS_I A
               LEFT JOIN TCN_BID_PAAS_I B
                      ON A.NOTIFY_NUM = B.NOTIFY_NUM
                     AND A.NOTIFY_SEQ = B.NOTIFY_SEQ
                     AND B.USER_ID    = #{suplerId}
         WHERE A.NOTIFY_NUM = #{notifyNum}
           AND A.NOTIFY_SEQ = #{notifySeq}
           AND A.USER_ID    = #{endsUserId}
    </select>

    <!--
     * SQL 명        : _suplerCeart.selectSuplerCeartInfoByPass2
     * 기능(설명)    : 상세정보(견적)요청서 PaaS 조회
     * 작   성   자  : 이홍석
     * 작   성   일  : 2018-03
    -->
    <select id="selectSuplerCeartInfoByPass2" parameterType="map" resultType="SuplerCeartPaas2VO">
        /* 공급자씨앗 > 상세정보(견적)요청 답변관리 - 아이템클릭(/korean/pt/suplerCeart/BD_requestDetailView.do) - [Pass2] */
        /*_suplerCeart.selectSuplerCeartInfoByPass2*/          
        
        SELECT A.NOTIFY_NUM      AS notifyNum
              ,A.NOTIFY_SEQ      AS notifySeq
              ,A.USER_ID         AS endsUserId
              ,#{suplerId}       AS suplerId
              ,'Y'               AS consumerYn
              ,A.APPLY_GBN       AS applyGbn
             
              ,A.HOSTINGMETHOD   AS hostingmethod               
              ,A.SCALING         AS scaling         
              ,A.PLATFORM        AS platform          
              ,A.RUNTIMES        AS runtimes          
              ,A.MIDDLEWARE      AS middlewares
              ,A.FRAMEWORKS      AS frameworks            
              ,A.SERVICES        AS services          
              ,A.ADDONS          AS addons        
              ,A.EXTENDFUNCTION  AS extendfunction                
              ,A.GEOLOCATIONS    AS geolocations
          FROM TCN_BID_PAAS2_I A
         WHERE A.NOTIFY_NUM = #{notifyNum}
           AND A.NOTIFY_SEQ = #{notifySeq}
           AND A.USER_ID    = #{endsUserId}
           
        UNION ALL
        
        SELECT A.NOTIFY_NUM      AS notifyNum
              ,A.NOTIFY_SEQ      AS notifySeq
              ,A.USER_ID         AS endsUserId
              ,B.USER_ID         AS suplerId
              ,'N'               AS consumerYn
              ,B.APPLY_GBN       AS applyGbn
             
              ,B.HOSTINGMETHOD   AS hostingmethod               
              ,B.SCALING         AS scaling         
              ,B.PLATFORM        AS platform          
              ,B.RUNTIMES        AS runtimes          
              ,B.MIDDLEWARE      AS middlewares            
              ,B.FRAMEWORKS      AS frameworks            
              ,B.SERVICES        AS services          
              ,B.ADDONS          AS addons        
              ,B.EXTENDFUNCTION  AS extendfunction                
              ,B.GEOLOCATIONS    AS geolocations                
          FROM TCN_BID_PAAS2_I A
     LEFT JOIN TCN_BID_PAAS2_I B
            ON A.NOTIFY_NUM = B.NOTIFY_NUM
           AND A.NOTIFY_SEQ = B.NOTIFY_SEQ
           AND B.USER_ID    = #{suplerId}
         WHERE A.NOTIFY_NUM = #{notifyNum}
           AND A.NOTIFY_SEQ = #{notifySeq}
           AND A.USER_ID    = #{endsUserId}
    </select>

    <!--
     * SQL 명      : _suplerCeart.selectSuplerCeartInfoBySassI
     * 기능(설명)  : 상세정보(견적)요청서 SaaS 조회
     * 작   성   자  : (주)엔키소프트
     * 작   성   일  : 2017-01-05
    -->
    <select id="selectSuplerCeartInfoBySassI" parameterType="map" resultType="SuplerCeartSaasIVO">
        /*_suplerCeart.selectSuplerCeartInfoBySassI*/
        SELECT A.NOTIFY_NUM    AS notifyNum
             , A.NOTIFY_SEQ    AS notifySeq
             , A.USER_ID       AS endsUserId
             , #{suplerId}     AS suplerId
             , 'Y'             AS consumerYn
             , A.APPLY_GBN     AS applyGbn
             , A.UNIT_SYS      AS unitSys
             , B.INDVDLZ_CD_NM AS unitSysNm
             , A.ETC_UNIT_SYS  AS etcUnitSys
             , A.CAPTY_SYS     AS captySys
             , A.AMOUNT_SYS    AS amountSys
             , A.SPLY_MOTH_SYS AS splyMothSys
             , C.INDVDLZ_CD_NM AS splyMothSysNm
          FROM TCN_BID_SAAS_I A
               LEFT JOIN OP_CODE_INDVDLZ B
                      ON B.GROUP_CD = '2041'
                     AND A.UNIT_SYS = B.INDVDLZ_CD
               LEFT JOIN OP_CODE_INDVDLZ C
                      ON C.GROUP_CD      = '2042'
                     AND A.SPLY_MOTH_SYS = C.INDVDLZ_CD
         WHERE A.NOTIFY_NUM = #{notifyNum}
           AND A.NOTIFY_SEQ = #{notifySeq}
           AND A.USER_ID    = #{endsUserId}
        UNION ALL
        SELECT A.NOTIFY_NUM    AS notifyNum
             , A.NOTIFY_SEQ    AS notifySeq
             , A.USER_ID       AS endsUserId
             , B.USER_ID       AS suplerId
             , 'N'             AS consumerYn
             , B.APPLY_GBN     AS applyGbn
             , B.UNIT_SYS      AS unitSys
             , C.INDVDLZ_CD_NM AS unitSysNm
             , B.ETC_UNIT_SYS  AS etcUnitSys
             , B.CAPTY_SYS     AS captySys
             , B.AMOUNT_SYS    AS amountSys
             , B.SPLY_MOTH_SYS AS splyMothSys
             , D.INDVDLZ_CD_NM AS splyMothSysNm
          FROM TCN_BID_SAAS_I A
               LEFT JOIN TCN_BID_SAAS_I B
                      ON A.NOTIFY_NUM = B.NOTIFY_NUM
                     AND A.NOTIFY_SEQ = B.NOTIFY_SEQ
                     AND B.USER_ID    = #{suplerId}
               LEFT JOIN OP_CODE_INDVDLZ C
                      ON C.GROUP_CD = '2041'
                     AND B.UNIT_SYS = C.INDVDLZ_CD
               LEFT JOIN OP_CODE_INDVDLZ D
                      ON D.GROUP_CD      = '2042'
                     AND B.SPLY_MOTH_SYS = D.INDVDLZ_CD
         WHERE A.NOTIFY_NUM = #{notifyNum}
           AND A.NOTIFY_SEQ = #{notifySeq}
           AND A.USER_ID    = #{endsUserId}
    </select>


    <!--
     * SQL 명        : _suplerCeart.selectSuplerCeartInfoBySass2I
     * 기능(설명)    : 상세정보(견적)요청서 SaaS 조회
     * 작   성   자  : 이홍석
     * 작   성   일  : 2017-03
    -->
    <select id="selectSuplerCeartInfoBySass2I" parameterType="map" resultType="SuplerCeartSaas2IVO">
        /* 공급자씨앗 > 상세정보(견적)요청 답변관리 - 아이템클릭(/korean/pt/suplerCeart/BD_requestDetailView.do) - [Sass2I] */
        /*_suplerCeart.selectSuplerCeartInfoBySass2I*/
        
        SELECT A.NOTIFY_NUM    AS notifyNum
              ,A.NOTIFY_SEQ    AS notifySeq
              ,A.USER_ID       AS endsUserId
              ,#{suplerId}     AS suplerId
              ,'Y'             AS consumerYn
              ,A.APPLY_GBN     AS applyGbn
             
              ,A.SUPPORT_METHOD        AS supportMethod /** 제공방법 C */
              ,C.INDVDLZ_CD_NM         AS supportMethodNm
              ,A.USER_MANAGER_SEPARATE AS userManagerSeparate /** 사용자/관리자 분리 D */
              ,D.INDVDLZ_CD_NM         AS userManagerSeparateNm
              ,A.SERVICE_SUPPLY_METHOD AS serviceSupplyMethod /** 서비스제공방식 */
              ,A.ENCRYPTION            AS encryption          /** 암호화 */
              ,A.MULTIPLATFORM         AS multiPlatform       /** 다중플랫폼지원 */              
          FROM TCN_BID_SAAS2_I A
     LEFT JOIN OP_CODE_INDVDLZ C
            ON C.GROUP_CD   = '2042'
           AND C.INDVDLZ_CD = A.SUPPORT_METHOD
     LEFT JOIN OP_CODE_INDVDLZ D
            ON D.GROUP_CD   = '2061'
           AND D.INDVDLZ_CD = A.USER_MANAGER_SEPARATE
         WHERE A.NOTIFY_NUM = #{notifyNum}
           AND A.NOTIFY_SEQ = #{notifySeq}
           AND A.USER_ID    = #{endsUserId}
           
        UNION ALL
        
        SELECT A.NOTIFY_NUM    AS notifyNum
              ,A.NOTIFY_SEQ    AS notifySeq
              ,A.USER_ID       AS endsUserId
              ,B.USER_ID       AS suplerId
              ,'N'             AS consumerYn
              ,B.APPLY_GBN     AS applyGbn
             
              ,B.SUPPORT_METHOD        AS supportMethod /** 제공방법 C */
              ,C.INDVDLZ_CD_NM         AS supportMethodNm
              ,B.USER_MANAGER_SEPARATE AS userManagerSeparate /** 사용자/관리자 분리 D */
              ,D.INDVDLZ_CD_NM         AS userManagerSeparateNm
              ,B.SERVICE_SUPPLY_METHOD AS serviceSupplyMethod /** 서비스제공방식 */
              ,B.ENCRYPTION            AS encryption          /** 암호화 */
              ,B.MULTIPLATFORM         AS multiPlatform       /** 다중플랫폼지원 */
          FROM TCN_BID_SAAS2_I A
     LEFT JOIN TCN_BID_SAAS2_I B
            ON A.NOTIFY_NUM = B.NOTIFY_NUM
           AND A.NOTIFY_SEQ = B.NOTIFY_SEQ
           AND B.USER_ID    = #{suplerId}
     LEFT JOIN OP_CODE_INDVDLZ C
            ON C.GROUP_CD   = '2042'
           AND C.INDVDLZ_CD = B.SUPPORT_METHOD
     LEFT JOIN OP_CODE_INDVDLZ D
            ON D.GROUP_CD   = '2061'
           AND D.INDVDLZ_CD = B.USER_MANAGER_SEPARATE
         WHERE A.NOTIFY_NUM = #{notifyNum}
           AND A.NOTIFY_SEQ = #{notifySeq}
           AND A.USER_ID    = #{endsUserId}
    </select>

    <!--
     * SQL 명      : _suplerCeart.selectSuplerCeartInfoBySassD
     * 기능(설명)  : 상세정보(견적)요청서 SaaS 상세 조회
     * 작   성   자  : (주)엔키소프트
     * 작   성   일  : 2017-01-05
    -->
    <select id="selectSuplerCeartInfoBySassD" parameterType="map" resultType="SuplerCeartSaasDVO">
        /*_suplerCeart.selectSuplerCeartInfoBySassD*/
        SELECT A.NOTIFY_NUM    AS notifyNum
             , A.NOTIFY_SEQ    AS notifySeq
             , A.USER_ID       AS endsUserId
             , #{suplerId}     AS suplerId
             , 'Y'             AS consumerYn
             , A.APPLY_SEQ     AS applySeq
             , A.OPTION_NM     AS optionNm
             , A.UNIT_ITEM     AS unitItem
             , A.CAPTY_ITEM    AS captyItem
             , A.AMOUNT_ITEM   AS amountItem
             , A.CMNT_ITEM     AS cmntItem
          FROM TCN_BID_SAAS_D A
         WHERE A.NOTIFY_NUM = #{notifyNum}
           AND A.NOTIFY_SEQ = #{notifySeq}
           AND A.USER_ID    = #{endsUserId}
        UNION ALL
        SELECT A.NOTIFY_NUM    AS notifyNum
             , A.NOTIFY_SEQ    AS notifySeq
             , A.USER_ID       AS endsUserId
             , B.USER_ID       AS suplerId
             , 'N'             AS consumerYn
             , A.APPLY_SEQ     AS applySeq
             , B.OPTION_NM     AS optionNm
             , B.UNIT_ITEM     AS unitItem
             , B.CAPTY_ITEM    AS captyItem
             , B.AMOUNT_ITEM   AS amountItem
             , B.CMNT_ITEM     AS cmntItem
          FROM TCN_BID_SAAS_D A
               LEFT JOIN TCN_BID_SAAS_D B
                      ON A.NOTIFY_NUM = B.NOTIFY_NUM
                     AND A.NOTIFY_SEQ = B.NOTIFY_SEQ
                     AND A.APPLY_SEQ  = B.APPLY_SEQ
                     AND B.USER_ID    = #{suplerId}
         WHERE A.NOTIFY_NUM = #{notifyNum}
           AND A.NOTIFY_SEQ = #{notifySeq}
           AND A.USER_ID    = #{endsUserId}
         ORDER BY A.NOTIFY_NUM, A.NOTIFY_SEQ, A.APPLY_SEQ
    </select>


    <!--
     * SQL 명        : _suplerCeart.selectSuplerCeartInfoBySass2Dn
     * 기능(설명)    : 상세정보(견적)요청서 SaaS 상세 Need 조회
     * 작   성   자  : 이홍석
     * 작   성   일  : 2018-03
    -->
    <select id="selectSuplerCeartInfoBySass2Dn" parameterType="map" resultType="SuplerCeartSaas2DnVO">
        /* 공급자씨앗 > 상세정보(견적)요청 답변관리 - 아이템클릭(/korean/pt/suplerCeart/BD_requestDetailView.do) - [Sass2Dn] */
        /*_suplerCeart.selectSuplerCeartInfoBySass2Dn*/
        
        SELECT A.NOTIFY_NUM    AS notifyNum
              ,A.NOTIFY_SEQ    AS notifySeq
              ,A.USER_ID       AS endsUserId
              ,#{suplerId}     AS suplerId
              ,'Y'             AS consumerYn
              ,A.NEED_SEQ      AS needSeq
              
              ,A.FUNCTIONNAME  AS functionName
              ,A.AMOUNT        AS amount
              ,A.UNITCODE      AS unitCode
              ,C.INDVDLZ_CD_NM AS unitCodeNm
          FROM TCN_BID_SAAS2_DN A
     LEFT JOIN OP_CODE_INDVDLZ C
            ON C.GROUP_CD      = '2041'
           AND TO_CHAR(C.INDVDLZ_CD) = TO_CHAR(A.UNITCODE)
         WHERE A.NOTIFY_NUM = #{notifyNum}
           AND A.NOTIFY_SEQ = #{notifySeq}
           AND A.USER_ID    = #{endsUserId}
           
        UNION ALL
        
        SELECT A.NOTIFY_NUM    AS notifyNum
              ,A.NOTIFY_SEQ    AS notifySeq
              ,A.USER_ID       AS endsUserId
              ,B.USER_ID       AS suplerId
              ,'N'             AS consumerYn
              ,A.NEED_SEQ      AS needSeq
              
              ,B.FUNCTIONNAME  AS functionName
              ,B.AMOUNT        AS amount
              ,B.UNITCODE      AS unitCode
              ,C.INDVDLZ_CD_NM AS unitCodeNm
          FROM TCN_BID_SAAS2_DN A
     LEFT JOIN TCN_BID_SAAS2_DN B
            ON A.NOTIFY_NUM = B.NOTIFY_NUM
           AND A.NOTIFY_SEQ = B.NOTIFY_SEQ
           AND A.NEED_SEQ   = B.NEED_SEQ
           AND B.USER_ID    = #{suplerId}
     LEFT JOIN OP_CODE_INDVDLZ C
            ON C.GROUP_CD      = '2041'
           AND TO_CHAR(C.INDVDLZ_CD) = TO_CHAR(B.UNITCODE)
         WHERE A.NOTIFY_NUM = #{notifyNum}
           AND A.NOTIFY_SEQ = #{notifySeq}
           AND A.USER_ID    = #{endsUserId}
      ORDER BY A.NOTIFY_NUM
              ,A.NOTIFY_SEQ
              ,A.NEED_SEQ              
      
    </select>

    <!--
     * SQL 명        : _suplerCeart.selectSuplerCeartInfoBySass2Do
     * 기능(설명)    : 상세정보(견적)요청서 SaaS 상세Option 조회
     * 작   성   자  : 이홍석
     * 작   성   일  : 2018-03
    -->
    <select id="selectSuplerCeartInfoBySass2Do" parameterType="map" resultType="SuplerCeartSaas2DoVO">
        /* 공급자씨앗 > 상세정보(견적)요청 답변관리 - 아이템클릭(/korean/pt/suplerCeart/BD_requestDetailView.do) - [Sass2Do] */
        /*_suplerCeart.selectSuplerCeartInfoBySass2Do*/
        
        SELECT A.NOTIFY_NUM    AS notifyNum
             , A.NOTIFY_SEQ    AS notifySeq
             , A.USER_ID       AS endsUserId
             , #{suplerId}     AS suplerId
             , 'Y'             AS consumerYn
              ,A.NEED_SEQ      AS needSeq              
              ,A.OPTION_SEQ    AS optionSeq
                           
              ,A.FUNCTIONNAME  AS functionName
              ,A.AMOUNT        AS amount
              ,A.UNITCODE      AS unitCode
              ,C.INDVDLZ_CD_NM AS unitCodeNm
          FROM TCN_BID_SAAS2_DO A
     LEFT JOIN OP_CODE_INDVDLZ C
            ON C.GROUP_CD      = '2041'
           AND TO_CHAR(C.INDVDLZ_CD) = TO_CHAR(A.UNITCODE)
         WHERE A.NOTIFY_NUM = #{notifyNum}
           AND A.NOTIFY_SEQ = #{notifySeq}
           AND A.USER_ID    = #{endsUserId}
           
        UNION ALL
        
        SELECT A.NOTIFY_NUM    AS notifyNum
              ,A.NOTIFY_SEQ    AS notifySeq
              ,A.USER_ID       AS endsUserId
              ,B.USER_ID       AS suplerId
              ,'N'             AS consumerYn
              ,A.NEED_SEQ      AS needSeq              
              ,A.OPTION_SEQ    AS optionSeq
              
              ,B.FUNCTIONNAME  AS functionName
              ,B.AMOUNT        AS amount
              ,B.UNITCODE      AS unitCode
              ,C.INDVDLZ_CD_NM AS unitCodeNm
          FROM TCN_BID_SAAS2_DO A
     LEFT JOIN TCN_BID_SAAS2_DO B
            ON A.NOTIFY_NUM = B.NOTIFY_NUM
           AND A.NOTIFY_SEQ = B.NOTIFY_SEQ
           AND A.NEED_SEQ   = B.NEED_SEQ
           AND A.OPTION_SEQ = B.OPTION_SEQ
           AND B.USER_ID    = #{suplerId}
     LEFT JOIN OP_CODE_INDVDLZ C
            ON C.GROUP_CD      = '2041'
           AND TO_CHAR(C.INDVDLZ_CD) = TO_CHAR(B.UNITCODE)
         WHERE A.NOTIFY_NUM = #{notifyNum}
           AND A.NOTIFY_SEQ = #{notifySeq}
           AND A.USER_ID    = #{endsUserId}
      ORDER BY A.NOTIFY_NUM
              ,A.NOTIFY_SEQ
              ,A.NEED_SEQ              
              ,A.OPTION_SEQ
              
    </select>

    <!--
     * SQL 명      : _suplerCeart.selectSuplerCeartInfoByIassI
     * 기능(설명)  : 상세정보(견적)요청서 IaaS 마스터 정보 조회
     * 작   성   자  : (주)엔키소프트
     * 작   성   일  : 2017-01-06
    -->
    <select id="selectSuplerCeartInfoByIassI" parameterType="map" resultType="SuplerCeartIaasIVO">
        /*_suplerCeart.selectSuplerCeartInfoByIassI*/
        SELECT A.NOTIFY_NUM      AS notifyNum
             , A.NOTIFY_SEQ      AS notifySeq
             , A.USER_ID         AS endsUserId
             , #{suplerId}       AS suplerId
             , 'Y'               AS consumerYn
             , A.APPLY_GBN       AS applyGbn
             , A.CDN_TRANS_VLMN  AS cdnTransVlmn
             , A.CDN_REQU_CNT    AS cdnRequCnt
             , A.WEB_GOODS_KIND  AS webGoodsKind
             , A.WEB_ACCESS      AS webAccess
             , A.MNTING_VM       AS mntingVm
             , A.MNTING_ID_CNT   AS mntingIdCnt
             , A.BAKUP_CNT       AS bakupCnt
             , A.BAKUP_STORG     AS bakupStorg
             , A.MANG_FUNC       AS mangFunc
             , A.SECTY_VPN       AS sectyVpn
             , A.SECTY_SSLVPN    AS sectySslvpn
             , A.TECH_SUPT       AS techSupt
             , A.FUNC_DMND1      AS funcDmnd1
             , A.FUNC_DMND2      AS funcDmnd2
             , A.FUNC_DMND3      AS funcDmnd3
             , A.FUNC_DMND4      AS funcDmnd4
             , A.INTERFACE_DMND  AS interfaceDmnd
             , A.SECTY_DMND1     AS sectyDmnd1
             , A.SECTY_DMND2     AS sectyDmnd2
             , A.SECTY_DMND3     AS sectyDmnd3
             , A.SECTY_DMND4     AS sectyDmnd4
             , A.SECTY_DMND5     AS sectyDmnd5
             , A.QUTY_DMND1      AS qutyDmnd1
             , A.QUTY_DMND2      AS qutyDmnd2
             , A.OPTN_DMND1      AS optnDmnd1
             , A.OPTN_DMND2      AS optnDmnd2
             , A.PRJT_DMND1      AS prjtDmnd1
             , A.PRJT_DMND2      AS prjtDmnd2
             , A.PRJT_DMND3      AS prjtDmnd3
             , A.ETC_DMND        AS etcDmnd
          FROM TCN_BID_IAAS_I A
         WHERE A.NOTIFY_NUM = #{notifyNum}
           AND A.NOTIFY_SEQ = #{notifySeq}
           AND A.USER_ID    = #{endsUserId}
        UNION ALL
        SELECT A.NOTIFY_NUM      AS notifyNum
             , A.NOTIFY_SEQ      AS notifySeq
             , A.USER_ID         AS endsUserId
             , B.USER_ID         AS suplerId
             , 'N'               AS consumerYn
             , B.APPLY_GBN       AS applyGbn
             , B.CDN_TRANS_VLMN  AS cdnTransVlmn
             , B.CDN_REQU_CNT    AS cdnRequCnt
             , B.WEB_GOODS_KIND  AS webGoodsKind
             , B.WEB_ACCESS      AS webAccess
             , B.MNTING_VM       AS mntingVm
             , B.MNTING_ID_CNT   AS mntingIdCnt
             , B.BAKUP_CNT       AS bakupCnt
             , B.BAKUP_STORG     AS bakupStorg
             , B.MANG_FUNC       AS mangFunc
             , B.SECTY_VPN       AS sectyVpn
             , B.SECTY_SSLVPN    AS sectySslvpn
             , B.TECH_SUPT       AS techSupt
             , B.FUNC_DMND1      AS funcDmnd1
             , B.FUNC_DMND2      AS funcDmnd2
             , B.FUNC_DMND3      AS funcDmnd3
             , B.FUNC_DMND4      AS funcDmnd4
             , B.INTERFACE_DMND  AS interfaceDmnd
             , B.SECTY_DMND1     AS sectyDmnd1
             , B.SECTY_DMND2     AS sectyDmnd2
             , B.SECTY_DMND3     AS sectyDmnd3
             , B.SECTY_DMND4     AS sectyDmnd4
             , B.SECTY_DMND5     AS sectyDmnd5
             , B.QUTY_DMND1      AS qutyDmnd1
             , B.QUTY_DMND2      AS qutyDmnd2
             , B.OPTN_DMND1      AS optnDmnd1
             , B.OPTN_DMND2      AS optnDmnd2
             , B.PRJT_DMND1      AS prjtDmnd1
             , B.PRJT_DMND2      AS prjtDmnd2
             , B.PRJT_DMND3      AS prjtDmnd3
             , B.ETC_DMND        AS etcDmnd
          FROM TCN_BID_IAAS_I A
               LEFT JOIN TCN_BID_IAAS_I B
                      ON A.NOTIFY_NUM = B.NOTIFY_NUM
                     AND A.NOTIFY_SEQ = B.NOTIFY_SEQ
                     AND B.USER_ID    = #{suplerId}
         WHERE A.NOTIFY_NUM = #{notifyNum}
           AND A.NOTIFY_SEQ = #{notifySeq}
           AND A.USER_ID    = #{endsUserId}
    </select>

    <!--
     * SQL 명        : _suplerCeart.selectSuplerCeartInfoByIass2I
     * 기능(설명)    : 상세정보(견적)요청서 IaaS 마스터 정보 조회
     * 작   성   자  : 이홍석
     * 작   성   일  : 2018-03
    -->
    <select id="selectSuplerCeartInfoByIass2I" parameterType="map" resultType="SuplerCeartIaas2IVO">
    
        /*_suplerCeart.selectSuplerCeartInfoByIass2I*/
        
        SELECT A.NOTIFY_NUM      AS notifyNum
              ,A.NOTIFY_SEQ      AS notifySeq
              ,A.USER_ID         AS endsUserId
              ,#{suplerId}       AS suplerId
              ,'Y'               AS consumerYn
              ,A.APPLY_GBN       AS applyGbn
             
              ,A.SERVER_IP         AS serverIp                      
			  ,A.SERVER_NETWORK    AS serverNetwork                           
			  ,A.SERVER_GSLB       AS serverGslb                        
			  ,A.SERVER_LDBL       AS serverLdbl                        
			  ,A.SERVER_SNAP       AS serverSnap                        
			  ,A.SERVER_IMG        AS serverImg                       
			  ,A.DB_IP             AS dbIp                  
			  ,A.DB_NETWORK        AS dbNetwork                       
			  ,A.DB_ADDDISK        AS dbAddDisk                       
			  ,A.DB_BACKSTORG      AS dbBackStorg                         
			  ,A.DB_STORG_SPACE    AS dbStorgSpace                           
			  ,A.DB_TRANS_VLMN     AS dbTransVlmn                          
			  ,A.CDN_TRANS_VLMN    AS cdnTransVlmn                           
			  ,A.CDN_REQU_CNT      AS cdnRequCnt                         
			  ,A.WEB_GOODS_KIND    AS webGoodsKind                           
			  ,A.WEB_ACCESS        AS webAccess                       
			  ,A.MNTING_VM         AS mntingVm                      
			  ,A.MNTING_ID_CNT     AS mntingIdCnt                          
			  ,A.BAKUP_CNT         AS bakupCnt                      
			  ,A.BAKUP_STORG       AS bakupStorg                        
			  ,A.MANG_FUNC         AS mangFunc                      
			  ,A.SECTY_VPN         AS sectyVpn                      
			  ,A.SECTY_SSLVPN      AS sectySslvpn                         
		  	  ,A.ADDED_ETC         AS addedEtc
          FROM TCN_BID_IAAS2_I A
         WHERE A.NOTIFY_NUM = #{notifyNum}
           AND A.NOTIFY_SEQ = #{notifySeq}
           AND A.USER_ID    = #{endsUserId}
           
        UNION ALL
        
        SELECT A.NOTIFY_NUM      AS notifyNum
              ,A.NOTIFY_SEQ      AS notifySeq
              ,A.USER_ID         AS endsUserId
              ,B.USER_ID         AS suplerId
              ,'N'               AS consumerYn
              ,B.APPLY_GBN         AS applyGbn
             
              ,B.SERVER_IP         AS serverIp                      
		 	  ,B.SERVER_NETWORK    AS serverNetwork                           
		 	  ,B.SERVER_GSLB       AS serverGslb                        
		 	  ,B.SERVER_LDBL       AS serverLdbl                        
			  ,B.SERVER_SNAP       AS serverSnap                        
			  ,B.SERVER_IMG        AS serverImg                       
			  ,B.DB_IP             AS dbIp                  
			  ,B.DB_NETWORK        AS dbNetwork                       
			  ,B.DB_ADDDISK        AS dbAddDisk                       
			  ,B.DB_BACKSTORG      AS dbBackStorg                         
			  ,B.DB_STORG_SPACE    AS dbStorgSpace                           
			  ,B.DB_TRANS_VLMN     AS dbTransVlmn                          
			  ,B.CDN_TRANS_VLMN    AS cdnTransVlmn                           
			  ,B.CDN_REQU_CNT      AS cdnRequCnt                         
			  ,B.WEB_GOODS_KIND    AS webGoodsKind                           
			  ,B.WEB_ACCESS        AS webAccess                       
			  ,B.MNTING_VM         AS mntingVm                      
			  ,B.MNTING_ID_CNT     AS mntingIdCnt                          
			  ,B.BAKUP_CNT         AS bakupCnt                      
			  ,B.BAKUP_STORG       AS bakupStorg                        
			  ,B.MANG_FUNC         AS mangFunc                      
			  ,B.SECTY_VPN         AS sectyVpn                      
			  ,B.SECTY_SSLVPN      AS sectySslvpn                         
			  ,B.ADDED_ETC         AS addedEtc
          FROM TCN_BID_IAAS2_I A
     LEFT JOIN TCN_BID_IAAS2_I B
            ON A.NOTIFY_NUM = B.NOTIFY_NUM
           AND A.NOTIFY_SEQ = B.NOTIFY_SEQ
             AND B.USER_ID    = #{suplerId}
         WHERE A.NOTIFY_NUM = #{notifyNum}
           AND A.NOTIFY_SEQ = #{notifySeq}
           AND A.USER_ID    = #{endsUserId}
           
    </select>
    
    <!--
     * SQL 명      : _suplerCeart.selectSuplerCeartInfoByIassDs
     * 기능(설명)  : 상세정보(견적)요청서 IaaS 서버문의 조회
     * 작   성   자  : (주)엔키소프트
     * 작   성   일  : 2017-01-06
    -->
    <select id="selectSuplerCeartInfoByIassDs" parameterType="map" resultType="SuplerCeartIaasDsVO">
        /*_suplerCeart.selectSuplerCeartInfoByIassDs*/
        SELECT A.NOTIFY_NUM      AS notifyNum
             , A.NOTIFY_SEQ      AS notifySeq
             , A.USER_ID         AS endsUserId
             , #{suplerId}       AS suplerId
             , 'Y'               AS consumerYn
             , A.APPLY_SEQ       AS applySeq
             , A.SERVER_USE      AS serverUse
             , A.SERVER_OS       AS serverOs
             , A.SERVER_CPU      AS serverCpu
             , A.SERVER_MEMORY   AS serverMemory
             , A.SERVER_DISK     AS serverDisk
             , A.SERVER_QNTY     AS serverQnty
             , A.SERVER_IP       AS serverIp
             , A.SERVER_NETWORK  AS serverNetwork
             , A.SERVER_GSLB     AS serverGslb
             , A.SERVER_LDBL     AS serverLdbl
             , A.SERVER_SNAP     AS serverSnap
             , A.SERVER_IMG      AS serverImg
          FROM TCN_BID_IAAS_DS A
         WHERE A.NOTIFY_NUM = #{notifyNum}
           AND A.NOTIFY_SEQ = #{notifySeq}
           AND A.USER_ID    = #{endsUserId}
        UNION ALL
        SELECT A.NOTIFY_NUM      AS notifyNum
             , A.NOTIFY_SEQ      AS notifySeq
             , A.USER_ID         AS endsUserId
             , B.USER_ID         AS suplerId
             , 'N'               AS consumerYn
             , A.APPLY_SEQ       AS applySeq
             , B.SERVER_USE      AS serverUse
             , B.SERVER_OS       AS serverOs
             , B.SERVER_CPU      AS serverCpu
             , B.SERVER_MEMORY   AS serverMemory
             , B.SERVER_DISK     AS serverDisk
             , B.SERVER_QNTY     AS serverQnty
             , B.SERVER_IP       AS serverIp
             , B.SERVER_NETWORK  AS serverNetwork
             , B.SERVER_GSLB     AS serverGslb
             , B.SERVER_LDBL     AS serverLdbl
             , B.SERVER_SNAP     AS serverSnap
             , B.SERVER_IMG      AS serverImg
          FROM TCN_BID_IAAS_DS A
               LEFT JOIN TCN_BID_IAAS_DS B
                      ON A.NOTIFY_NUM = B.NOTIFY_NUM
                     AND A.NOTIFY_SEQ = B.NOTIFY_SEQ
                     AND B.USER_ID    = #{suplerId}
         WHERE A.NOTIFY_NUM = #{notifyNum}
           AND A.NOTIFY_SEQ = #{notifySeq}
           AND A.USER_ID    = #{endsUserId}
         ORDER BY A.NOTIFY_NUM, A.NOTIFY_SEQ, A.APPLY_SEQ
    </select>
    
    <!--
     * SQL 명        : _suplerCeart.selectSuplerCeartInfoByIass2Ds
     * 기능(설명)    : 상세정보(견적)요청서 IaaS 서버문의 조회
     * 작   성   자  : 이홍석
     * 작   성   일  : 2018-03
    -->
    <select id="selectSuplerCeartInfoByIass2Ds" parameterType="map" resultType="SuplerCeartIaas2DsVO">
    
        /*_suplerCeart.selectSuplerCeartInfoByIass2Ds*/
        
        SELECT A.NOTIFY_NUM      AS notifyNum
              ,A.NOTIFY_SEQ      AS notifySeq
              ,A.USER_ID         AS endsUserId
              ,#{suplerId}       AS suplerId
              ,'Y'               AS consumerYn
              ,A.SERVER_SEQ      AS serverSeq
              
              ,A.SERVER_USE      AS serverUse
              ,A.SERVER_OS       AS serverOs
              ,A.SERVER_CPU      AS serverCpu
              ,A.SERVER_MEMORY   AS serverMemory
              ,A.SERVER_DISK     AS serverDisk
              ,A.SERVER_QNTY     AS serverQnty
          FROM TCN_BID_IAAS2_DS A
         WHERE A.NOTIFY_NUM = #{notifyNum}
           AND A.NOTIFY_SEQ = #{notifySeq}
           AND A.USER_ID    = #{endsUserId}
           
        UNION ALL
        
        SELECT A.NOTIFY_NUM      AS notifyNum
              ,A.NOTIFY_SEQ      AS notifySeq
              ,A.USER_ID         AS endsUserId
              ,B.USER_ID         AS suplerId
              ,'N'               AS consumerYn
              ,A.SERVER_SEQ      AS serverSeq
              
              ,B.SERVER_USE      AS serverUse
              ,B.SERVER_OS       AS serverOs
              ,B.SERVER_CPU      AS serverCpu
              ,B.SERVER_MEMORY   AS serverMemory
              ,B.SERVER_DISK     AS serverDisk
              ,B.SERVER_QNTY     AS serverQnty
          FROM TCN_BID_IAAS2_DS A
     LEFT JOIN TCN_BID_IAAS2_DS B
            ON A.NOTIFY_NUM = B.NOTIFY_NUM
           AND A.NOTIFY_SEQ = B.NOTIFY_SEQ
             AND B.USER_ID    = #{suplerId}
         WHERE A.NOTIFY_NUM = #{notifyNum}
           AND A.NOTIFY_SEQ = #{notifySeq}
           AND A.USER_ID    = #{endsUserId}
      ORDER BY A.NOTIFY_NUM
              ,A.NOTIFY_SEQ
              ,A.SERVER_SEQ
              
    </select>

    <!--
     * SQL 명      : _suplerCeart.selectSuplerCeartInfoByIassDd
     * 기능(설명)  : 상세정보(견적)요청서 IaaS DB문의 조회
     * 작   성   자  : (주)엔키소프트
     * 작   성   일  : 2017-01-06
    -->
    <select id="selectSuplerCeartInfoByIassDd" parameterType="map" resultType="SuplerCeartIaasDdVO">
        /*_suplerCeart.selectSuplerCeartInfoByIassDd*/
        SELECT A.NOTIFY_NUM      AS notifyNum
             , A.NOTIFY_SEQ      AS notifySeq
             , A.USER_ID         AS endsUserId
             , #{suplerId}       AS suplerId
             , 'Y'               AS consumerYn
             , A.APPLY_SEQ       AS applySeq
             , A.DB_USE          AS dbUse
             , A.DB_OS           AS dbOs
             , A.DB_CPU          AS dbCpu
             , A.DB_MEMORY       AS dbMemory
             , A.DB_DISK         AS dbDisk
             , A.DB_QNTY         AS dbQnty
             , A.DB_IP           AS dbIp
             , A.DB_NETWORK      AS dbNetwork
             , A.DB_ADD_DISK     AS dbAddDisk
             , A.DB_BACK_STORG   AS dbBackStorg
             , A.DB_STORG_SPACE  AS dbStorgSpace
             , A.DB_TRANS_VLMN   AS dbTransVlmn
          FROM TCN_BID_IAAS_DD A
         WHERE A.NOTIFY_NUM = #{notifyNum}
           AND A.NOTIFY_SEQ = #{notifySeq}
           AND A.USER_ID    = #{endsUserId}
        UNION ALL
        SELECT A.NOTIFY_NUM      AS notifyNum
             , A.NOTIFY_SEQ      AS notifySeq
             , A.USER_ID         AS endsUserId
             , B.USER_ID         AS suplerId
             , 'N'               AS consumerYn
             , A.APPLY_SEQ       AS applySeq
             , B.DB_USE          AS dbUse
             , B.DB_OS           AS dbOs
             , B.DB_CPU          AS dbCpu
             , B.DB_MEMORY       AS dbMemory
             , B.DB_DISK         AS dbDisk
             , B.DB_QNTY         AS dbQnty
             , B.DB_IP           AS dbIp
             , B.DB_NETWORK      AS dbNetwork
             , B.DB_ADD_DISK     AS dbAddDisk
             , B.DB_BACK_STORG   AS dbBackStorg
             , B.DB_STORG_SPACE  AS dbStorgSpace
             , B.DB_TRANS_VLMN   AS dbTransVlmn
          FROM TCN_BID_IAAS_DD A
               LEFT JOIN TCN_BID_IAAS_DD B
                      ON A.NOTIFY_NUM = B.NOTIFY_NUM
                     AND A.NOTIFY_SEQ = B.NOTIFY_SEQ
                     AND B.USER_ID    = #{suplerId}
         WHERE A.NOTIFY_NUM = #{notifyNum}
           AND A.NOTIFY_SEQ = #{notifySeq}
           AND A.USER_ID    = #{endsUserId}
         ORDER BY A.NOTIFY_NUM, A.NOTIFY_SEQ, A.APPLY_SEQ
    </select>

    <!--
     * SQL 명        : _suplerCeart.selectSuplerCeartInfoByIass2Dd
     * 기능(설명)    : 상세정보(견적)요청서 IaaS DB문의 조회
     * 작   성   자  : 이홍석
     * 작   성   일  : 2018-03
    -->
    <select id="selectSuplerCeartInfoByIass2Dd" parameterType="map" resultType="SuplerCeartIaas2DdVO">
    
        /*_suplerCeart.selectSuplerCeartInfoByIass2Dd*/
        
        SELECT A.NOTIFY_NUM      AS notifyNum
              ,A.NOTIFY_SEQ      AS notifySeq
              ,A.USER_ID         AS endsUserId
              ,#{suplerId}       AS suplerId
              ,'Y'               AS consumerYn
              ,A.DB_SEQ          AS dbSeq
             
              ,A.DB_USE          AS dbUse
              ,A.DB_OS           AS dbOs
              ,A.DB_CPU          AS dbCpu
              ,A.DB_MEMORY       AS dbMemory
              ,A.DB_DISK         AS dbDisk
              ,A.DB_QNTY         AS dbQnty
          FROM TCN_BID_IAAS2_DD A
         WHERE A.NOTIFY_NUM = #{notifyNum}
           AND A.NOTIFY_SEQ = #{notifySeq}
           AND A.USER_ID    = #{endsUserId}
           
        UNION ALL
        
        SELECT A.NOTIFY_NUM      AS notifyNum
              ,A.NOTIFY_SEQ      AS notifySeq
              ,A.USER_ID         AS endsUserId
              ,B.USER_ID         AS suplerId
              ,'N'               AS consumerYn
              ,A.DB_SEQ          AS dbSeq
              
              ,B.DB_USE          AS dbUse
              ,B.DB_OS           AS dbOs
              ,B.DB_CPU          AS dbCpu
              ,B.DB_MEMORY       AS dbMemory
              ,B.DB_DISK         AS dbDisk
              ,B.DB_QNTY         AS dbQnty
          FROM TCN_BID_IAAS2_DD A
     LEFT JOIN TCN_BID_IAAS2_DD B
            ON A.NOTIFY_NUM = B.NOTIFY_NUM
           AND A.NOTIFY_SEQ = B.NOTIFY_SEQ
             AND B.USER_ID    = #{suplerId}
         WHERE A.NOTIFY_NUM = #{notifyNum}
           AND A.NOTIFY_SEQ = #{notifySeq}
           AND A.USER_ID    = #{endsUserId}
      ORDER BY A.NOTIFY_NUM
              ,A.NOTIFY_SEQ
              ,A.DB_SEQ
         
    </select>

    <!--
     * SQL 명      : _suplerCeart.suplerReturnRequest
     * 기능(설명)  : 견적요청서 관리 상세정보 반려처리
     * 작   성   자  : (주)엔키소프트
     * 작   성   일  : 2017-01-05
    -->
    <update id="suplerReturnRequest">
        /*_suplerCeart.suplerReturnRequest*/
        UPDATE TCN_NOTIFY_SPLY_I 
           SET ASK_APPLY_CD = '1002'
         WHERE NOTIFY_NUM = #{notifyNum}
           AND NOTIFY_SEQ = #{notifySeq}
           AND USER_ID    = #{suplerId}
    </update>

    <!--
     * SQL 명      : _suplerCeart.updateNotifySply
     * 기능(설명)  : 견적요청서 관리 상세정보 반려처리
     * 작   성   자  : (주)엔키소프트
     * 작   성   일  : 2017-01-05
    -->
    <update id="updateNotifySply">
        /*_suplerCeart.updateNotifySply*/
        UPDATE TCN_NOTIFY_SPLY_I 
           SET ASK_APPLY_CD = '1003'
              , SPLY_AMT     = #{splyAmt}
              ,VAT_GBN      = 'Y'
              ,ADD_ANSWER   = #{addAnswer}
              ,SPLY_NOTE    = #{splyNote}
              ,SPLY_FILE    = #{splyFile}
         WHERE NOTIFY_NUM = #{notifyNum}
           AND NOTIFY_SEQ = #{notifySeq}
           AND USER_ID    = #{suplerId}
    </update>

    <!--
     * SQL 명      : _suplerCeart.insertPaasAnswer
     * 기능(설명)  : 입찰공고 PaaS 답변 등록
     * 작   성   자  : (주)엔키소프트
     * 작   성   일  : 2017-01-06
    -->
    <insert id="insertPaasAnswer">
        /*_suplerCeart.insertPaasAnswer*/
        INSERT INTO TCN_BID_PAAS_I(NOTIFY_NUM
                                 , NOTIFY_SEQ
                                 , USER_ID
                                 , APPLY_GBN
                                 , LANG_SYS
                                 , FRAMEWORK_SYS
                                 , CACHE_SYS
                                 , DBMS_SYS
                                 , FAST_DEPLOY_SYS
                                 , ETC_SYS)
                            VALUES(#{notifyNum}
                                 , #{notifySeq}
                                 , #{suplerId}
                                 , #{applyGbn}
                                 , #{langSys}
                                 , #{frameworkSys}
                                 , #{cacheSys}
                                 , #{dbmsSys}
                                 , #{fastDeploySys}
                                 , #{etcSys})
    </insert>

    <!--
     * SQL 명      : _suplerCeart.updatePaasAnswer
     * 기능(설명)  : 입찰공고 PaaS 답변 수정
     * 작   성   자  : (주)엔키소프트
     * 작   성   일  : 2017-01-09
    -->
    <update id="updatePaasAnswer">
        /*_suplerCeart.updatePaasAnswer*/
        UPDATE TCN_BID_PAAS_I SET  LANG_SYS         = #{langSys}
                                 , FRAMEWORK_SYS    = #{frameworkSys}
                                 , CACHE_SYS        = #{cacheSys}
                                 , DBMS_SYS         = #{dbmsSys}
                                 , FAST_DEPLOY_SYS  = #{fastDeploySys}
                                 , ETC_SYS          = #{etcSys}
         WHERE NOTIFY_NUM = #{notifyNum}
           AND NOTIFY_SEQ = #{notifySeq}
           AND USER_ID    = #{suplerId}
    </update>


    <!--
     * SQL 명      : _suplerCeart.insertSaasIAnswer
     * 기능(설명)  : 입찰공고 SaaS 마스터 답변 등록
     * 작   성   자  : (주)엔키소프트
     * 작   성   일  : 2017-01-05
    -->
    <insert id="insertSaasIAnswer">
        /*_suplerCeart.insertSaasIAnswer*/
        INSERT INTO TCN_BID_SAAS_I(NOTIFY_NUM
                                 , NOTIFY_SEQ
                                 , USER_ID
                                 , APPLY_GBN
                                 , UNIT_SYS
                                 , ETC_UNIT_SYS
                                 , CAPTY_SYS
                                 , AMOUNT_SYS
                                 , SPLY_MOTH_SYS)
                            VALUES(#{notifyNum}
                                 , #{notifySeq}
                                 , #{suplerId}
                                 , #{applyGbn}
                                 , #{unitSys}
                                 , #{etcUnitSys}
                                 , #{captySys}
                                 , #{amountSys}
                                 , #{splyMothSys})
    </insert>

    <!--
     * SQL 명      : _suplerCeart.updateSaasIAnswer
     * 기능(설명)  : 입찰공고 SaaS 마스터 답변 수정
     * 작   성   자  : (주)엔키소프트
     * 작   성   일  : 2017-01-10
    -->
    <update id="updateSaasIAnswer">
        /*_suplerCeart.updateSaasIAnswer*/
        UPDATE TCN_BID_SAAS_I SET UNIT_SYS      = #{unitSys}
                                , ETC_UNIT_SYS  = #{etcUnitSys}
                                , CAPTY_SYS     = #{captySys}
                                , AMOUNT_SYS    = #{amountSys}
                                , SPLY_MOTH_SYS = #{splyMothSys}
         WHERE NOTIFY_NUM = #{notifyNum} 
           AND NOTIFY_SEQ = #{notifySeq}
           AND USER_ID    = #{suplerId}
    </update>

    <!--
     * SQL 명      : _suplerCeart.insertSaasDAnswer
     * 기능(설명)  : 입찰공고 SaaS 상세 답변 등록
     * 작   성   자  : (주)엔키소프트
     * 작   성   일  : 2017-01-05
    -->
    <insert id="insertSaasDAnswer">
        /*_suplerCeart.insertSaasDAnswer*/
        INSERT INTO TCN_BID_SAAS_D(NOTIFY_NUM
                                 , NOTIFY_SEQ
                                 , USER_ID
                                 , APPLY_SEQ
                                 , OPTION_NM
                                 , UNIT_ITEM
                                 , CAPTY_ITEM
                                 , AMOUNT_ITEM
                                 , CMNT_ITEM)
                            VALUES(#{notifyNum}
                                 , #{notifySeq}
                                 , #{suplerId}
                                 , #{applySeq}
                                 , #{optionNm}
                                 , #{unitItem}
                                 , #{captyItem}
                                 , #{amountItem}
                                 , #{cmntItem})
    </insert>

    <!--
     * SQL 명      : _suplerCeart.deleteSaasDAnswer
     * 기능(설명)  : 입찰공고 SaaS 상세 답변 등록
     * 작   성   자  : (주)엔키소프트
     * 작   성   일  : 2017-01-10
    -->
    <delete id="deleteSaasDAnswer">
        /*_suplerCeart.deleteSaasDAnswer*/
        DELETE FROM TCN_BID_SAAS_D
         WHERE NOTIFY_NUM = #{notifyNum}
           AND NOTIFY_SEQ = #{notifySeq}
           AND USER_ID    = #{suplerId}
    </delete>

    <!--
     * SQL 명      : _suplerCeart.insertIaasIAnswer
     * 기능(설명)  : 입찰공고 IaaS 마스터 답변 등록
     * 작   성   자  : (주)엔키소프트
     * 작   성   일  : 2017-01-06
    -->
    <insert id="insertIaasIAnswer">
        /*_suplerCeart.insertIaasIAnswer*/
		INSERT INTO TCN_BID_IAAS_I(NOTIFY_NUM
		                         , NOTIFY_SEQ
		                         , USER_ID
		                         , APPLY_GBN
		                         , CDN_TRANS_VLMN
		                         , CDN_REQU_CNT
		                         , WEB_GOODS_KIND
		                         , WEB_ACCESS
		                         , MNTING_VM
		                         , MNTING_ID_CNT
		                         , BAKUP_CNT
		                         , BAKUP_STORG
		                         , MANG_FUNC
		                         , SECTY_VPN
		                         , SECTY_SSLVPN
		                         , TECH_SUPT
		                         , FUNC_DMND1
		                         , FUNC_DMND2
		                         , FUNC_DMND3
		                         , FUNC_DMND4
		                         , INTERFACE_DMND
		                         , SECTY_DMND1
		                         , SECTY_DMND2
		                         , SECTY_DMND3
		                         , SECTY_DMND4
		                         , SECTY_DMND5
		                         , QUTY_DMND1
		                         , QUTY_DMND2
		                         , OPTN_DMND1
		                         , OPTN_DMND2
		                         , PRJT_DMND1
		                         , PRJT_DMND2
		                         , PRJT_DMND3
		                         , ETC_DMND)
						VALUES(#{notifyNum}
						     , #{notifySeq}
						     , #{suplerId}
						     , #{applyGbn}
						     , #{cdnTransVlmn}
						     , #{cdnRequCnt}
						     , #{webGoodsKind}
						     , #{webAccess}
						     , #{mntingVm}
						     , #{mntingIdCnt}
						     , #{bakupCnt}
						     , #{bakupStorg}
						     , #{mangFunc}
						     , #{sectyVpn}
						     , #{sectySslvpn}
						     , #{techSupt}
						     , #{funcDmnd1}
						     , #{funcDmnd2}
						     , #{funcDmnd3}
						     , #{funcDmnd4}
						     , #{interfaceDmnd}
						     , #{sectyDmnd1}
						     , #{sectyDmnd2}
						     , #{sectyDmnd3}
						     , #{sectyDmnd4}
						     , #{sectyDmnd5}
						     , #{qutyDmnd1}
						     , #{qutyDmnd2}
						     , #{optnDmnd1}
						     , #{optnDmnd2}
						     , #{prjtDmnd1}
						     , #{prjtDmnd2}
						     , #{prjtDmnd3}
						     , #{etcDmnd}
						     )
    </insert>

    <!--
     * SQL 명      : _suplerCeart.updateIaasIAnswer
     * 기능(설명)  : 입찰공고 IaaS 마스터 답변 수정
     * 작   성   자  : (주)엔키소프트
     * 작   성   일  : 2017-01-10
    -->
    <update id="updateIaasIAnswer">
        /*_suplerCeart.updateIaasIAnswer*/
        UPDATE TCN_BID_IAAS_I SET CDN_TRANS_VLMN = #{cdnTransVlmn}
		                        , CDN_REQU_CNT   = #{cdnRequCnt}
		                        , WEB_GOODS_KIND = #{webGoodsKind}
		                        , WEB_ACCESS     = #{webAccess}
		                        , MNTING_VM      = #{mntingVm}
		                        , MNTING_ID_CNT  = #{mntingIdCnt}
		                        , BAKUP_CNT      = #{bakupCnt}
		                        , BAKUP_STORG    = #{bakupStorg}
		                        , MANG_FUNC      = #{mangFunc}
		                        , SECTY_VPN      = #{sectyVpn}
		                        , SECTY_SSLVPN   = #{sectySslvpn}
		                        , TECH_SUPT      = #{techSupt}
		                        , FUNC_DMND1     = #{funcDmnd1}
		                        , FUNC_DMND2     = #{funcDmnd2}
		                        , FUNC_DMND3     = #{funcDmnd3}
		                        , FUNC_DMND4     = #{funcDmnd4}
		                        , INTERFACE_DMND = #{interfaceDmnd}
		                        , SECTY_DMND1    = #{sectyDmnd1}
		                        , SECTY_DMND2    = #{sectyDmnd2}
		                        , SECTY_DMND3    = #{sectyDmnd3}
		                        , SECTY_DMND4    = #{sectyDmnd4}
		                        , SECTY_DMND5    = #{sectyDmnd5}
		                        , QUTY_DMND1     = #{qutyDmnd1}
		                        , QUTY_DMND2     = #{qutyDmnd2}
		                        , OPTN_DMND1     = #{optnDmnd1}
		                        , OPTN_DMND2     = #{optnDmnd2}
		                        , PRJT_DMND1     = #{prjtDmnd1}
		                        , PRJT_DMND2     = #{prjtDmnd2}
		                        , PRJT_DMND3     = #{prjtDmnd3}
		                        , ETC_DMND       = #{etcDmnd}
         WHERE NOTIFY_NUM = #{notifyNum}
           AND NOTIFY_SEQ = #{notifySeq}
           AND USER_ID    = #{suplerId}
    </update>

    <!--
     * SQL 명      : _suplerCeart.insertIaasDsAnswer
     * 기능(설명)  : 입찰공고 IaaS 서버 답변 등록
     * 작   성   자  : (주)엔키소프트
     * 작   성   일  : 2017-01-06
    -->
    <insert id="insertIaasDsAnswer">
        <selectKey order="BEFORE" keyProperty="applySeq" resultType="int">
            SELECT NVL(MAX(APPLY_SEQ), 0) + 1
              FROM TCN_BID_IAAS_DS
             WHERE NOTIFY_NUM = #{notifyNum}
               AND NOTIFY_SEQ = #{notifySeq}
               AND USER_ID    = #{suplerId}
        </selectKey>
		/*_suplerCeart.insertIaasDsAnswer*/
		INSERT INTO TCN_BID_IAAS_DS(NOTIFY_NUM
		                          , NOTIFY_SEQ
		                          , USER_ID
		                          , APPLY_SEQ
		                          , SERVER_USE
		                          , SERVER_OS
		                          , SERVER_CPU
		                          , SERVER_MEMORY
		                          , SERVER_DISK
		                          , SERVER_QNTY
		                          , SERVER_IP
		                          , SERVER_NETWORK
		                          , SERVER_GSLB
		                          , SERVER_LDBL
		                          , SERVER_SNAP
		                          , SERVER_IMG)
		                          
		VALUES(#{notifyNum}
		     , #{notifySeq}
		     , #{suplerId}
		     , #{applySeq}
		     , #{serverUse}
		     , #{serverOs}
		     , #{serverCpu}
		     , #{serverMemory}
		     , #{serverDisk}
		     , #{serverQnty}
		     , #{serverIp}
		     , #{serverNetwork}
		     , #{serverGslb}
		     , #{serverLdbl}
		     , #{serverSnap}
		     , #{serverImg}
		     )
    </insert>

    <!--
     * SQL 명      : _suplerCeart.deleteIaasDsAnswer
     * 기능(설명)  : 입찰공고 IaaS 서버 답변 삭제
     * 작   성   자  : (주)엔키소프트
     * 작   성   일  : 2017-01-10
    -->
    <delete id="deleteIaasDsAnswer">
		/*_suplerCeart.deleteIaasDsAnswer*/
		DELETE FROM TCN_BID_IAAS_DS
		 WHERE NOTIFY_NUM = #{notifyNum}
		   AND NOTIFY_SEQ = #{notifySeq}
		   AND USER_ID    = #{suplerId}
    </delete>

    <!--
     * SQL 명      : _suplerCeart.insertIaasDdAnswer
     * 기능(설명)  : 입찰공고 IaaS DB 답변 등록
     * 작   성   자  : (주)엔키소프트
     * 작   성   일  : 2017-01-06
    -->
    <insert id="insertIaasDdAnswer">
        <selectKey order="BEFORE" keyProperty="applySeq" resultType="int">
            SELECT NVL(MAX(APPLY_SEQ), 0) + 1
              FROM TCN_BID_IAAS_DD
             WHERE NOTIFY_NUM = #{notifyNum}
               AND NOTIFY_SEQ = #{notifySeq}
               AND USER_ID    = #{suplerId}
        </selectKey>
		/*_suplerCeart.insertIaasDdAnswer*/
		INSERT INTO TCN_BID_IAAS_DD(NOTIFY_NUM
		                          , NOTIFY_SEQ
		                          , USER_ID
		                          , APPLY_SEQ
		                          , DB_USE
		                          , DB_OS
		                          , DB_CPU
		                          , DB_MEMORY
		                          , DB_DISK
		                          , DB_QNTY
		                          , DB_IP
		                          , DB_NETWORK
		                          , DB_ADD_DISK
		                          , DB_BACK_STORG
		                          , DB_STORG_SPACE
		                          , DB_TRANS_VLMN)
		                          
		VALUES(#{notifyNum}
		     , #{notifySeq}
		     , #{suplerId}
		     , #{applySeq}
		     , #{dbUse}
		     , #{dbOs}
		     , #{dbCpu}
		     , #{dbMemory}
		     , #{dbDisk}
		     , #{dbQnty}
		     , #{dbIp}
		     , #{dbNetwork}
		     , #{dbAddDisk}
		     , #{dbBackStorg}
		     , #{dbStorgSpace}
		     , #{dbTransVlmn}
		     )
    </insert>

    <!--
     * SQL 명      : _suplerCeart.deleteIaasDdAnswer
     * 기능(설명)  : 입찰공고 IaaS DB 답변 삭제
     * 작   성   자  : (주)엔키소프트
     * 작   성   일  : 2017-01-10
    -->
    <delete id="deleteIaasDdAnswer">
		/*_suplerCeart.deleteIaasDdAnswer*/
		DELETE FROM TCN_BID_IAAS_DD
		 WHERE NOTIFY_NUM = #{notifyNum}
		   AND NOTIFY_SEQ = #{notifySeq}
		   AND USER_ID    = #{suplerId}
    </delete>

    <!--
     * SQL 명      : _suplerCeart.contractCompleteInfo
     * 기능(설명)  : 공급자 계약관리정보 조회
     * 작   성   자  : (주)엔키소프트
     * 작   성   일  : 2017-01-06
    -->
    <select id="contractCompleteInfo" parameterType="map" resultType="SuplerCntrctVO">
        /*_suplerCeart.contractCompleteInfo*/
        SELECT F.CNTRCT_SN                 AS cntrctSn
             , NVL(F.USER_ID, #{suplerId}) AS suplerId
             , B.AUDITLOG_NM               AS svcNm
             , TO_DATE(F.CNTRCT_BEGIN_DE, 'YYYYMMDD')           AS cntrctBeginDe
             , TO_DATE(F.CNTRCT_END_DE, 'YYYYMMDD')             AS cntrctEndDe
             , F.CNTRCTAMOUNT              AS cntrctamount
             , NVL(F.PURCHS_INSTT_NM, C.USER_NM) AS purchsInsttNm
             , NVL(F.SLE_INSTT_NM, G.USER_NM)    AS sleInsttNm
             , F.CTRTC_SN                  AS ctrtcSn
             , H.LOCAL_ORGINL_NM           AS ctrtcSnOrgNm
             , H.FILE_ID                   AS ctrtcSnId
             , H.FILE_SIZE                 AS ctrtcSnSize
             , H.FILE_TY                   AS ctrtcSnTy
             , F.REGIST_ID                 AS registId
             , F.REGIST_DT                 AS registDt
             , F.UPDT_ID                   AS updtId
             , F.UPDT_DT                   AS updtDt
             , F.DELETE_AT                 AS deleteAt
             , A.NOTIFY_NUM                AS notifyNum
             , A.NOTIFY_SEQ                AS notifySeq
             , D.GOODS_CODE                AS goodsCode
             , E.GOODS_NM                  AS goodsNm
             , F.CNTR_NUM                  AS cntrNum
             , F.SPLY_FORM                 AS splyForm
             , F.SPLY_FORM_ETC             AS splyFormEtc    
             , TO_CHAR(F.CNTR_DT,'YYYY-MM-DD') AS cntrDt
             , F.CNTR_COUNT                AS cntrCount
             , A.USER_ID                   AS commUserId
             , A.REAL_DMND_ORGN            AS realDmndOrgn
             , A.BID_GBN_CD                AS bidGbnCd
          FROM TCN_BID_NOTIFY_I A
               INNER JOIN TCM_WISHORDER_INFO_I B
                       ON A.USER_ID = B.USER_ID
                      AND A.GRP_SEQ = B.GRP_SEQ
                LEFT JOIN OP_USER C
                       ON A.USER_ID   = C.USER_ID
               INNER JOIN TCN_NOTIFY_SPLY_I D
                       ON A.NOTIFY_NUM = D.NOTIFY_NUM
                      AND A.NOTIFY_SEQ = D.NOTIFY_SEQ
                      AND D.USER_ID    = #{suplerId}
                LEFT JOIN TST_GOOD_INFO_I E
                       ON D.GOODS_CODE = E.GOODS_CODE
                LEFT JOIN TCM_CNTRCT_MANAGE_I F
                       ON A.NOTIFY_NUM = F.NOTIFY_NUM
                      AND A.NOTIFY_SEQ = F.NOTIFY_SEQ
                LEFT JOIN OP_USER G
                       ON D.USER_ID   = G.USER_ID
                LEFT JOIN OP_FILE H
                       ON F.CTRTC_SN = H.FILE_SEQ
         WHERE A.NOTIFY_NUM = #{notifyNum}
           AND A.NOTIFY_SEQ = #{notifySeq}
    </select>

    <!--
     * SQL 명      : _suplerCeart.updateCntrctCmpl
     * 기능(설명)  : 공급자 확인정보의 계약체결 요청정보 UPDATE
     * 작   성   자  : (주)엔키소프트
     * 작   성   일  : 2017-01-06
    -->
    <update id="updateCntrctCmpl">
        /*_suplerCeart.updateCntrctCmpl*/
        UPDATE TCN_NOTIFY_SPLY_I SET BID_FINISH_GBN = NULL
                                   , CNTR_GBN       = 'Y'
         WHERE NOTIFY_NUM = #{notifyNum}
           AND NOTIFY_SEQ = #{notifySeq}
           AND USER_ID    = #{suplerId}
    </update>

    <!--
     * SQL 명      : _suplerCeart.insertCntrctCmpl
     * 기능(설명)  : 계약관리정보 등록-계약체결 완료
     * 작   성   자  : (주)엔키소프트
     * 작   성   일  : 2017-01-06
    -->
    <insert id="insertCntrctCmpl">
        <!-- <selectKey order="BEFORE" keyProperty="cntrctSn" resultType="int">
            SELECT NVL(MAX(CNTRCT_SN), 0) + 1
              FROM TCM_CNTRCT_MANAGE_I
        </selectKey> -->
        /*_suplerCeart.insertCntrctCmpl*/
        <!-- INSERT INTO TCM_CNTRCT_MANAGE_I(CNTRCT_SN
                                      , USER_ID
                                      , SVC_NM
                                      , CNTRCT_BEGIN_DE
                                      , CNTRCT_END_DE
                                      , CNTRCTAMOUNT
                                      , PURCHS_INSTT_NM
                                      , SLE_INSTT_NM
                                      , CTRTC_SN
                                      , REGIST_ID
                                      , REGIST_DT
                                      , DELETE_AT
                                      , NOTIFY_NUM
                                      , NOTIFY_SEQ
                                      , GOODS_CODE
                                      , CNTR_NUM
                                      , SPLY_FORM
                                      , SPLY_FORM_ETC
                                      , CNTR_DT
                                      , COMM_USER_ID
                                      , CNTR_COUNT)
                                 VALUES(#{cntrctSn}
                                      , #{suplerId}
                                      , #{svcNm}
                                      , REPLACE(#{cntrctBeginDe}, '-', '')
                                      , REPLACE(#{cntrctEndDe}, '-', '')
                                      , #{cntrctamount}
                                      , #{purchsInsttNm}
                                      , #{sleInsttNm}
                                      , #{ctrtcSn}
                                      , #{suplerId}
                                      , SYSDATETIME
                                      , 'N'
                                      , #{notifyNum}
                                      , #{notifySeq}
                                      , #{goodsCode}
                                      , #{cntrNum}
                                      , #{splyForm}
                                      , #{splyFormEtc}
                                      , #{cntrDt}
                                      , #{commUserId}
                                      , #{cntrCount}) -->
        INSERT INTO TCM_CNTRCT_MANAGE_I(USER_ID
                                      , SVC_NM
                                      , CNTRCT_BEGIN_DE
                                      , CNTRCT_END_DE
                                      , CNTRCTAMOUNT
                                      , PURCHS_INSTT_NM
                                      , SLE_INSTT_NM
                                      , CTRTC_SN
                                      , REGIST_ID
                                      , REGIST_DT
                                      , DELETE_AT
                                      , NOTIFY_NUM
                                      , NOTIFY_SEQ
                                      , GOODS_CODE
                                      , CNTR_NUM
                                      , SPLY_FORM
                                      , SPLY_FORM_ETC
                                      , CNTR_DT
                                      , COMM_USER_ID
                                      , CNTR_COUNT)
                                 VALUES(#{suplerId}
                                      , #{svcNm}
                                      , REPLACE(#{cntrctBeginDe}, '-', '')
                                      , REPLACE(#{cntrctEndDe}, '-', '')
                                      , #{cntrctamount}
                                      , #{purchsInsttNm}
                                      , #{sleInsttNm}
                                      , #{ctrtcSn}
                                      , #{suplerId}
                                      , SYSDATETIME
                                      <!-- , 'N' -->
                                      , 'Y'
                                      , #{notifyNum}
                                      , #{notifySeq}
                                      , #{goodsCode}
                                      , #{cntrNum}
                                      , #{splyForm}
                                      , #{splyFormEtc}
                                      , #{cntrDt}
                                      , #{commUserId}
                                      , #{cntrCount})
    </insert>

    <!--
     * SQL 명      : _suplerCeart.updateCntrctCmplChange
     * 기능(설명)  : 계약관리정보 등록-계약수정
     * 작   성   자  : (주)엔키소프트
     * 작   성   일  : 2017-01-06
    -->
    <update id="updateCntrctCmplChange">
        /*_suplerCeart.updateCntrctCmplChange*/
        UPDATE TCM_CNTRCT_MANAGE_I SET CNTRCT_BEGIN_DE = REPLACE(#{cntrctBeginDe}, '-', '')
                                     , CNTRCT_END_DE   = REPLACE(#{cntrctEndDe}, '-', '')
                                     , CNTRCTAMOUNT    = #{cntrctamount}
                                     , CNTR_COUNT      = #{cntrCount}
                                     , SPLY_FORM       = #{splyForm}
                                     , SPLY_FORM_ETC   = #{splyFormEtc}
                                     , CTRTC_SN        = #{ctrtcSn}
                                     , CNTR_DT         = #{cntrDt}
                                     , UPDT_ID         = #{suplerId}
                                     , UPDT_DT         = SYSDATETIME
         WHERE CNTRCT_SN  = #{cntrctSn}
           AND USER_ID    = #{suplerId}
           AND NOTIFY_NUM = #{notifyNum}
           AND NOTIFY_SEQ = #{notifySeq}
    </update>

	<!--
     * SQL 명      : _suplerCeart.bidPartcptnListCount
     * 기능(설명)  : 입찰참여 현황 목록 갯수
     * 작   성   자  : (주)엔키소프트
     * 작   성   일  : 2017-01-10
    -->
	<select id="bidPartcptnListCount" parameterType="map" resultType="int"> 
	    /*_suplerCeart.bidPartcptnListCount*/
	    SELECT COUNT(1) AS totalCount
          FROM TCN_NOTIFY_SPLY_I A
               INNER JOIN TCN_BID_NOTIFY_I B
                       ON A.NOTIFY_NUM = B.NOTIFY_NUM
                      AND A.NOTIFY_SEQ = B.NOTIFY_SEQ
         WHERE A.USER_ID = #{suplerId}
           AND B.BID_GBN_CD = '1001' /*입찰건만 조회*/
         <choose>
             <when test="searchDiv01 == 1001">
                 <if test="searchKeyWord != null  and searchKeyWord != ''">
                     AND B.REAL_DMND_ORGN LIKE '%'||#{searchKeyWord}||'%'
                 </if>
             </when>
             <when test="searchDiv01 == 1002">
                 <if test="searchKeyWord != null  and searchKeyWord != ''">
                     AND B.BID_NOTIFY_NM LIKE '%'||#{searchKeyWord}||'%'
                 </if>
             </when>
         </choose>
         <choose>
             <when test="searchDiv02 == 1003">
                 AND B.CNTR_MOTHOD = '1003'
             </when>
         </choose>
    </select>

	<!--
     * SQL 명      : _suplerCeart.bidPartcptnList
     * 기능(설명)  : 입찰참여 현황 목록 조회
     * 작   성   자  : (주)엔키소프트
     * 작   성   일  : 2017-01-10
    -->
    <select id="bidPartcptnList" parameterType="map" resultType="SuplerCeartBidPartcptnVO">
    	/*_suplerCeart.bidPartcptnList*/
        SELECT Y.* 
          FROM (SELECT ROWNUM NUM
                     , X.*
                  FROM (
				        SELECT A.NOTIFY_NUM                     AS notifyNum
				             , A.NOTIFY_SEQ                     AS notifySeq
				             , B.BID_NOTIFY_NM                  AS bidNotifyNm
				             , B.REAL_DMND_ORGN                 AS realDmndOrgn
				             , B.CNTR_MOTHOD                    AS cntrMothod
				             , C.INDVDLZ_CD_NM                  AS cntrMothodNm
				             , A.ASK_APPLY_CD                   AS askApplyCd
				             , E.INDVDLZ_CD_NM                  AS askApplyNm
				             , B.BID_PGES_STAT                  AS bidPgesStat
				             , (CASE WHEN B.CLSE_DT &lt;= SYSDATETIME 
									THEN (CASE WHEN B.BID_PGES_STAT = 1001 OR B.BID_PGES_STAT = 1002 
												THEN '마감' 
												ELSE D.INDVDLZ_CD_NM 
												 END) 
						 			ELSE D.INDVDLZ_CD_NM 
						 			 END)              AS bidPgesStatNm
             					<!-- , D.INDVDLZ_CD_NM                 AS bidPgesStatNm -->
				             , TO_CHAR(B.STRT_DT, 'YYYY-MM-DD') AS strtDt
				             , TO_CHAR(B.STRT_DT, 'HH24')       AS strtTime
				             , TO_CHAR(B.CLSE_DT, 'YYYY-MM-DD') AS clseDt
				             , TO_CHAR(B.CLSE_DT, 'HH24')       AS clseTime
				             , TO_CHAR(A.ENTR_DT, 'YYYY-MM-DD') AS entrDt
				             , TO_CHAR(A.ENTR_DT, 'HH24')       AS entrTime
				             , NVL(A.BID_SUSS_GBN, 'N')         AS bidSussGbn
				             , NVL(A.CNTR_GBN, 'N')             AS cntrGbn
				          FROM TCN_NOTIFY_SPLY_I A
				               INNER JOIN TCN_BID_NOTIFY_I B
				                       ON A.NOTIFY_NUM = B.NOTIFY_NUM
				                      AND A.NOTIFY_SEQ = B.NOTIFY_SEQ
				                LEFT JOIN OP_CODE_INDVDLZ C
				                       ON C.GROUP_CD    = '2040'
				                      AND B.CNTR_MOTHOD = C.INDVDLZ_CD
				                LEFT JOIN OP_CODE_INDVDLZ D
				                       ON D.GROUP_CD      = '2044'
				                      AND B.BID_PGES_STAT = D.INDVDLZ_CD
				                LEFT JOIN OP_CODE_INDVDLZ E
				                       ON E.GROUP_CD     = '2043'
				                      AND A.ASK_APPLY_CD = E.INDVDLZ_CD
				         WHERE A.USER_ID = #{suplerId}
				           AND B.BID_GBN_CD = '1001' /*입찰건만 조회*/
				         <choose>
				             <when test="searchDiv01 == 1001">
				                 <if test="searchKeyWord != null  and searchKeyWord != ''">
				                     AND B.REAL_DMND_ORGN LIKE '%'||#{searchKeyWord}||'%'
				                 </if>
				             </when>
				             <when test="searchDiv01 == 1002">
				                 <if test="searchKeyWord != null  and searchKeyWord != ''">
				                     AND B.BID_NOTIFY_NM LIKE '%'||#{searchKeyWord}||'%'
				                 </if>
				             </when>
				         </choose>
				         <choose>
				             <when test="searchDiv02 == null or searchDiv02 == '' or searchDiv02 == 1001">
				                 ORDER BY A.NOTIFY_NUM DESC, A.NOTIFY_SEQ DESC
				             </when>
				             <when test="searchDiv02 == 1002">
				                 ORDER BY B.CLSE_DT, A.NOTIFY_NUM DESC, A.NOTIFY_SEQ DESC
				             </when>
				             <when test="searchDiv02 == 1003">
				                 AND B.CNTR_MOTHOD = '1003'
				                 ORDER BY A.NOTIFY_NUM DESC, A.NOTIFY_SEQ DESC
				             </when>
				         </choose>
			           ) X WHERE ROWNUM &lt;= #{pagingEndNum}
		    ) Y WHERE NUM &gt;= #{pagingStartNum}
    </select>

	<!--{{{{{{
     * SQL 명      : suplySttusListWhere
     * 기능(설명)  : 공급현황 목록 갯수
    -->
     <sql id="suplySttusListWhere">
     	<!-- 카테고리 -->
        <if test="q_goodsTyCd != null  and  q_goodsTyCd != ''"> 
             AND C.GOODS_CODE IN
                    ( SELECT  A.GOODS_CODE
                        FROM  TST_GOOD_CATE_I A, TST_CATE_MGMT_M B
                       WHERE  A.CTGRY_CODE = B.CTGRY_CODE
                         AND  B.CTGRY_CL_CD = #{q_goodsTyCd} )
        </if>
        <if test="q_searchKey != null  and q_searchKey != '' and q_searchKeyWord != ''  ">
       	  <choose>
                <!-- 서비스명 -->
                <when test="q_searchKey == '1001'">
                   AND D.GOODS_NM LIKE '%'||#{searchKeyWord}||'%'
                </when>
                <!-- 계약기관(회사)명 -->
                <when test="q_searchKey == '1002'">
                    AND A.CNTRCT_SN IN (SELECT CNTRCT_SN FROM TCM_RL_USER_I WHERE RL_CNTRCT_INSTT_AT ='N' AND ORGN_NM LIKE '%' || #{q_searchKeyWord} || '%')
                </when>
                <!-- 이용기관(회사) -->
                <when test="q_searchKey == '1003'">
                     AND A.CNTRCT_SN IN (SELECT CNTRCT_SN FROM TCM_RL_USER_I WHERE RL_CNTRCT_INSTT_AT ='Y' AND ORGN_NM LIKE '%' || #{q_searchKeyWord} || '%')
                </when>
            </choose>
        </if>
        <if test="searchStartDt != null  and searchStartDt != ''">
            AND REPLACE(#{searchStartDt},'-','') BETWEEN TO_CHAR(A.CNTRCT_BEGIN_DE,'YYYYMMDD') AND TO_CHAR(A.CNTRCT_END_DE,'YYYYMMDD')
        </if>
        <if test="searchEndDt != null  and searchEndDt != ''">
            AND REPLACE(#{searchEndDt},'-','') BETWEEN TO_CHAR(A.CNTRCT_BEGIN_DE,'YYYYMMDD') AND TO_CHAR(A.CNTRCT_END_DE,'YYYYMMDD')
        </if>
    </sql>
     
	<select id="suplySttusListCount" parameterType="map" resultType="int"> 

        /*_suplerCeart.suplySttusListCount*/
	    
        SELECT COUNT(1) AS totalCount 
          FROM TCM_CNTRCT_MANAGE_I A
		         LEFT OUTER JOIN TCN_BID_NOTIFY_I B
		                ON A.NOTIFY_NUM = B.NOTIFY_NUM
		               AND A.NOTIFY_SEQ = B.NOTIFY_SEQ
		         LEFT JOIN TCM_CNTRCT_SERVICE_I C
		          	    ON A.CNTRCT_SN = C.CNTRCT_SN
		         LEFT JOIN TST_GOOD_INFO_I D
		                ON C.GOODS_CODE = D.GOODS_CODE
		         LEFT JOIN TCM_CNTRCT_TEMP_USER H
		                ON A.TEMP_USER_SN = H.USER_SN
         WHERE A.USER_ID             = #{suplerId}
           AND NVL(A.DELETE_AT, 'N') = 'Y'
           AND A.ASIS = 'N'
          <include refid="suplySttusListWhere"/>
          
     </select>
     
	<!--
     * SQL 명      : _suplerCeart.suplySttusList
     * 기능(설명)  : 공급현황 목록 조회
     * 작   성   자  : (주)엔키소프트
     * 작   성   일  : 2017-01-11  
    -->
    <select id="suplySttusList" parameterType="map" resultType="SuplerCeartSuplySttusVO">
        
        /*_suplerCeart.suplySttusList*/
        
        SELECT Y.* 
          FROM (SELECT ROWNUM NUM
                     , X.*
                  FROM (SELECT A.NOTIFY_NUM      						AS notifyNum
				             , A.NOTIFY_SEQ      						AS notifySeq
				             , B.BID_GBN_CD      						AS bidGbnCd
				             <!-- , (CASE WHEN C.INDVDLZ_CD_NM IS NULL THEN G.INDVDLZ_CD_NM
				                     ELSE C.INDVDLZ_CD_NM END) 			AS bidGbnNm -->
				             , CNTR_NUM									AS cntrNum
				             
				             , NVL(A.PURCHS_INSTT_NM2,A.PURCHS_INSTT_NM)  AS purchsInsttNm /*계약기관명*/				             				             
				             /*, CU.ORGN_NM								AS purchsInsttNm	 계약기관명*/
				             
				             , A.GOODS_CODE     						AS goodsCode
				             , CA.GOODSTYNM						 		AS goodsTyNm		 /*서비스구분*/
				             , D.GOODS_NM       						AS goodsNm
				             , C.SPLY_FORM								AS splyForm			/**/
				             , C.SPLY_FORM_ETC							AS splyFormUnit			
				             , C.CNTRCT_AMOUNT 						  	AS cntrctAmount      /*구매금액*/
				             , A.USER_ID        						AS suplerId
				             , E.USER_NM  								AS suplerNm
				             , A.COMM_USER_ID     AS commUserId
				             , (CASE WHEN F.USER_NM  IS NOT NULL THEN F.USER_NM  
				             			ELSE H.USER_NM END )     		AS commUserNm
				             , (CASE WHEN B.REAL_DMND_ORGN IS NULL THEN A.PURCHS_INSTT_NM
				                     ELSE B.REAL_DMND_ORGN END)			AS realDmndOrgn
				            <!--  , A.CNTRCTAMOUNT    AS cntrctamount -->
				             , TO_CHAR(CNTR_DT, 'YYYY-MM-DD')			AS cntrDt
				             , TO_DATE(A.CNTRCT_BEGIN_DE, 'YYYYMMDD')	AS cntrctBeginDe
				             , TO_DATE(A.CNTRCT_END_DE, 'YYYYMMDD')		AS cntrctEndDe
				             , IFNULL(D.GOODS_RDCNT, 0)     			AS goodsRdcnt
				             , A.CNTRCT_SN       						AS cntrctSn
				             , COUNT(C.CNTRCT_SVC_SN	) OVER (PARTITION BY C.CNTRCT_SN ORDER BY C.CNTRCT_SN) AS serviceCnt
				           <!--   , A.PURCHS_INSTT_NM 						AS purchsInsttNm -->
				          FROM TCM_CNTRCT_MANAGE_I A
				               LEFT OUTER JOIN TCN_BID_NOTIFY_I B
				                       ON A.NOTIFY_NUM = B.NOTIFY_NUM
				                      AND A.NOTIFY_SEQ = B.NOTIFY_SEQ
				              <!--   LEFT JOIN OP_CODE_INDVDLZ C
				                       ON C.GROUP_CD = '2037'
				                      AND B.BID_GBN_CD = C.INDVDLZ_CD -->
				                LEFT JOIN (SELECT CNTRCT_SN, BUSEO_CODE, ORGN_NM
											 FROM TCM_RL_USER_I WHERE RL_CNTRCT_INSTT_AT ='N') CU 
									  ON A.CNTRCT_SN = CU.CNTRCT_SN
				                LEFT JOIN TCM_CNTRCT_SERVICE_I C
				                	   ON A.CNTRCT_SN = C.CNTRCT_SN
				                LEFT JOIN TST_GOOD_INFO_I D
					                   ON C.GOODS_CODE = D.GOODS_CODE
					            LEFT JOIN (SELECT A.GOODS_CODE, (SELECT INDVDLZ_CD_NM
														  FROM OP_CODE_INDVDLZ
														 WHERE LANG_CODE = '00' 
														   AND GROUP_CD = 1005 
														   AND INDVDLZ_CD = B.CTGRY_CL_CD) AS GOODSTYNM
								          	 FROM TST_GOOD_CATE_I A, TST_CATE_MGMT_M B
								         	WHERE A.CTGRY_CODE = B.CTGRY_CODE AND  B.LANG_CODE =  '00'
								         GROUP BY A.GOODS_CODE, B.CTGRY_CL_CD) CA ON D.GOODS_CODE = CA.GOODS_CODE
				                LEFT JOIN OP_USER E
				                       ON A.USER_ID = E.USER_ID
				                LEFT JOIN OP_USER F
				                       ON A.COMM_USER_ID = F.USER_ID
				                LEFT JOIN OP_CODE_INDVDLZ G
				                       ON G.GROUP_CD = '2046'
				                      AND G.INDVDLZ_CD = A.REGIST_MTHD_CODE
				                LEFT JOIN TCM_CNTRCT_TEMP_USER H
				                	   ON A.TEMP_USER_SN = H.USER_SN
				         WHERE A.USER_ID = #{suplerId}
				           AND NVL(A.DELETE_AT, 'N') = 'Y'
				           AND A.ASIS = 'N'
				         <include refid="suplySttusListWhere"/>
				         ORDER BY A.REGIST_DT DESC
			           ) X WHERE ROWNUM &lt;= #{pagingEndNum}
		    ) Y WHERE NUM &gt;= #{pagingStartNum}
		    
    </select>

	<!--
     * SQL 명      : _suplerCeart.suplySttusListExcel
     * 기능(설명)  : 공급현황 조회 (엑셀다운용)
     * 작   성   자  : (주)엔키소프트
     * 작   성   일  : 2017-01-11
    -->
    <select id="suplySttusListExcel" parameterType="map" resultType="SuplerCeartSuplySttusVO">
    	/*_suplerCeart.suplySttusListExcel*/
        SELECT A.NOTIFY_NUM      						AS notifyNum
             , A.NOTIFY_SEQ      						AS notifySeq
             , CNTR_NUM									AS cntrNum
             , CU.ORGN_NM								AS purchsInsttNm	 /*계약기관명*/
             , A.GOODS_CODE     						AS goodsCode
             , CA.GOODSTYNM						 		AS goodsTyNm		 /*서비스구분*/
             , D.GOODS_NM       						AS goodsNm
             , C.SPLY_FORM								AS splyForm			/**/
             , C.SPLY_FORM_ETC							AS splyFormUnit			
             , C.CNTRCT_AMOUNT 						  	AS cntrctAmount      /*구매금액*/
             , (CASE WHEN B.REAL_DMND_ORGN IS NULL THEN A.PURCHS_INSTT_NM
                     ELSE B.REAL_DMND_ORGN END)			AS realDmndOrgn
             , TO_CHAR(CNTR_DT, 'YYYY-MM-DD')			AS cntrDt
          FROM TCM_CNTRCT_MANAGE_I A
               LEFT OUTER JOIN TCN_BID_NOTIFY_I B
                       ON A.NOTIFY_NUM = B.NOTIFY_NUM
                      AND A.NOTIFY_SEQ = B.NOTIFY_SEQ
                LEFT JOIN (SELECT CNTRCT_SN, BUSEO_CODE, ORGN_NM
							 FROM TCM_RL_USER_I WHERE RL_CNTRCT_INSTT_AT ='N') CU 
					  ON A.CNTRCT_SN = CU.CNTRCT_SN
                LEFT JOIN TCM_CNTRCT_SERVICE_I C
                	   ON A.CNTRCT_SN = C.CNTRCT_SN
                LEFT JOIN TST_GOOD_INFO_I D
	                   ON C.GOODS_CODE = D.GOODS_CODE
	            LEFT JOIN (SELECT A.GOODS_CODE, (SELECT INDVDLZ_CD_NM
										  FROM OP_CODE_INDVDLZ
										 WHERE LANG_CODE = '00' 
										   AND GROUP_CD = 1005 
										   AND INDVDLZ_CD = B.CTGRY_CL_CD) AS GOODSTYNM
				          	 FROM TST_GOOD_CATE_I A, TST_CATE_MGMT_M B
				         	WHERE A.CTGRY_CODE = B.CTGRY_CODE AND  B.LANG_CODE =  '00'
				         GROUP BY A.GOODS_CODE, B.CTGRY_CL_CD) CA ON D.GOODS_CODE = CA.GOODS_CODE
         WHERE A.USER_ID = #{suplerId}
           AND NVL(A.DELETE_AT, 'N') = 'Y'
           AND A.ASIS = 'N'
	       <include refid="suplySttusListWhere"/>
         ORDER BY A.REGIST_DT DESC
    </select>

    <!-- }}}}}}  -->
    
	<!--
     * SQL 명      : _suplerCeart.suplySttusEndsUserInfo
     * 기능(설명)  : 공급현황 구매자정보
     * 작   성   자  : (주)엔키소프트
     * 작   성   일  : 2017-01-12
    -->
    <select id="suplySttusEndsUserInfo" parameterType="map" resultType="SuplySttusEndsUserVO">
        /*_suplerCeart.suplySttusEndsUserInfo*/
        SELECT A.NOTIFY_NUM                     AS notifyNum
             , A.NOTIFY_SEQ                     AS notifySeq
             , A.USER_ID                        AS endsUserId
             , C.USER_NM                        AS endsUserNm
             , DECRYPT(C.MBTLNUM ,'P007')       AS endsUserMbtlnum
             , DECRYPT(C.EMAIL,'P008')          AS endsUserEmail
             , D.LANG_STORE_NM                  AS endsUserStoreNm
             , DECRYPT(D.REPRSNT_TELNO ,'P007') AS endsUserReprsntTelno
             , B.GOODS_CODE                     AS goodsCode
             , E.GOODS_NM                       AS goodsNm
             , A.GOOD_KND_CD                    AS goodKndCd
             , B.USER_ID                        AS suplerId
             , F.USER_NM                        AS suplerNm
             , G.LANG_STORE_NM                  AS suplerStoreNm
          FROM TCN_BID_NOTIFY_I A
               LEFT JOIN TCN_NOTIFY_SPLY_I B
                      ON A.NOTIFY_NUM = B.NOTIFY_NUM
                     AND A.NOTIFY_SEQ = B.NOTIFY_SEQ
                     AND B.USER_ID    = #{suplerId}
               LEFT JOIN OP_USER C
                      ON A.USER_ID = C.USER_ID
               LEFT JOIN TUM_SVC_STOR_I D
                      ON A.USER_ID = D.USER_ID
                     AND D.LANG_CODE = #{langCode}
               LEFT JOIN TST_GOOD_INFO_I E
                      ON B.GOODS_CODE = E.GOODS_CODE
               LEFT JOIN OP_USER F
                      ON B.USER_ID = F.USER_ID
               LEFT JOIN TUM_SVC_STOR_I G
                      ON B.USER_ID = G.USER_ID
                     AND G.LANG_CODE = #{langCode}
         WHERE A.NOTIFY_NUM = #{notifyNum} 
           AND A.NOTIFY_SEQ = #{notifySeq}
    </select>

	<!--
     * SQL 명      : _suplerCeart.suplySttusHistList
     * 기능(설명)  : 공급현황 구매자정보
     * 작   성   자  : (주)엔키소프트
     * 작   성   일  : 2017-01-12
    -->
    <select id="suplySttusHistList" parameterType="map" resultType="SuplerCntrctVO">
        /*_suplerCeart.suplySttusHistList*/
        SELECT A.NOTIFY_NUM                            AS notifyNum
             , A.NOTIFY_SEQ                            AS notifySeq
             , TO_DATE(A.CNTRCT_BEGIN_DE, 'YYYYMMDD')  AS cntrctBeginDe
             , TO_DATE(A.CNTRCT_END_DE, 'YYYYMMDD')    AS cntrctEndDe
             , A.CNTRCTAMOUNT                          AS cntrctamount
             , A.CTRTC_SN                              AS ctrtcSn
             , B.LOCAL_ORGINL_NM                       AS ctrtcSnOrgNm
             , B.FILE_ID                               AS ctrtcSnId
             , B.FILE_SIZE                             AS ctrtcSnSize
             , B.FILE_TY                               AS ctrtcSnTy
          FROM TCM_CNTRCT_MANAGE_I A
               LEFT JOIN OP_FILE B
                      ON A.CTRTC_SN = B.FILE_SEQ
         WHERE A.COMM_USER_ID = #{commUserId}
           AND A.USER_ID      = #{suplerId}
           AND A.GOODS_CODE   = #{goodsCode}
         ORDER BY A.CNTR_DT DESC
    </select>

	<!--
     * SQL 명      : _suplerCeart.totSuplySttusHistList
     * 기능(설명)  : 공급자의 서비스에 대한 총 공급이력
     * 작   성   자  : (주)엔키소프트
     * 작   성   일  : 2017-01-12
    -->
    <select id="totSuplySttusHistList" parameterType="map" resultType="SuplerCntrctVO">
        /*_suplerCeart.totSuplySttusHistList*/
        SELECT A.NOTIFY_NUM                            AS notifyNum
             , A.NOTIFY_SEQ                            AS notifySeq
             , TO_DATE(A.CNTRCT_BEGIN_DE, 'YYYYMMDD')  AS cntrctBeginDe
             , TO_DATE(A.CNTRCT_END_DE, 'YYYYMMDD')    AS cntrctEndDe
             , A.CNTRCTAMOUNT                          AS cntrctamount
             , A.CTRTC_SN                              AS ctrtcSn
             , B.LOCAL_ORGINL_NM                       AS ctrtcSnOrgNm
             , B.FILE_ID                               AS ctrtcSnId
             , B.FILE_SIZE                             AS ctrtcSnSize
             , B.FILE_TY                               AS ctrtcSnTy
             , A.COMM_USER_ID                          AS commUserId
             , C.USER_NM                               AS commUserNm
          FROM TCM_CNTRCT_MANAGE_I A
               LEFT JOIN OP_FILE B
                      ON A.CTRTC_SN = B.FILE_SEQ
               LEFT JOIN OP_USER C
                      ON A.COMM_USER_ID = C.USER_ID
               LEFT JOIN TUM_SVC_STOR_I D
                      ON A.COMM_USER_ID = D.USER_ID
                     AND D.LANG_CODE    = '00'
         WHERE A.USER_ID      = #{suplerId}
           AND A.GOODS_CODE   = #{goodsCode}
         ORDER BY A.CNTR_DT DESC
    </select>
    
    
    <!--
     * SQL 명      : _suplerCeart.beforeRequestListCount
     * 기능(설명)  : 사전견적요청서 관리 목록 조회 총 건수
     * 작   성   자  : (주)엔키소프트
     * 작   성   일  : 2017-01-05
    -->
	<select id="beforeRequestListCount" parameterType="map" resultType="int"> 
	    /*_suplerCeart.beforeRequestListCount*/
        SELECT COUNT(1) AS totalCount 
          FROM TCN_BEFORE_ESTE_SPLY A
               INNER JOIN TCN_BEFORE_ESTE_NOFY B
                       ON A.NOTIFY_NUM = B.NOTIFY_NUM
                      AND A.NOTIFY_SEQ = B.NOTIFY_SEQ
                LEFT JOIN TCM_WISHORDER_INFO_I C
                       ON B.USER_ID = C.USER_ID
                      AND B.GRP_SEQ = C.GRP_SEQ
                LEFT JOIN TUM_SVC_STOR_I D
		               ON B.USER_ID   = D.USER_ID
		              AND D.LANG_CODE = #{langCode}
                LEFT JOIN TST_GOOD_INFO_I E
	                   ON A.GOODS_CODE = E.GOODS_CODE
         WHERE A.USER_ID    = #{suplerId}
           AND B.BID_GBN_CD = '1004'
		<choose>
            <when test="searchDiv01 == 1001">
                <if test="searchKeyWord != null  and searchKeyWord != ''">
                    AND UPPER(E.GOODS_NM) LIKE '%'||UPPER(#{searchKeyWord})||'%'
                </if>
            </when>
            <when test="searchDiv01 == 1002">
                <if test="searchKeyWord != null  and searchKeyWord != ''">
                    AND UPPER(B.REAL_DMND_ORGN) LIKE '%'||UPPER(#{searchKeyWord})||'%'
                </if>
            </when>
		</choose>
        <choose>
        	<when test="searchDiv02 == 1006">
        		 AND A.DELETE_AT ='Y'
        	</when>
        	<when test="searchDiv02 == 1005">
	         	<if test="searchDiv02 != null  and searchDiv02 != ''">
	             AND A.ASK_APPLY_CD = #{searchDiv02}
	        	</if>
        	</when>
        	<when test="searchDiv02 == 1004">
	         	<if test="searchDiv02 != null  and searchDiv02 != ''">
	             AND A.DELETE_AT ='N' 
	             AND A.ASK_APPLY_CD = #{searchDiv02}
	        	</if>
        	</when>
        </choose>
    </select>

	<!--
     * SQL 명      : _suplerCeart.beforeRequestList
     * 기능(설명)  : 사전견적요청서 관리 목록 조회
     * 작   성   자  : (주)엔키소프트
     * 작   성   일  : 2017-01-05
    -->
    <select id="beforeRequestList" parameterType="map" resultType="SuplerCeartVO">
    	/*_suplerCeart.beforeRequestList*/
        SELECT Y.* 
          FROM (SELECT ROWNUM NUM
                     , X.*
                  FROM (
                        SELECT A.NOTIFY_NUM                     AS notifyNum    /*공고번호*/
                             , A.NOTIFY_SEQ                     AS notifySeq    /*공고차수*/
                             , B.USER_ID                        AS endsUserId   /*수요자ID*/
                             , #{suplerId}                      AS suplerId     /*공급자ID*/
                             , A.GOODS_CODE                     AS goodsCode    /*상품코드*/
                             , DECODE(E.GOODS_KND_CD, '1001','PaaS', '1002','SaaS', '1003','IaaS', '1004','SCS') AS goodsKndCd /* 구분*/
                             , E.GOODS_NM                       AS goodsNm      /*상품명*/
                             , D.LANG_STORE_NM                  AS endsStoreNm  /*공급자명*/
                             , TO_CHAR(B.RPLY_DT, 'YYYY-MM-DD') AS rplyDt       /*견적수신일*/
                             , A.ASK_APPLY_CD                   AS askApplyCd   /*답변코드*/
                             , B.REAL_DMND_ORGN                 AS realDmndOrgn /*기관명*/ 
                             , CASE WHEN A.DELETE_AT ='Y' THEN '삭제' 
                                 ELSE F.INDVDLZ_CD_NM 
                               END                              AS askApplyNm   /*답변명*/
                          FROM TCN_BEFORE_ESTE_SPLY A
                               INNER JOIN TCN_BEFORE_ESTE_NOFY B
                                       ON A.NOTIFY_NUM = B.NOTIFY_NUM
                                      AND A.NOTIFY_SEQ = B.NOTIFY_SEQ
                                LEFT JOIN TCM_WISHORDER_INFO_I C
                                       ON B.USER_ID = C.USER_ID
                                      AND B.GRP_SEQ = C.GRP_SEQ
                                LEFT JOIN TUM_SVC_STOR_I D
		                               ON B.USER_ID   = D.USER_ID
		                              AND D.LANG_CODE = #{langCode}
                                LEFT JOIN TST_GOOD_INFO_I E
	                                   ON A.GOODS_CODE = E.GOODS_CODE
                                LEFT JOIN OP_CODE_INDVDLZ F
                                       ON F.GROUP_CD = '2043'
                                      AND A.ASK_APPLY_CD = F.INDVDLZ_CD
                         WHERE A.USER_ID    = #{suplerId}
                           AND B.BID_GBN_CD = '1004'
                         <choose>
                             <when test="searchDiv01 == 1001">
                                 <if test="searchKeyWord != null  and searchKeyWord != ''">
                                     AND UPPER(E.GOODS_NM) LIKE '%'||UPPER(#{searchKeyWord})||'%'
                                 </if>
                             </when>
                             <when test="searchDiv01 == 1002">
                                 <if test="searchKeyWord != null  and searchKeyWord != ''">
                                     AND UPPER(B.REAL_DMND_ORGN) LIKE '%'||UPPER(#{searchKeyWord})||'%'
                                 </if>
                             </when>
                         </choose>
                         <choose>
                         	<when test="searchDiv02 == 1006">
                         		 AND A.DELETE_AT ='Y'
                         	</when>
                         	<when test="searchDiv02 == 1005">
	                         	<if test="searchDiv02 != null  and searchDiv02 != ''">
	                             AND A.ASK_APPLY_CD = #{searchDiv02}
	                        	</if>
                         	</when>
                         	<when test="searchDiv02 == 1004">
	                         	<if test="searchDiv02 != null  and searchDiv02 != ''">
	                             AND A.DELETE_AT ='N' 
	                             AND A.ASK_APPLY_CD = #{searchDiv02}
	                        	</if>
                         	</when>
                         </choose>
                         ORDER BY A.NOTIFY_NUM DESC, A.NOTIFY_SEQ DESC
			           ) X WHERE ROWNUM &lt;= #{pagingEndNum}
		    ) Y WHERE NUM &gt;= #{pagingStartNum}
    </select>


	<!--
     * SQL 명      : _suplerCeart.beforeRequestListExcel
     * 기능(설명)  : 사전견적요청서 관리 목록 조회(엑셀 다운용)
     * 작   성   자  : (주)엔키소프트
     * 작   성   일  : 2017-01-05
    -->
    <select id="beforeRequestListExcel" parameterType="map" resultType="SuplerCeartVO">
    	/*_suplerCeart.beforeRequestListExcel*/
        SELECT A.NOTIFY_NUM                     AS notifyNum
             , A.NOTIFY_SEQ                     AS notifySeq
             , B.USER_ID                        AS endsUserId
             , #{suplerId}                      AS suplerId
             , C.AUDITLOG_NM                    AS auditlogNm
             , A.GOODS_CODE                     AS goodsCode
             , DECODE(E.GOODS_KND_CD, '1001','PaaS', '1002','SaaS', '1003','IaaS', '1004','SCS') AS goodsKndCd /* 구분*/
             , E.GOODS_NM                       AS goodsNm
             , D.LANG_STORE_NM                  AS endsStoreNm
             , B.REAL_DMND_ORGN                 AS realDmndOrgn
             , TO_CHAR(B.RPLY_DT, 'YYYY-MM-DD') AS rplyDt
             , A.ASK_APPLY_CD                   AS askApplyCd
             , F.INDVDLZ_CD_NM                  AS askApplyNm
             
          FROM TCN_BEFORE_ESTE_SPLY A
    INNER JOIN TCN_BEFORE_ESTE_NOFY B
            ON A.NOTIFY_NUM = B.NOTIFY_NUM
           AND A.NOTIFY_SEQ = B.NOTIFY_SEQ
     LEFT JOIN TCM_WISHORDER_INFO_I C
            ON B.USER_ID = C.USER_ID
           AND B.GRP_SEQ = C.GRP_SEQ
     LEFT JOIN TUM_SVC_STOR_I D
            ON B.USER_ID   = D.USER_ID
           AND D.LANG_CODE = #{langCode}
     LEFT JOIN TST_GOOD_INFO_I E
            ON A.GOODS_CODE = E.GOODS_CODE
     LEFT JOIN OP_CODE_INDVDLZ F
            ON F.GROUP_CD = '2043'
           AND A.ASK_APPLY_CD = F.INDVDLZ_CD
         WHERE A.USER_ID    = #{suplerId}
         <choose>
             <when test="searchDiv01 == 1001">
                 <if test="searchKeyWord != null  and searchKeyWord != ''">
                     AND C.AUDITLOG_NM LIKE '%'||#{searchKeyWord}||'%'
                 </if>
             </when>
             <when test="searchDiv01 == 1002">
                 <if test="searchKeyWord != null  and searchKeyWord != ''">
                     AND D.LANG_STORE_NM LIKE '%'||#{searchKeyWord}||'%'
                 </if>
             </when>
         </choose>
         <if test="searchDiv02 != null  and searchDiv02 != ''">
             AND A.ASK_APPLY_CD = #{searchDiv02}
         </if>
         ORDER BY A.NOTIFY_NUM DESC, A.NOTIFY_SEQ DESC
    </select>
    
     <!--
     * SQL 명      : _suplerCeart.updateBeforeSplyConfmGbn
     * 기능(설명)  : 사전견적공고 공급자 확인정보의 확인여부 update
     * 작   성   자  : (주)엔키소프트
     * 작   성   일  : 2017-01-05
    -->
    <update id="updateBeforeSplyConfmGbn">
        /*_suplerCeart.updateBeforeSplyConfmGbn*/
        UPDATE TCN_BEFORE_ESTE_SPLY 
           SET CONFM_GBN = 'Y'
              ,ENTR_DT   = SYSDATE
         WHERE NOTIFY_NUM = #{notifyNum}
           AND NOTIFY_SEQ = #{notifySeq}
           AND USER_ID    = #{suplerId}
    </update>
    
    
    <!--
     * SQL 명      : _suplerCeart.suplerCeartBeforeNotifyInfo
     * 기능(설명)  : 사전견적공고정보 조회 - 공급자씨앗
     * 작   성   자  : (주)엔키소프트
     * 작   성   일  : 2017-01-05
    -->
    <select id="suplerCeartBeforeNotifyInfo" parameterType="map" resultType="SuplerCeartBidNotifyVO">
        /*_suplerCeart.suplerCeartBeforeNotifyInfo*/
        SELECT A.NOTIFY_NUM                       AS notifyNum
             , A.NOTIFY_SEQ                       AS notifySeq
             , A.BID_GBN_CD                       AS bidGbnCd
             , B.INDVDLZ_CD_NM                    AS bidGbnNm
             , A.GOOD_KND_CD                      AS goodKndCd
             , C.INDVDLZ_CD_NM                    AS goodKndNm
             , A.USER_ID                          AS endsUserId
             , O.USER_NM                          AS endsUserNm 
             , DECRYPT(O.MBTLNUM ,'P007')         AS endsMbtlnum
             , DECRYPT(O.EMAIL,'P008')            AS endsEmail
             , A.GRP_SEQ                          AS grpSeq
             , A.REAL_DMND_ORGN                   AS realDmndOrgn
             , A.GOODS_CHARGER_NM                 AS goodsChargerNm
             , A.GOODS_CHARGER_CTTPC              AS goodsChargerCttpc
             , A.USER_POSITION                    AS userPosition
             , A.HOPE_PUCH_AMT                    AS hopePuchAmt
             , A.VAT_GBN                          AS vatGbn
             , TO_CHAR(A.DELY_DT, 'YYYY-MM-DD')   AS delyDt
             , TO_CHAR(A.DELY_DT, 'HH24')         AS delyTime
             , A.TALK_GBN                         AS talkGbn
             , TO_CHAR(A.RPLY_DT, 'YYYY-MM-DD')   AS rplyDt
             , TO_CHAR(A.RPLY_DT, 'HH24')         AS rplyTime
             , A.DELY_PLAC                        AS delyPlac
             , A.DELY_FILE                        AS delyFile
             , K.LOCAL_ORGINL_NM                  AS delyFileOrgNm
             , K.FILE_ID                          AS delyFileId
             , K.FILE_SIZE                        AS delyFileSize
             , K.FILE_TY                          AS delyFileTy
             , A.ENTR_DT                          AS entrDt
             , A.UPDT_DT                          AS updtDt
             , TO_CHAR(A.CNCL_DT,'YYYY-MM-DD')    AS cnclDt
             , A.ADD_CONT                         AS addCont
          FROM TCN_BEFORE_ESTE_NOFY A
               LEFT JOIN OP_CODE_INDVDLZ B
                      ON B.LANG_CODE  = '00'
                     AND B.GROUP_CD   = '2037'
                     AND A.BID_GBN_CD = B.INDVDLZ_CD
               LEFT JOIN OP_CODE_INDVDLZ C
                      ON C.LANG_CODE   = '00'
                     AND C.GROUP_CD    = '1005'
                     AND A.GOOD_KND_CD = C.INDVDLZ_CD
               LEFT JOIN OP_FILE K
                      ON A.DELY_FILE = K.FILE_SEQ
               LEFT JOIN TCN_BEFORE_ESTE_SPLY M
                      ON A.NOTIFY_NUM = M.NOTIFY_NUM
                     AND A.NOTIFY_SEQ = M.NOTIFY_SEQ
               LEFT JOIN OP_USER O
                      ON A.USER_ID   = O.USER_ID
         WHERE A.NOTIFY_NUM = #{notifyNum}
           AND A.NOTIFY_SEQ = #{notifySeq}
    </select>
    
    <!--
     * SQL 명      : _suplerCeart.selectSuplerCeartBeforeNotifySplyInfo
     * 기능(설명)  : 입찰공고 공급자 확인정보 조회
     * 작   성   자  : (주)엔키소프트
     * 작   성   일  : 2017-01-05
    -->
    <select id="selectSuplerCeartBeforeNotifySplyInfo" parameterType="map" resultType="SuplerCeartNotifySplyVO">
        /*_suplerCeart.selectSuplerCeartBeforeNotifySplyInfo*/
        SELECT A.NOTIFY_NUM                    AS notifyNum
             , A.NOTIFY_SEQ                    AS notifySeq
             , A.USER_ID                       AS suplerId
             , G.LANG_STORE_NM                 AS suplerNm
             , A.GOODS_CODE                    AS goodsCode
             , B.GOODS_NM                      AS goodsName
             , A.CONFM_GBN                     AS confmGbn
             , A.ASK_APPLY_CD                  AS askApplyCd
             , C.INDVDLZ_CD_NM                 AS askApplyNm
             , A.SPLY_AMT                      AS splyAmt
             , A.VAT_GBN                       AS vatGbn
             , A.ADD_ANSWER                    AS addAnswer
             , A.SPLY_NOTE                     AS splyNote
             , A.SPLY_FILE                     AS splyFile
             , F.LOCAL_ORGINL_NM               AS splyFileOrgNm
             , F.FILE_ID                       AS splyFileId
             , F.FILE_SIZE                     AS splyFileSize
             , F.FILE_TY                       AS splyFileTy
             , TO_CHAR(A.ENTR_DT,'YYYY-MM-DD') AS entrDt
             , G.STORE_CHARGER_NM              AS storeChargerNm
             , DECRYPT(H.EMAIL,'P008')         AS reprsntEmail
             , G.REPRSNT_TELNO                 AS reprsntTelno
             , DECRYPT(H.MBTLNUM ,'P007')      AS mbtlnum
             , I.BIZRNO                        AS bizrno
             ,(SELECT BB.lang_store_nm FROM TUM_SVC_STOR_I BB WHERE BB.lang_code = '00' AND BB.user_id = A.USER_ID ) AS cmpnyNm             
          FROM TCN_BEFORE_ESTE_SPLY A
               INNER JOIN TST_GOOD_INFO_I B
                       ON A.GOODS_CODE = B.GOODS_CODE
                LEFT JOIN OP_CODE_INDVDLZ C
                      ON C.GROUP_CD     = '2043'
                     AND A.ASK_APPLY_CD = C.INDVDLZ_CD
                LEFT JOIN OP_FILE F
                       ON A.SPLY_FILE = F.FILE_SEQ
                LEFT JOIN TUM_SVC_STOR_I G
                       ON A.USER_ID = G.USER_ID
                      AND G.LANG_CODE = '00'
                LEFT JOIN OP_USER H
                       ON A.USER_ID = H.USER_ID
                LEFT JOIN OP_USER_ENTRPRS_OPTION I
                       ON G.USER_ID = I.USER_ID
         WHERE  1= 1
           AND A.NOTIFY_NUM = #{notifyNum}
           AND A.NOTIFY_SEQ = #{notifySeq}
           <if test="suplerId != null  and suplerId != ''">
           AND A.USER_ID    = #{suplerId}
           </if>
         ORDER BY A.ENTR_DT
    </select>
    
    <!--
     * SQL 명      : _suplerCeart.selectSuplerCeartBeforeInfoByPass
     * 기능(설명)  : 상세정보(사전견적)요청서 PaaS 조회
     * 작   성   자  : (주)엔키소프트
     * 작   성   일  : 2017-01-06
    -->
    <select id="selectSuplerCeartBeforeInfoByPass" parameterType="map" resultType="SuplerCeartPaasVO">
        /*_suplerCeart.selectSuplerCeartBeforeInfoByPass*/
        SELECT A.NOTIFY_NUM      AS notifyNum
             , A.NOTIFY_SEQ      AS notifySeq
             , A.USER_ID         AS endsUserId
             , #{suplerId}       AS suplerId
             , 'Y'               AS consumerYn
             , A.APPLY_GBN       AS applyGbn
             , A.LANG_SYS        AS langSys
             , A.FRAMEWORK_SYS   AS frameworkSys
             , A.CACHE_SYS       AS cacheSys
             , A.DBMS_SYS        AS dbmsSys
             , A.FAST_DEPLOY_SYS AS fastDeploySys
             , A.ETC_SYS         AS etcSys
          FROM TCN_BEFORE_PAAS_I A
         WHERE A.NOTIFY_NUM = #{notifyNum}
           AND A.NOTIFY_SEQ = #{notifySeq}
           AND A.USER_ID    = #{endsUserId}
        UNION ALL
        SELECT A.NOTIFY_NUM      AS notifyNum
             , A.NOTIFY_SEQ      AS notifySeq
             , A.USER_ID         AS endsUserId
             , B.USER_ID         AS suplerId
             , 'N'               AS consumerYn
             , B.APPLY_GBN       AS applyGbn
             , B.LANG_SYS        AS langSys
             , B.FRAMEWORK_SYS   AS frameworkSys
             , B.CACHE_SYS       AS cacheSys
             , B.DBMS_SYS        AS dbmsSys
             , B.FAST_DEPLOY_SYS AS fastDeploySys
             , B.ETC_SYS         AS etcSys
          FROM TCN_BEFORE_PAAS_I A
               LEFT JOIN TCN_BEFORE_PAAS_I B
                      ON A.NOTIFY_NUM = B.NOTIFY_NUM
                     AND A.NOTIFY_SEQ = B.NOTIFY_SEQ
                     AND B.USER_ID    = #{suplerId}
         WHERE A.NOTIFY_NUM = #{notifyNum}
           AND A.NOTIFY_SEQ = #{notifySeq}
           AND A.USER_ID    = #{endsUserId}
    </select>
    
    <!--
     * SQL 명        : _suplerCeart.selectSuplerCeartBeforeInfoByPass2
     * 기능(설명)    : 상세정보(사전견적)요청서 PaaS 조회
     * 작   성   자  : 이홍석
     * 작   성   일  : 2018-03
    -->
    <select id="selectSuplerCeartBeforeInfoByPass2" parameterType="map" resultType="SuplerCeartPaas2VO">
        
        /*_suplerCeart.selectSuplerCeartBeforeInfoByPass2*/
        
        SELECT A.NOTIFY_NUM      AS notifyNum
              ,A.NOTIFY_SEQ      AS notifySeq
              ,A.USER_ID         AS endsUserId
              ,#{suplerId}       AS suplerId
              ,'Y'               AS consumerYn
              ,A.APPLY_GBN       AS applyGbn
              
              ,A.HOSTINGMETHOD   AS hostingmethod               
              ,A.SCALING         AS scaling         
              ,A.PLATFORM        AS platform          
              ,A.RUNTIMES        AS runtimes          
              ,A.MIDDLEWARE      AS middlewares            
              ,A.FRAMEWORKS      AS frameworks            
              ,A.SERVICES        AS services          
              ,A.ADDONS          AS addons        
              ,A.EXTENDFUNCTION  AS extendfunction                
              ,A.GEOLOCATIONS    AS geolocations
          FROM TCN_BEFORE_PAAS2_I A
         WHERE A.NOTIFY_NUM = #{notifyNum}
           AND A.NOTIFY_SEQ = #{notifySeq}
           AND A.USER_ID    = #{endsUserId}
        
        UNION ALL
        
        SELECT A.NOTIFY_NUM      AS notifyNum
              ,A.NOTIFY_SEQ      AS notifySeq
              ,A.USER_ID         AS endsUserId
              ,B.USER_ID         AS suplerId
              ,'N'               AS consumerYn
              ,A.APPLY_GBN       AS applyGbn
              
              ,B.HOSTINGMETHOD   AS hostingmethod               
              ,B.SCALING         AS scaling         
              ,B.PLATFORM        AS platform          
              ,B.RUNTIMES        AS runtimes          
              ,B.MIDDLEWARE      AS middlewares            
              ,B.FRAMEWORKS      AS frameworks            
              ,B.SERVICES        AS services          
              ,B.ADDONS          AS addons        
              ,B.EXTENDFUNCTION  AS extendfunction                
              ,B.GEOLOCATIONS    AS geolocations
          FROM TCN_BEFORE_PAAS2_I A
     LEFT JOIN TCN_BEFORE_PAAS2_I B
            ON A.NOTIFY_NUM = B.NOTIFY_NUM
           AND A.NOTIFY_SEQ = B.NOTIFY_SEQ
           AND B.USER_ID    = #{suplerId}
         WHERE A.NOTIFY_NUM = #{notifyNum}
           AND A.NOTIFY_SEQ = #{notifySeq}
           AND A.USER_ID    = #{endsUserId}
           
    </select>

    <!--
     * SQL 명      : _suplerCeart.selectSuplerCeartBeforeInfoBySassI
     * 기능(설명)  : 상세정보(사전견적)요청서 SaaS 조회
     * 작   성   자  : (주)엔키소프트
     * 작   성   일  : 2017-01-05
    -->
    <select id="selectSuplerCeartBeforeInfoBySassI" parameterType="map" resultType="SuplerCeartSaasIVO">
        /*_suplerCeart.selectSuplerCeartBeforeInfoBySassI*/
        SELECT A.NOTIFY_NUM    AS notifyNum
             , A.NOTIFY_SEQ    AS notifySeq
             , A.USER_ID       AS endsUserId
             , #{suplerId}     AS suplerId
             , 'Y'             AS consumerYn
             , A.APPLY_GBN     AS applyGbn
             , A.UNIT_SYS      AS unitSys
             , B.INDVDLZ_CD_NM AS unitSysNm
             , A.ETC_UNIT_SYS  AS etcUnitSys
             , A.CAPTY_SYS     AS captySys
             , A.AMOUNT_SYS    AS amountSys
             , A.SPLY_MOTH_SYS AS splyMothSys
             , C.INDVDLZ_CD_NM AS splyMothSysNm
          FROM TCN_BEFORE_SAAS_I A
               LEFT JOIN OP_CODE_INDVDLZ B
                      ON B.GROUP_CD = '2041'
                     AND A.UNIT_SYS = B.INDVDLZ_CD
               LEFT JOIN OP_CODE_INDVDLZ C
                      ON C.GROUP_CD      = '2042'
                     AND A.SPLY_MOTH_SYS = C.INDVDLZ_CD
         WHERE A.NOTIFY_NUM = #{notifyNum}
           AND A.NOTIFY_SEQ = #{notifySeq}
           AND A.USER_ID    = #{endsUserId}
        UNION ALL
        SELECT A.NOTIFY_NUM    AS notifyNum
             , A.NOTIFY_SEQ    AS notifySeq
             , A.USER_ID       AS endsUserId
             , B.USER_ID       AS suplerId
             , 'N'             AS consumerYn
             , B.APPLY_GBN     AS applyGbn
             , B.UNIT_SYS      AS unitSys
             , C.INDVDLZ_CD_NM AS unitSysNm
             , B.ETC_UNIT_SYS  AS etcUnitSys
             , B.CAPTY_SYS     AS captySys
             , B.AMOUNT_SYS    AS amountSys
             , B.SPLY_MOTH_SYS AS splyMothSys
             , D.INDVDLZ_CD_NM AS splyMothSysNm
          FROM TCN_BEFORE_SAAS_I A
               LEFT JOIN TCN_BEFORE_SAAS_I B
                      ON A.NOTIFY_NUM = B.NOTIFY_NUM
                     AND A.NOTIFY_SEQ = B.NOTIFY_SEQ
                     AND B.USER_ID    = #{suplerId}
               LEFT JOIN OP_CODE_INDVDLZ C
                      ON C.GROUP_CD = '2041'
                     AND B.UNIT_SYS = C.INDVDLZ_CD
               LEFT JOIN OP_CODE_INDVDLZ D
                      ON D.GROUP_CD      = '2042'
                     AND B.SPLY_MOTH_SYS = D.INDVDLZ_CD
         WHERE A.NOTIFY_NUM = #{notifyNum}
           AND A.NOTIFY_SEQ = #{notifySeq}
           AND A.USER_ID    = #{endsUserId}
    </select>

    <!--
     * SQL 명        : _suplerCeart.selectSuplerCeartBeforeInfoBySass2I
     * 기능(설명)    : 상세정보(사전견적)요청서 SaaS2 조회
     * 작   성   자  : 이홍석
     * 작   성   일  : 2018-03
    -->
    <select id="selectSuplerCeartBeforeInfoBySass2I" parameterType="map" resultType="SuplerCeartSaas2IVO">
    
        /*_suplerCeart.selectSuplerCeartBeforeInfoBySass2I*/
        
        SELECT A.NOTIFY_NUM            AS notifyNum
              ,A.NOTIFY_SEQ            AS notifySeq
              ,A.USER_ID               AS endsUserId
              ,#{suplerId}             AS suplerId
              ,'Y'                     AS consumerYn
              ,A.APPLY_GBN             AS applyGbn
              
              ,A.SUPPORT_METHOD        AS supportMethod /** 제공방법 C */
              ,C.INDVDLZ_CD_NM         AS supportMethodNm
              ,A.USER_MANAGER_SEPARATE AS userManagerSeparate /** 사용자/관리자 분리 D */
              ,D.INDVDLZ_CD_NM         AS userManagerSeparateNm
              ,A.SERVICE_SUPPLY_METHOD AS serviceSupplyMethod /** 서비스제공방식 */
              ,A.ENCRYPTION            AS encryption          /** 암호화 */
              ,A.MULTIPLATFORM         AS multiPlatform       /** 다중플랫폼지원 */
          FROM TCN_BEFORE_SAAS2_I A
     LEFT JOIN OP_CODE_INDVDLZ C
            ON C.GROUP_CD   = '2042'
           AND C.INDVDLZ_CD = A.SUPPORT_METHOD
     LEFT JOIN OP_CODE_INDVDLZ D
            ON D.GROUP_CD   = '2061'
           AND D.INDVDLZ_CD = A.USER_MANAGER_SEPARATE
         WHERE A.NOTIFY_NUM = #{notifyNum}
           AND A.NOTIFY_SEQ = #{notifySeq}
           AND A.USER_ID    = #{endsUserId}
           
        UNION ALL
        
        SELECT A.NOTIFY_NUM    AS notifyNum
              ,A.NOTIFY_SEQ    AS notifySeq
              ,A.USER_ID       AS endsUserId
              ,B.USER_ID       AS suplerId
              ,'N'             AS consumerYn
              ,B.APPLY_GBN     AS applyGbn
              
              ,B.SUPPORT_METHOD        AS supportMethod /** 제공방법 C */
              ,C.INDVDLZ_CD_NM         AS supportMethodNm
              ,B.USER_MANAGER_SEPARATE AS userManagerSeparate /** 사용자/관리자 분리 D */
              ,D.INDVDLZ_CD_NM         AS userManagerSeparateNm
              ,B.SERVICE_SUPPLY_METHOD AS serviceSupplyMethod /** 서비스제공방식 */
              ,B.ENCRYPTION            AS encryption          /** 암호화 */
              ,B.MULTIPLATFORM         AS multiPlatform       /** 다중플랫폼지원 */
          FROM TCN_BEFORE_SAAS2_I A
     LEFT JOIN TCN_BEFORE_SAAS2_I B
            ON A.NOTIFY_NUM = B.NOTIFY_NUM
           AND A.NOTIFY_SEQ = B.NOTIFY_SEQ
           AND B.USER_ID    = #{suplerId}
     LEFT JOIN OP_CODE_INDVDLZ C
            ON C.GROUP_CD   = '2042'
           AND C.INDVDLZ_CD = B.SUPPORT_METHOD
     LEFT JOIN OP_CODE_INDVDLZ D
            ON D.GROUP_CD   = '2061'
           AND D.INDVDLZ_CD = B.USER_MANAGER_SEPARATE
         WHERE A.NOTIFY_NUM = #{notifyNum}
           AND A.NOTIFY_SEQ = #{notifySeq}
           AND A.USER_ID    = #{endsUserId}
           
    </select>

    <!--
     * SQL 명      : _suplerCeart.selectSuplerCeartBeforeInfoBySassD
     * 기능(설명)  : 상세정보(사전견적)요청서 SaaS 상세 조회
     * 작   성   자  : (주)엔키소프트
     * 작   성   일  : 2017-01-05
    -->
    <select id="selectSuplerCeartBeforeInfoBySassD" parameterType="map" resultType="SuplerCeartSaasDVO">
        /*_suplerCeart.selectMyCeartBeforeInfoBySassD*/
        SELECT A.NOTIFY_NUM    AS notifyNum
             , A.NOTIFY_SEQ    AS notifySeq
             , A.USER_ID       AS endsUserId
             , #{suplerId}     AS suplerId
             , 'Y'             AS consumerYn
             , A.APPLY_SEQ     AS applySeq
             , A.OPTION_NM     AS optionNm
             , A.UNIT_ITEM     AS unitItem
             , A.CAPTY_ITEM    AS captyItem
             , A.AMOUNT_ITEM   AS amountItem
             , A.CMNT_ITEM     AS cmntCd
             , C.INDVDLZ_CD_NM AS cmntItem
          FROM TCN_BEFORE_SAAS_D A
          	   LEFT JOIN OP_CODE_INDVDLZ C
                      ON C.GROUP_CD      = '2042'
                     AND TO_CHAR(A.CMNT_ITEM) = TO_CHAR(C.INDVDLZ_CD)
         WHERE A.NOTIFY_NUM = #{notifyNum}
           AND A.NOTIFY_SEQ = #{notifySeq}
           AND A.USER_ID    = #{endsUserId}
        UNION ALL
        SELECT A.NOTIFY_NUM    AS notifyNum
             , A.NOTIFY_SEQ    AS notifySeq
             , A.USER_ID       AS endsUserId
             , B.USER_ID       AS suplerId
             , 'N'             AS consumerYn
             , A.APPLY_SEQ     AS applySeq
             , B.OPTION_NM     AS optionNm
             , B.UNIT_ITEM     AS unitItem
             , B.CAPTY_ITEM    AS captyItem
             , B.AMOUNT_ITEM   AS amountItem
             , B.CMNT_ITEM     AS cmntCd
             , C.INDVDLZ_CD_NM AS cmntItem
          FROM TCN_BEFORE_SAAS_D A
               LEFT JOIN TCN_BEFORE_SAAS_D B
                      ON A.NOTIFY_NUM = B.NOTIFY_NUM
                     AND A.NOTIFY_SEQ = B.NOTIFY_SEQ
                     AND A.APPLY_SEQ  = B.APPLY_SEQ
                     AND B.USER_ID    = #{suplerId}
               LEFT JOIN OP_CODE_INDVDLZ C
                      ON C.GROUP_CD      = '2042'
                     AND TO_CHAR(B.CMNT_ITEM) = TO_CHAR(C.INDVDLZ_CD)                            
         WHERE A.NOTIFY_NUM = #{notifyNum}
           AND A.NOTIFY_SEQ = #{notifySeq}
           AND A.USER_ID    = #{endsUserId}
         ORDER BY A.NOTIFY_NUM, A.NOTIFY_SEQ, A.APPLY_SEQ
    </select>

    <!--
     * SQL 명        : _suplerCeart.selectSuplerCeartBeforeInfoBySass2Dn
     * 기능(설명)    : 상세정보(사전견적)요청서 SaaS2 상세Need 조회
     * 작   성   자  : 이홍석
     * 작   성   일  : 2018-03
    -->
    <select id="selectSuplerCeartBeforeInfoBySass2Dn" parameterType="map" resultType="SuplerCeartSaas2DnVO">
        
        /*_suplerCeart.selectSuplerCeartBeforeInfoBySass2Dn*/
        
        SELECT A.NOTIFY_NUM    AS notifyNum
              ,A.NOTIFY_SEQ    AS notifySeq
              ,A.USER_ID       AS endsUserId
              ,#{suplerId}     AS suplerId
              ,'Y'             AS consumerYn
              ,A.NEED_SEQ      AS needSeq
              
              ,A.FUNCTIONNAME  AS functionName
              ,A.AMOUNT        AS amount
              ,A.UNITCODE      AS unitCode
              ,C.INDVDLZ_CD_NM AS unitCodeNm             
          FROM TCN_BEFORE_SAAS2_DN A
	 LEFT JOIN OP_CODE_INDVDLZ C
            ON C.GROUP_CD      = '2042'
           AND TO_CHAR(C.INDVDLZ_CD) = TO_CHAR(A.UNITCODE)
         WHERE A.NOTIFY_NUM = #{notifyNum}
           AND A.NOTIFY_SEQ = #{notifySeq}
           AND A.USER_ID    = #{endsUserId}
           
        UNION ALL
        
        SELECT A.NOTIFY_NUM    AS notifyNum
              ,A.NOTIFY_SEQ    AS notifySeq
              ,A.USER_ID       AS endsUserId
              ,B.USER_ID       AS suplerId
              ,'N'             AS consumerYn
              ,A.NEED_SEQ      AS needSeq
              
              ,B.FUNCTIONNAME  AS functionName
              ,B.AMOUNT        AS amount
              ,B.UNITCODE      AS unitCode
              ,C.INDVDLZ_CD_NM AS unitCodeNm             
          FROM TCN_BEFORE_SAAS2_DN A
     LEFT JOIN TCN_BEFORE_SAAS2_DN B
            ON A.NOTIFY_NUM = B.NOTIFY_NUM
           AND A.NOTIFY_SEQ = B.NOTIFY_SEQ
           AND A.NEED_SEQ    = B.NEED_SEQ
           AND B.USER_ID    = #{suplerId}
     LEFT JOIN OP_CODE_INDVDLZ C
            ON C.GROUP_CD      = '2042'
           AND TO_CHAR(B.UNITCODE) = TO_CHAR(C.INDVDLZ_CD)                            
         WHERE A.NOTIFY_NUM = #{notifyNum}
           AND A.NOTIFY_SEQ = #{notifySeq}
           AND A.USER_ID    = #{endsUserId}
      ORDER BY A.NOTIFY_NUM
              ,A.NOTIFY_SEQ
              ,A.NEED_SEQ
              
    </select>

    <!--
     * SQL 명        : _suplerCeart.selectSuplerCeartBeforeInfoBySass2Do
     * 기능(설명)    : 상세정보(사전견적)요청서 SaaS2 상세Option 조회
     * 작   성   자  : 이홍석
     * 작   성   일  : 2018-03
    -->
    <select id="selectSuplerCeartBeforeInfoBySass2Do" parameterType="map" resultType="SuplerCeartSaas2DoVO">
        
        /*_suplerCeart.selectSuplerCeartBeforeInfoBySass2Do*/
        
        SELECT A.NOTIFY_NUM    AS notifyNum
              ,A.NOTIFY_SEQ    AS notifySeq
              ,A.USER_ID       AS endsUserId
              ,#{suplerId}     AS suplerId
              ,'Y'             AS consumerYn
              ,A.NEED_SEQ      AS needSeq              
              ,A.OPTION_SEQ    AS option_seq
                           
              ,A.FUNCTIONNAME  AS functionName
              ,A.AMOUNT        AS amount
              ,A.UNITCODE      AS unitCode
              ,C.INDVDLZ_CD_NM AS unitCodeNm             
          FROM TCN_BEFORE_SAAS2_DO A
 	 LEFT JOIN OP_CODE_INDVDLZ C
            ON C.GROUP_CD      = '2042'
           AND TO_CHAR(C.INDVDLZ_CD) = TO_CHAR(A.UNITCODE)
         WHERE A.NOTIFY_NUM = #{notifyNum}
           AND A.NOTIFY_SEQ = #{notifySeq}
           AND A.USER_ID    = #{endsUserId}
           
        UNION ALL
        
        SELECT A.NOTIFY_NUM    AS notifyNum
              ,A.NOTIFY_SEQ    AS notifySeq
              ,A.USER_ID       AS endsUserId
              ,B.USER_ID       AS suplerId
              ,'N'             AS consumerYn
              ,A.NEED_SEQ      AS needSeq              
              ,A.OPTION_SEQ    AS option_seq
              
              ,B.FUNCTIONNAME  AS functionName
              ,B.AMOUNT        AS amount
              ,B.UNITCODE      AS unitCode
              ,C.INDVDLZ_CD_NM AS unitCodeNm
          FROM TCN_BEFORE_SAAS2_DO A
     LEFT JOIN TCN_BEFORE_SAAS2_DO B
            ON A.NOTIFY_NUM = B.NOTIFY_NUM
           AND A.NOTIFY_SEQ = B.NOTIFY_SEQ
           AND A.NEED_SEQ   = B.NEED_SEQ
           AND A.OPTION_SEQ = B.OPTION_SEQ
           AND B.USER_ID    = #{suplerId}
     LEFT JOIN OP_CODE_INDVDLZ C
            ON C.GROUP_CD      = '2042'
           AND TO_CHAR(B.UNITCODE) = TO_CHAR(C.INDVDLZ_CD)                            
         WHERE A.NOTIFY_NUM = #{notifyNum}
           AND A.NOTIFY_SEQ = #{notifySeq}
           AND A.USER_ID    = #{endsUserId}
      ORDER BY A.NOTIFY_NUM
              ,A.NOTIFY_SEQ
              ,A.NEED_SEQ              
              ,A.OPTION_SEQ
         
    </select>

    <!--
     * SQL 명      : _suplerCeart.suplerCeartBeforeInfoByIassI
     * 기능(설명)  : 상세정보(사전견적)요청서 IaaS 마스터 정보 조회
     * 작   성   자  : (주)엔키소프트
     * 작   성   일  : 2017-01-06
    -->
    <select id="suplerCeartBeforeInfoByIassI" parameterType="map" resultType="SuplerCeartIaasIVO">
        /*_suplerCeart.suplerCeartBeforeInfoByIassI*/
        SELECT A.NOTIFY_NUM      AS notifyNum
             , A.NOTIFY_SEQ      AS notifySeq
             , A.USER_ID         AS endsUserId
             , #{suplerId}       AS suplerId
             , 'Y'               AS consumerYn
             , A.APPLY_GBN       AS applyGbn
             , A.CDN_TRANS_VLMN  AS cdnTransVlmn
             , A.CDN_REQU_CNT    AS cdnRequCnt
             , A.WEB_GOODS_KIND  AS webGoodsKind
             , A.WEB_ACCESS      AS webAccess
             , A.MNTING_VM       AS mntingVm
             , A.MNTING_ID_CNT   AS mntingIdCnt
             , A.BAKUP_CNT       AS bakupCnt
             , A.BAKUP_STORG     AS bakupStorg
             , A.MANG_FUNC       AS mangFunc
             , A.SECTY_VPN       AS sectyVpn
             , A.SECTY_SSLVPN    AS sectySslvpn
             , A.TECH_SUPT       AS techSupt
             , A.FUNC_DMND1      AS funcDmnd1
             , A.FUNC_DMND2      AS funcDmnd2
             , A.FUNC_DMND3      AS funcDmnd3
             , A.FUNC_DMND4      AS funcDmnd4
             , A.INTERFACE_DMND  AS interfaceDmnd
             , A.SECTY_DMND1     AS sectyDmnd1
             , A.SECTY_DMND2     AS sectyDmnd2
             , A.SECTY_DMND3     AS sectyDmnd3
             , A.SECTY_DMND4     AS sectyDmnd4
             , A.SECTY_DMND5     AS sectyDmnd5
             , A.QUTY_DMND1      AS qutyDmnd1
             , A.QUTY_DMND2      AS qutyDmnd2
             , A.OPTN_DMND1      AS optnDmnd1
             , A.OPTN_DMND2      AS optnDmnd2
             , A.PRJT_DMND1      AS prjtDmnd1
             , A.PRJT_DMND2      AS prjtDmnd2
             , A.PRJT_DMND3      AS prjtDmnd3
             , A.ETC_DMND        AS etcDmnd
          FROM TCN_BEFORE_IAAS_I A
         WHERE A.NOTIFY_NUM = #{notifyNum}
           AND A.NOTIFY_SEQ = #{notifySeq}
           AND A.USER_ID    = #{endsUserId}
        UNION ALL
        SELECT A.NOTIFY_NUM      AS notifyNum
             , A.NOTIFY_SEQ      AS notifySeq
             , A.USER_ID         AS endsUserId
             , B.USER_ID         AS suplerId
             , 'N'               AS consumerYn
             , B.APPLY_GBN       AS applyGbn
             , B.CDN_TRANS_VLMN  AS cdnTransVlmn
             , B.CDN_REQU_CNT    AS cdnRequCnt
             , B.WEB_GOODS_KIND  AS webGoodsKind
             , B.WEB_ACCESS      AS webAccess
             , B.MNTING_VM       AS mntingVm
             , B.MNTING_ID_CNT   AS mntingIdCnt
             , B.BAKUP_CNT       AS bakupCnt
             , B.BAKUP_STORG     AS bakupStorg
             , B.MANG_FUNC       AS mangFunc
             , B.SECTY_VPN       AS sectyVpn
             , B.SECTY_SSLVPN    AS sectySslvpn
             , B.TECH_SUPT       AS techSupt
             , B.FUNC_DMND1      AS funcDmnd1
             , B.FUNC_DMND2      AS funcDmnd2
             , B.FUNC_DMND3      AS funcDmnd3
             , B.FUNC_DMND4      AS funcDmnd4
             , B.INTERFACE_DMND  AS interfaceDmnd
             , B.SECTY_DMND1     AS sectyDmnd1
             , B.SECTY_DMND2     AS sectyDmnd2
             , B.SECTY_DMND3     AS sectyDmnd3
             , B.SECTY_DMND4     AS sectyDmnd4
             , B.SECTY_DMND5     AS sectyDmnd5
             , B.QUTY_DMND1      AS qutyDmnd1
             , B.QUTY_DMND2      AS qutyDmnd2
             , B.OPTN_DMND1      AS optnDmnd1
             , B.OPTN_DMND2      AS optnDmnd2
             , B.PRJT_DMND1      AS prjtDmnd1
             , B.PRJT_DMND2      AS prjtDmnd2
             , B.PRJT_DMND3      AS prjtDmnd3
             , B.ETC_DMND        AS etcDmnd
          FROM TCN_BEFORE_IAAS_I A
               LEFT JOIN TCN_BEFORE_IAAS_I B
                      ON A.NOTIFY_NUM = B.NOTIFY_NUM
                     AND A.NOTIFY_SEQ = B.NOTIFY_SEQ
                     AND B.USER_ID    = #{suplerId}
         WHERE A.NOTIFY_NUM = #{notifyNum}
           AND A.NOTIFY_SEQ = #{notifySeq}
           AND A.USER_ID    = #{endsUserId}
    </select>

    <!--
     * SQL 명        : _suplerCeart.suplerCeartBeforeInfoByIass2I
     * 기능(설명)    : 상세정보(사전견적)요청서 Iaa2S 마스터 정보 조회
     * 작   성   자  : 이홍석
     * 작   성   일  : 2018-03
    -->
    <select id="suplerCeartBeforeInfoByIass2I" parameterType="map" resultType="SuplerCeartIaas2IVO">
        
        /*_suplerCeart.suplerCeartBeforeInfoByIass2I*/
        
       SELECT A.NOTIFY_NUM        AS notifyNum
             ,A.NOTIFY_SEQ        AS notifySeq
             ,A.USER_ID           AS endsUserId
             ,#{suplerId}         AS suplerId
             ,'Y'                 AS consumerYn
             ,A.APPLY_GBN         AS applyGbn
             
             ,A.SERVER_IP         AS serverIp                      
			 ,A.SERVER_NETWORK    AS serverNetwork                           
			 ,A.SERVER_GSLB       AS serverGslb                        
			 ,A.SERVER_LDBL       AS serverLdbl                        
			 ,A.SERVER_SNAP       AS serverSnap                        
			 ,A.SERVER_IMG        AS serverImg                       
			 ,A.DB_IP             AS dbIp                  
			 ,A.DB_NETWORK        AS dbNetwork                       
			 ,A.DB_ADDDISK        AS dbAddDisk                       
			 ,A.DB_BACKSTORG      AS dbBackStorg                         
			 ,A.DB_STORG_SPACE    AS dbStorgSpace                           
			 ,A.DB_TRANS_VLMN     AS dbTransVlmn                          
			 ,A.CDN_TRANS_VLMN    AS cdnTransVlmn                           
			 ,A.CDN_REQU_CNT      AS cdnRequCnt                         
			 ,A.WEB_GOODS_KIND    AS webGoodsKind                           
			 ,A.WEB_ACCESS        AS webAccess                       
			 ,A.MNTING_VM         AS mntingVm                      
			 ,A.MNTING_ID_CNT     AS mntingIdCnt                          
			 ,A.BAKUP_CNT         AS bakupCnt                      
			 ,A.BAKUP_STORG       AS bakupStorg                        
			 ,A.MANG_FUNC         AS mangFunc                      
			 ,A.SECTY_VPN         AS sectyVpn                      
			 ,A.SECTY_SSLVPN      AS sectySslvpn                         
			 ,A.ADDED_ETC         AS addedEtc
         FROM TCN_BEFORE_IAAS2_I A
        WHERE A.NOTIFY_NUM = #{notifyNum}
          AND A.NOTIFY_SEQ = #{notifySeq}
          AND A.USER_ID    = #{endsUserId}
           
        UNION ALL
        
        SELECT A.NOTIFY_NUM        AS notifyNum
              ,A.NOTIFY_SEQ        AS notifySeq
              ,A.USER_ID           AS endsUserId
              ,B.USER_ID           AS suplerId
              ,'N'                 AS consumerYn
              ,B.APPLY_GBN         AS applyGbn
             
              ,B.SERVER_IP         AS serverIp                      
		 	  ,B.SERVER_NETWORK    AS serverNetwork                           
		 	  ,B.SERVER_GSLB       AS serverGslb                        
		 	  ,B.SERVER_LDBL       AS serverLdbl                        
			  ,B.SERVER_SNAP       AS serverSnap                        
			  ,B.SERVER_IMG        AS serverImg                       
			  ,B.DB_IP             AS dbIp                  
			  ,B.DB_NETWORK        AS dbNetwork                       
			  ,B.DB_ADDDISK        AS dbAddDisk                       
			  ,B.DB_BACKSTORG      AS dbBackStorg                         
			  ,B.DB_STORG_SPACE    AS dbStorgSpace                           
			  ,B.DB_TRANS_VLMN     AS dbTransVlmn                          
			  ,B.CDN_TRANS_VLMN    AS cdnTransVlmn                           
			  ,B.CDN_REQU_CNT      AS cdnRequCnt                         
			  ,B.WEB_GOODS_KIND    AS webGoodsKind                           
			  ,B.WEB_ACCESS        AS webAccess                       
			  ,B.MNTING_VM         AS mntingVm                      
			  ,B.MNTING_ID_CNT     AS mntingIdCnt                          
			  ,B.BAKUP_CNT         AS bakupCnt                      
			  ,B.BAKUP_STORG       AS bakupStorg                        
			  ,B.MANG_FUNC         AS mangFunc                      
			  ,B.SECTY_VPN         AS sectyVpn                      
			  ,B.SECTY_SSLVPN      AS sectySslvpn                         
			  ,B.ADDED_ETC         AS addedEtc
          FROM TCN_BEFORE_IAAS2_I A
     LEFT JOIN TCN_BEFORE_IAAS2_I B
            ON A.NOTIFY_NUM = B.NOTIFY_NUM
           AND A.NOTIFY_SEQ = B.NOTIFY_SEQ
           AND B.USER_ID    = #{suplerId}
         WHERE A.NOTIFY_NUM = #{notifyNum}
           AND A.NOTIFY_SEQ = #{notifySeq}
           AND A.USER_ID    = #{endsUserId}
           
    </select>
    
    <!--
     * SQL 명      : _suplerCeart.suplerCeartBeforeInfoByIassDs
     * 기능(설명)  : 상세정보(사전견적)요청서 IaaS 서버문의 조회
     * 작   성   자  : (주)엔키소프트
     * 작   성   일  : 2017-01-06
    -->
    <select id="suplerCeartBeforeInfoByIassDs" parameterType="map" resultType="SuplerCeartIaasDsVO">
        /*_suplerCeart.suplerCeartBeforeInfoByIassDs*/
        SELECT A.NOTIFY_NUM      AS notifyNum
             , A.NOTIFY_SEQ      AS notifySeq
             , A.USER_ID         AS endsUserId
             , #{suplerId}       AS suplerId
             , 'Y'               AS consumerYn
             , A.APPLY_SEQ       AS applySeq
             , A.SERVER_USE      AS serverUse
             , A.SERVER_OS       AS serverOs
             , A.SERVER_CPU      AS serverCpu
             , A.SERVER_MEMORY   AS serverMemory
             , A.SERVER_DISK     AS serverDisk
             , A.SERVER_QNTY     AS serverQnty
             , A.SERVER_IP       AS serverIp
             , A.SERVER_NETWORK  AS serverNetwork
             , A.SERVER_GSLB     AS serverGslb
             , A.SERVER_LDBL     AS serverLdbl
             , A.SERVER_SNAP     AS serverSnap
             , A.SERVER_IMG      AS serverImg
          FROM TCN_BEFORE_IAAS_DS A
         WHERE A.NOTIFY_NUM = #{notifyNum}
           AND A.NOTIFY_SEQ = #{notifySeq}
           AND A.USER_ID    = #{endsUserId}
        UNION ALL
        SELECT A.NOTIFY_NUM      AS notifyNum
             , A.NOTIFY_SEQ      AS notifySeq
             , A.USER_ID         AS endsUserId
             , B.USER_ID         AS suplerId
             , 'N'               AS consumerYn
             , A.APPLY_SEQ       AS applySeq
             , B.SERVER_USE      AS serverUse
             , B.SERVER_OS       AS serverOs
             , B.SERVER_CPU      AS serverCpu
             , B.SERVER_MEMORY   AS serverMemory
             , B.SERVER_DISK     AS serverDisk
             , B.SERVER_QNTY     AS serverQnty
             , B.SERVER_IP       AS serverIp
             , B.SERVER_NETWORK  AS serverNetwork
             , B.SERVER_GSLB     AS serverGslb
             , B.SERVER_LDBL     AS serverLdbl
             , B.SERVER_SNAP     AS serverSnap
             , B.SERVER_IMG      AS serverImg
          FROM TCN_BEFORE_IAAS_DS A
               LEFT JOIN TCN_BEFORE_IAAS_DS B
                      ON A.NOTIFY_NUM = B.NOTIFY_NUM
                     AND A.NOTIFY_SEQ = B.NOTIFY_SEQ
                     AND B.USER_ID    = #{suplerId}
         WHERE A.NOTIFY_NUM = #{notifyNum}
           AND A.NOTIFY_SEQ = #{notifySeq}
           AND A.USER_ID    = #{endsUserId}
         ORDER BY A.NOTIFY_NUM, A.NOTIFY_SEQ, A.APPLY_SEQ
    </select>
    
    <!--
     * SQL 명        : _suplerCeart.suplerCeartBeforeInfoByIass2Ds
     * 기능(설명)    : 상세정보(사전견적)요청서 Iaa2S 서버문의 조회
     * 작   성   자  : 이홍석
     * 작   성   일  : 2018-03
    -->
    <select id="suplerCeartBeforeInfoByIass2Ds" parameterType="map" resultType="SuplerCeartIaas2DsVO">
    
        /*_suplerCeart.suplerCeartBeforeInfoByIass2Ds*/
        
        SELECT A.NOTIFY_NUM      AS notifyNum
              ,A.NOTIFY_SEQ      AS notifySeq
              ,A.USER_ID         AS endsUserId
              ,#{suplerId}       AS suplerId
              ,'Y'               AS consumerYn             
              ,A.SERVER_SEQ      AS serverSeq
              
              ,A.SERVER_USE      AS serverUse
              ,A.SERVER_OS       AS serverOs
              ,A.SERVER_CPU      AS serverCpu
              ,A.SERVER_MEMORY   AS serverMemory
              ,A.SERVER_DISK     AS serverDisk
              ,A.SERVER_QNTY     AS serverQnty
          FROM TCN_BEFORE_IAAS2_DS A
         WHERE A.NOTIFY_NUM = #{notifyNum}
           AND A.NOTIFY_SEQ = #{notifySeq}
           AND A.USER_ID    = #{endsUserId}
           
        UNION ALL
        
        SELECT A.NOTIFY_NUM      AS notifyNum
              ,A.NOTIFY_SEQ      AS notifySeq
              ,A.USER_ID         AS endsUserId
              ,B.USER_ID         AS suplerId
              ,'N'               AS consumerYn             
              ,A.SERVER_SEQ      AS serverSeq
              
              ,B.SERVER_USE      AS serverUse
              ,B.SERVER_OS       AS serverOs
              ,B.SERVER_CPU      AS serverCpu
              ,B.SERVER_MEMORY   AS serverMemory
              ,B.SERVER_DISK     AS serverDisk
              ,B.SERVER_QNTY     AS serverQnty
          FROM TCN_BEFORE_IAAS2_DS A
     LEFT JOIN TCN_BEFORE_IAAS2_DS B
            ON A.NOTIFY_NUM = B.NOTIFY_NUM
           AND A.NOTIFY_SEQ = B.NOTIFY_SEQ
           AND B.USER_ID    = #{suplerId}
         WHERE A.NOTIFY_NUM = #{notifyNum}
           AND A.NOTIFY_SEQ = #{notifySeq}
           AND A.USER_ID    = #{endsUserId}
      ORDER BY A.NOTIFY_NUM
              ,A.NOTIFY_SEQ
              ,A.SERVER_SEQ
         
    </select>

    <!--
     * SQL 명      : _suplerCeart.suplerCeartBeforeInfoByIassDd
     * 기능(설명)  : 상세정보(사전견적)요청서 IaaS DB문의 조회
     * 작   성   자  : (주)엔키소프트
     * 작   성   일  : 2017-01-06
    -->
    <select id="suplerCeartBeforeInfoByIassDd" parameterType="map" resultType="SuplerCeartIaasDdVO">
        /*_suplerCeart.suplerCeartBeforeInfoByIassDd*/
        SELECT A.NOTIFY_NUM      AS notifyNum
             , A.NOTIFY_SEQ      AS notifySeq
             , A.USER_ID         AS endsUserId
             , #{suplerId}       AS suplerId
             , 'Y'               AS consumerYn
             , A.APPLY_SEQ       AS applySeq
             , A.DB_USE          AS dbUse
             , A.DB_OS           AS dbOs
             , A.DB_CPU          AS dbCpu
             , A.DB_MEMORY       AS dbMemory
             , A.DB_DISK         AS dbDisk
             , A.DB_QNTY         AS dbQnty
             , A.DB_IP           AS dbIp
             , A.DB_NETWORK      AS dbNetwork
             , A.DB_ADD_DISK     AS dbAddDisk
             , A.DB_BACK_STORG   AS dbBackStorg
             , A.DB_STORG_SPACE  AS dbStorgSpace
             , A.DB_TRANS_VLMN   AS dbTransVlmn
          FROM TCN_BEFORE_IAAS_DD A
         WHERE A.NOTIFY_NUM = #{notifyNum}
           AND A.NOTIFY_SEQ = #{notifySeq}
           AND A.USER_ID    = #{endsUserId}
        UNION ALL
        SELECT A.NOTIFY_NUM      AS notifyNum
             , A.NOTIFY_SEQ      AS notifySeq
             , A.USER_ID         AS endsUserId
             , B.USER_ID         AS suplerId
             , 'N'               AS consumerYn
             , A.APPLY_SEQ       AS applySeq
             , B.DB_USE          AS dbUse
             , B.DB_OS           AS dbOs
             , B.DB_CPU          AS dbCpu
             , B.DB_MEMORY       AS dbMemory
             , B.DB_DISK         AS dbDisk
             , B.DB_QNTY         AS dbQnty
             , B.DB_IP           AS dbIp
             , B.DB_NETWORK      AS dbNetwork
             , B.DB_ADD_DISK     AS dbAddDisk
             , B.DB_BACK_STORG   AS dbBackStorg
             , B.DB_STORG_SPACE  AS dbStorgSpace
             , B.DB_TRANS_VLMN   AS dbTransVlmn
          FROM TCN_BEFORE_IAAS_DD A
               LEFT JOIN TCN_BEFORE_IAAS_DD B
                      ON A.NOTIFY_NUM = B.NOTIFY_NUM
                     AND A.NOTIFY_SEQ = B.NOTIFY_SEQ
                     AND B.USER_ID    = #{suplerId}
         WHERE A.NOTIFY_NUM = #{notifyNum}
           AND A.NOTIFY_SEQ = #{notifySeq}
           AND A.USER_ID    = #{endsUserId}
         ORDER BY A.NOTIFY_NUM, A.NOTIFY_SEQ, A.APPLY_SEQ
    </select>

    <!--
     * SQL 명        : _suplerCeart.suplerCeartBeforeInfoByIass2Dd
     * 기능(설명)    : 상세정보(사전견적)요청서 IaaS DB문의 조회
     * 작   성   자  : 이홍석
     * 작   성   일  : 2018-03
    -->
    <select id="suplerCeartBeforeInfoByIass2Dd" parameterType="map" resultType="SuplerCeartIaas2DdVO">
    
        /*_suplerCeart.suplerCeartBeforeInfoByIass2Dd*/
        
        SELECT A.NOTIFY_NUM      AS notifyNum
              ,A.NOTIFY_SEQ      AS notifySeq
              ,A.USER_ID         AS endsUserId
              ,#{suplerId}       AS suplerId
              ,'Y'               AS consumerYn
              ,A.DB_SEQ          AS dbSeq
             
              ,A.DB_USE          AS dbUse
              ,A.DB_OS           AS dbOs
              ,A.DB_CPU          AS dbCpu
              ,A.DB_MEMORY       AS dbMemory
              ,A.DB_DISK         AS dbDisk
              ,A.DB_QNTY         AS dbQnty
          FROM TCN_BEFORE_IAAS2_DD A
         WHERE A.NOTIFY_NUM = #{notifyNum}
           AND A.NOTIFY_SEQ = #{notifySeq}
           AND A.USER_ID    = #{endsUserId}
           
        UNION ALL
        
        SELECT A.NOTIFY_NUM      AS notifyNum
              ,A.NOTIFY_SEQ      AS notifySeq
              ,A.USER_ID         AS endsUserId
              ,B.USER_ID         AS suplerId
              ,'N'               AS consumerYn
              ,A.DB_SEQ          AS dbSeq
              
              ,B.DB_USE          AS dbUse
              ,B.DB_OS           AS dbOs
              ,B.DB_CPU          AS dbCpu
              ,B.DB_MEMORY       AS dbMemory
              ,B.DB_DISK         AS dbDisk
              ,B.DB_QNTY         AS dbQnty
          FROM TCN_BEFORE_IAAS2_DD A
     LEFT JOIN TCN_BEFORE_IAAS2_DD B
            ON A.NOTIFY_NUM = B.NOTIFY_NUM
           AND A.NOTIFY_SEQ = B.NOTIFY_SEQ
           AND B.USER_ID    = #{suplerId}
         WHERE A.NOTIFY_NUM = #{notifyNum}
           AND A.NOTIFY_SEQ = #{notifySeq}
           AND A.USER_ID    = #{endsUserId}
      ORDER BY A.NOTIFY_NUM
              ,A.NOTIFY_SEQ
              ,A.DB_SEQ
         
    </select>
    

    <!--
     * SQL 명        : _suplerCeart.suplerCeartBeforeInfoByScs2
     * 기능(설명)    : 상세정보(사전견적)요청서 IaaS DB문의 조회
     * 작   성   자  : 이홍석
     * 작   성   일  : 2018-03
    -->
    <select id="suplerCeartBeforeInfoByScs2" parameterType="map" resultType="SuplerCeartScs2VO">
    
    	/*_suplerCeart.suplerCeartBeforeInfoByScs2*/
    	
    	SELECT A.NOTIFY_NUM      AS notifyNum
              ,A.NOTIFY_SEQ      AS notifySeq
              ,A.USER_ID         AS endsUserId
              ,#{suplerId}       AS suplerId
              ,'Y'               AS consumerYn
              ,A.APPLY_GBN       AS applyGbn
              
              ,A.CNSL_RELM       AS cnslRelm
              ,A.CNSL_RELM_ETC   AS cnslRelmEtc
              ,A.CNSL_SCOPE      AS cnslScope
              ,A.EXC_AREA        AS excArea
              ,A.INDC_WHOLE      AS indcWhole
              ,A.SETUP_MGR       AS setupMgr
              ,A.OPER            AS oper
              ,A.QLITY_TEST      AS qlityTest
              ,A.SCRTY           AS scrty
              ,A.EDUCATION       AS education
          FROM TCN_BEFORE_SCS2_I A
         WHERE A.NOTIFY_NUM = #{notifyNum}
           AND A.NOTIFY_SEQ = #{notifySeq}
           AND A.USER_ID    = #{endsUserId}
        
        UNION ALL
        
        SELECT A.NOTIFY_NUM      AS notifyNum
              ,A.NOTIFY_SEQ      AS notifySeq
              ,A.USER_ID         AS endsUserId
              ,B.USER_ID         AS suplerId
              ,'N'               AS consumerYn
              ,A.APPLY_GBN       AS applyGbn
              
              ,B.CNSL_RELM       AS cnslRelm
              ,B.CNSL_RELM_ETC   AS cnslRelmEtc
              ,B.CNSL_SCOPE      AS cnslScope
              ,B.EXC_AREA        AS excArea
              ,B.INDC_WHOLE      AS indcWhole
              ,B.SETUP_MGR       AS setupMgr
              ,B.OPER            AS oper
              ,B.QLITY_TEST      AS qlityTest
              ,B.SCRTY           AS scrty
              ,B.EDUCATION       AS education
          FROM TCN_BEFORE_SCS2_I A
     LEFT JOIN TCN_BEFORE_SCS2_I B
            ON A.NOTIFY_NUM = B.NOTIFY_NUM
           AND A.NOTIFY_SEQ = B.NOTIFY_SEQ
           AND B.USER_ID    = #{suplerId}
         WHERE A.NOTIFY_NUM = #{notifyNum}
           AND A.NOTIFY_SEQ = #{notifySeq}
           AND A.USER_ID    = #{endsUserId}
    
    </select>
    
     <!--
     * SQL 명      : _suplerCeart.updateBeforeNotifySply
     * 기능(설명)  : 견적요청서 관리 상세정보 발송처리
     * 작   성   자  : (주)엔키소프트
     * 작   성   일  : 2017-01-05
    -->
    <update id="updateBeforeNotifySply">
        /*_suplerCeart.updateBeforeNotifySply*/
        UPDATE TCN_BEFORE_ESTE_SPLY 
           SET ASK_APPLY_CD = '1004' /*발송처리*/
              ,SPLY_AMT     = #{splyAmt}
              ,VAT_GBN      = 'Y'
              ,ADD_ANSWER   = #{addAnswer}
              ,SPLY_NOTE    = #{splyNote}
              ,SPLY_FILE    = #{splyFile}
         WHERE NOTIFY_NUM = #{notifyNum}
           AND NOTIFY_SEQ = #{notifySeq}
           AND USER_ID    = #{suplerId}
    </update>
    
    <!--
     * SQL 명      : _suplerCeart.insertBeforePaasAnswer
     * 기능(설명)  : 입찰공고 PaaS 답변 등록
     * 작   성   자  : (주)엔키소프트
     * 작   성   일  : 2017-01-06
    -->
    <insert id="insertBeforePaasAnswer">
        /*_suplerCeart.insertBeforePaasAnswer*/
        INSERT INTO TCN_BEFORE_PAAS_I(NOTIFY_NUM
                                 , NOTIFY_SEQ
                                 , USER_ID
                                 , APPLY_GBN
                                 , LANG_SYS
                                 , FRAMEWORK_SYS
                                 , CACHE_SYS
                                 , DBMS_SYS
                                 , FAST_DEPLOY_SYS
                                 , ETC_SYS)
                            VALUES(#{notifyNum}
                                 , #{notifySeq}
                                 , #{suplerId}
                                 , #{applyGbn}
                                 , #{langSys}
                                 , #{frameworkSys}
                                 , #{cacheSys}
                                 , #{dbmsSys}
                                 , #{fastDeploySys}
                                 , #{etcSys})
    </insert>
    
    <!--
     * SQL 명        : _suplerCeart.insertBeforePaas2Answer
     * 기능(설명)    : 입찰공고 PaaS2 답변 등록
     * 작   성   자  : 이홍석
     * 작   성   일  : 2018-03
    -->
    <insert id="insertBeforePaas2Answer">
        
        /*_suplerCeart.insertBeforePaas2Answer*/
        
        INSERT INTO TCN_BEFORE_PAAS2_I ( NOTIFY_NUM
		                                ,NOTIFY_SEQ
		                                ,USER_ID
		                                ,APPLY_GBN
		                                ,HOSTINGMETHOD
                                        ,SCALING
                                        ,PLATFORM
                                        ,RUNTIMES
                                        ,MIDDLEWARE
                                        ,FRAMEWORKS
                                        ,SERVICES
                                        ,ADDONS
                                        ,EXTENDFUNCTION
                                        ,GEOLOCATIONS
		                               )
                                VALUES ( #{notifyNum}
                                        ,#{notifySeq}
                                        ,#{suplerId}
                                        ,#{applyGbn}
                                        ,#{hostingMethod}
                                        ,#{scaling}
                                        ,#{platform}
                                        ,#{runtimes}
                                        ,#{middlewares}
                                        ,#{frameworks}
                                        ,#{services}
                                        ,#{addons}
                                        ,#{extendFunction}
                                        ,#{geolocations}
                                       )
                                 
    </insert>

    <!--
     * SQL 명      : _suplerCeart.updateBeforePaasAnswer
     * 기능(설명)  : 입찰공고 PaaS 답변 수정
     * 작   성   자  : (주)엔키소프트
     * 작   성   일  : 2017-01-09
    -->
    <update id="updateBeforePaasAnswer">
        /*_suplerCeart.updateBeforePaasAnswer*/
        UPDATE TCN_BEFORE_PAAS_I SET  LANG_SYS         = #{langSys}
                                 , FRAMEWORK_SYS    = #{frameworkSys}
                                 , CACHE_SYS        = #{cacheSys}
                                 , DBMS_SYS         = #{dbmsSys}
                                 , FAST_DEPLOY_SYS  = #{fastDeploySys}
                                 , ETC_SYS          = #{etcSys}
         WHERE NOTIFY_NUM = #{notifyNum}
           AND NOTIFY_SEQ = #{notifySeq}
           AND USER_ID    = #{suplerId}
    </update>


    <!--
     * SQL 명      : _suplerCeart.insertBeforeSaasIAnswer
     * 기능(설명)  : 입찰공고 SaaS 마스터 답변 등록
     * 작   성   자  : (주)엔키소프트
     * 작   성   일  : 2017-01-05
    -->
    <insert id="insertBeforeSaasIAnswer">
        /*_suplerCeart.insertBeforeSaasIAnswer*/
        INSERT INTO TCN_BEFORE_SAAS_I(NOTIFY_NUM
                                 , NOTIFY_SEQ
                                 , USER_ID
                                 , APPLY_GBN
                                 , UNIT_SYS
                                 , ETC_UNIT_SYS
                                 , CAPTY_SYS
                                 , AMOUNT_SYS
                                 , SPLY_MOTH_SYS)
                            VALUES(#{notifyNum}
                                 , #{notifySeq}
                                 , #{suplerId}
                                 , #{applyGbn}
                                 , #{unitSys}
                                 , #{etcUnitSys}
                                 , #{captySys}
                                 , #{amountSys}
                                 , #{splyMothSys})
    </insert>

    <!--
     * SQL 명        : _suplerCeart.insertBeforeSaas2IAnswer
     * 기능(설명)    : 입찰공고 SaaS2 마스터 답변 등록
     * 작   성   자  : 이홍석
     * 작   성   일  : 2018-03
    -->
    <insert id="insertBeforeSaas2IAnswer">
        
        /*_suplerCeart.insertBeforeSaas2IAnswer*/
        
        INSERT INTO TCN_BEFORE_SAAS2_I ( NOTIFY_NUM
                                    	,NOTIFY_SEQ
                                    	,USER_ID
                                    	,APPLY_GBN
                                    	,SUPPORT_METHOD
                                    	,USER_MANAGER_SEPARATE
                                    	,SERVICE_SUPPLY_METHOD
                                    	,ENCRYPTION
                                    	,MULTIPLATFORM
                                   	   )
                                VALUES ( #{notifyNum}
                                    	,#{notifySeq}
                                    	,#{suplerId}
                                    	,#{applyGbn} 
                                    	,#{supportMethod}
                                    	,#{userManagerSeparate}
                                    	,#{serviceSupplyMethod}
                                    	,#{encryption}
                                    	,#{multiPlatform}
                                   	   )

    </insert>

    <!--
     * SQL 명      : _suplerCeart.updateBeforeSaasIAnswer
     * 기능(설명)  : 입찰공고 SaaS 마스터 답변 수정
     * 작   성   자  : (주)엔키소프트
     * 작   성   일  : 2017-01-10
    -->
    <update id="updateBeforeSaasIAnswer">
        /*_suplerCeart.updateBeforeSaasIAnswer*/
        UPDATE TCN_BEFORE_SAAS_I SET UNIT_SYS      = #{unitSys}
                                , ETC_UNIT_SYS  = #{etcUnitSys}
                                , CAPTY_SYS     = #{captySys}
                                , AMOUNT_SYS    = #{amountSys}
                                , SPLY_MOTH_SYS = #{splyMothSys}
         WHERE NOTIFY_NUM = #{notifyNum} 
           AND NOTIFY_SEQ = #{notifySeq}
           AND USER_ID    = #{suplerId}
    </update>

    <!--
     * SQL 명      : _suplerCeart.insertBeforeSaasDAnswer
     * 기능(설명)  : 입찰공고 SaaS 상세 답변 등록
     * 작   성   자  : (주)엔키소프트
     * 작   성   일  : 2017-01-05
    -->
    <insert id="insertBeforeSaasDAnswer">
        /*_suplerCeart.insertBeforeSaasDAnswer*/
        INSERT INTO TCN_BEFORE_SAAS_D(NOTIFY_NUM
                                 , NOTIFY_SEQ
                                 , USER_ID
                                 , APPLY_SEQ
                                 , OPTION_NM
                                 , UNIT_ITEM
                                 , CAPTY_ITEM
                                 , AMOUNT_ITEM
                                 , CMNT_ITEM)
                            VALUES(#{notifyNum}
                                 , #{notifySeq}
                                 , #{suplerId}
                                 , #{applySeq}
                                 , #{optionNm}
                                 , #{unitItem}
                                 , #{captyItem}
                                 , #{amountItem}
                                 , #{cmntItem})
    </insert>

    <!--
     * SQL 명        : _suplerCeart.updateBeforeSaas2NeedAnswer
     * 기능(설명)    : SaaS2 (추가사항)대표필요정보 등록 
     * 작   성   자  : 이홍석
     * 작   성   일  : 2018-03
    -->
    <update id="updateBeforeSaas2NeedAnswer" parameterType="map">
    
        /*_suplerCeart.updateBeforeSaas2NeedAnswer*/
        
        UPDATE TCN_BEFORE_SAAS2_I 
           SET NEED_FUNCTIONNAME = #{functionName} 
              ,NEED_AMOUNT       = #{amount}
              ,NEED_UNITCODE     = #{unitCode}
                            
         WHERE NOTIFY_NUM = #{notifyNum}
           AND NOTIFY_SEQ = #{notifySeq}
           AND APPLY_GBN  = 'Y'
           
    </update>


    <!--
     * SQL 명        : _suplerCeart.insertBeforeSaas2NeedAnswer
     * 기능(설명)    : 입찰공고 SaaS2 상세필요 답변 등록
     * 작   성   자  : 이홍석
     * 작   성   일  : 2018-03
    -->
    <insert id="insertBeforeSaas2NeedAnswer">
        
        <selectKey order="BEFORE" keyProperty="needSeq" resultType="int">
            SELECT NVL(MAX(NEED_SEQ), 0) + 1
              FROM TCN_BEFORE_SAAS2_DN
             WHERE NOTIFY_NUM = #{notifyNum}
               AND NOTIFY_SEQ = #{notifySeq}
               AND USER_ID    = #{suplerId}
        </selectKey>
		
		/*_suplerCeart.insertBeforeSaas2NeedAnswer*/
		
		INSERT INTO TCN_BEFORE_SAAS2_DN ( NOTIFY_NUM
							             ,NOTIFY_SEQ
							             ,USER_ID
							             ,NEED_SEQ
							             
							             ,FUNCTIONNAME
							             ,AMOUNT
							             ,UNITCODE
							            )
		                         VALUES ( #{notifyNum}
									     ,#{notifySeq}
									     ,#{suplerId}
									     ,#{needSeq}
									     
									     ,#{functionName}
									     ,#{amount}
									     ,#{unitCode}
									    )
        
    </insert>

    <!--
     * SQL 명        : _suplerCeart.updatetBeforeSaas2OptionAnswer 
     * 기능(설명)    : SaaS2 (추가사항)대표옵션정보 등록 
     * 작   성   자  : 이홍석
     * 작   성   일  : 2018-03
    -->
    <update id="updatetBeforeSaas2OptionAnswer" parameterType="map">
    
        /*_suplerCeart.updatetBeforeSaas2OptionAnswer*/
        
        UPDATE TCN_BEFORE_SAAS2_I 
           SET OPTION_FUNCTIONNAME = #{functionName} 
              ,OPTION_AMOUNT       = #{amount}
              ,OPTION_UNITCODE     = #{unitCode}
                            
         WHERE NOTIFY_NUM = #{notifyNum}
           AND NOTIFY_SEQ = #{notifySeq}
           AND APPLY_GBN  = 'Y'
           
    </update>

    <!--
     * SQL 명        : _suplerCeart.insertBeforeSaas2OptionAnswer
     * 기능(설명)    : 입찰공고 SaaS2 상세옵션 답변 등록
     * 작   성   자  : 이홍석
     * 작   성   일  : 2018-03
    -->
    <insert id="insertBeforeSaas2OptionAnswer">
        
        <selectKey order="BEFORE" keyProperty="optionSeq" resultType="int">
            SELECT NVL(MAX(NEED_SEQ), 0) + 1
              FROM TCN_BEFORE_SAAS2_DO
             WHERE NOTIFY_NUM = #{notifyNum}
               AND NOTIFY_SEQ = #{notifySeq}
               AND USER_ID    = #{suplerId}
               AND NEED_SEQ   = #{needSeq}
        </selectKey>
		
		/*_suplerCeart.insertBeforeSaas2OptionAnswer*/
		
		INSERT INTO TCN_BEFORE_SAAS2_DO ( NOTIFY_NUM
							             ,NOTIFY_SEQ
							             ,USER_ID
							             ,NEED_SEQ
							             ,OPTION_SEQ
							             
							             ,FUNCTIONNAME
							             ,AMOUNT
							             ,UNITCODE
							            )
		                         VALUES ( #{notifyNum}
									     ,#{notifySeq}
									     ,#{suplerId}
									     ,#{needSeq}
									     ,#{optionSeq}
									     
									     ,#{functionName}
									     ,#{amount}
									     ,#{unitCode}
									    )
        
    </insert>

    
    <!--
     * SQL 명        : _before.selectBeforeSaas2NeedSeq
     * 기능(설명)    : 입찰공고 SaaS2 상세필요의 현재 NEED_SEQ을 구한다.  
     * 작   성   자  : 이홍석
     * 작   성   일  : 2018-03
    -->
    <select id="selectBeforeSaas2NeedSeq" parameterType="SuplerCeartSaas2DnVO" resultType="int">
     	
     	/*_before.selectBeforeSaas2NeedSeq*/
     	      
        SELECT NVL(MAX(NEED_SEQ), 0)
          FROM TCN_BEFORE_SAAS2_DN
         WHERE NOTIFY_NUM = #{notifyNum}
           AND NOTIFY_SEQ = #{notifySeq}
           AND USER_ID    = #{suplerId}
    </select>

    <!--
     * SQL 명      : _suplerCeart.deleteBeforeSaasDAnswer
     * 기능(설명)  : 입찰공고 SaaS 상세 답변 등록
     * 작   성   자  : (주)엔키소프트
     * 작   성   일  : 2017-01-10
    -->
    <delete id="deleteBeforeSaasDAnswer">
        /*_suplerCeart.deleteBeforeSaasDAnswer*/
        DELETE FROM TCN_BEFORE_SAAS_D
         WHERE NOTIFY_NUM = #{notifyNum}
           AND NOTIFY_SEQ = #{notifySeq}
           AND USER_ID    = #{suplerId}
    </delete>

    <!--
     * SQL 명      : _suplerCeart.insertBeforeIaasIAnswer
     * 기능(설명)  : 입찰공고 IaaS 마스터 답변 등록
     * 작   성   자  : (주)엔키소프트
     * 작   성   일  : 2017-01-06
    -->
    <insert id="insertBeforeIaasIAnswer">
        /*_suplerCeart.insertBeforeIaasIAnswer*/
		INSERT INTO TCN_BEFORE_IAAS_I(NOTIFY_NUM
		                         , NOTIFY_SEQ
		                         , USER_ID
		                         , APPLY_GBN
		                         , CDN_TRANS_VLMN
		                         , CDN_REQU_CNT
		                         , WEB_GOODS_KIND
		                         , WEB_ACCESS
		                         , MNTING_VM
		                         , MNTING_ID_CNT
		                         , BAKUP_CNT
		                         , BAKUP_STORG
		                         , MANG_FUNC
		                         , SECTY_VPN
		                         , SECTY_SSLVPN
		                         , TECH_SUPT
		                         , FUNC_DMND1
		                         , FUNC_DMND2
		                         , FUNC_DMND3
		                         , FUNC_DMND4
		                         , INTERFACE_DMND
		                         , SECTY_DMND1
		                         , SECTY_DMND2
		                         , SECTY_DMND3
		                         , SECTY_DMND4
		                         , SECTY_DMND5
		                         , QUTY_DMND1
		                         , QUTY_DMND2
		                         , OPTN_DMND1
		                         , OPTN_DMND2
		                         , PRJT_DMND1
		                         , PRJT_DMND2
		                         , PRJT_DMND3
		                         , ETC_DMND)
						VALUES(#{notifyNum}
						     , #{notifySeq}
						     , #{suplerId}
						     , #{applyGbn}
						     , #{cdnTransVlmn}
						     , #{cdnRequCnt}
						     , #{webGoodsKind}
						     , #{webAccess}
						     , #{mntingVm}
						     , #{mntingIdCnt}
						     , #{bakupCnt}
						     , #{bakupStorg}
						     , #{mangFunc}
						     , #{sectyVpn}
						     , #{sectySslvpn}
						     , #{techSupt}
						     , #{funcDmnd1}
						     , #{funcDmnd2}
						     , #{funcDmnd3}
						     , #{funcDmnd4}
						     , #{interfaceDmnd}
						     , #{sectyDmnd1}
						     , #{sectyDmnd2}
						     , #{sectyDmnd3}
						     , #{sectyDmnd4}
						     , #{sectyDmnd5}
						     , #{qutyDmnd1}
						     , #{qutyDmnd2}
						     , #{optnDmnd1}
						     , #{optnDmnd2}
						     , #{prjtDmnd1}
						     , #{prjtDmnd2}
						     , #{prjtDmnd3}
						     , #{etcDmnd}
						     )
    </insert>

    <!--
     * SQL 명        : _suplerCeart.insertBeforeIaas2IAnswer
     * 기능(설명)    : 입찰공고 IaaS2 마스터 답변 등록
     * 작   성   자  : 이홍석
     * 작   성   일  : 2018-03
    -->
    <insert id="insertBeforeIaas2IAnswer">
        
        /*_suplerCeart.insertBeforeIaas2IAnswer*/
        
        INSERT INTO TCN_BEFORE_IAAS2_I ( NOTIFY_NUM
                                        ,NOTIFY_SEQ
                                        ,USER_ID
                                        ,APPLY_GBN
                                        
                                        ,CHK_DB
                                        ,CHK_STORAGE
                                        ,CHK_CDN
                                        ,CHK_WEBFIREWALL
                                        ,CHK_MONITORING
                                        ,CHK_BACKUP
                                        ,CHK_ADDEDSERVICE
                                        
                                        ,SERVER_IP
                                        ,SERVER_NETWORK
                                        ,SERVER_GSLB
                                        ,SERVER_LDBL
                                        ,SERVER_SNAP
                                        ,SERVER_IMG
                                        ,DB_IP
                                        ,DB_NETWORK
                                        ,DB_ADDDISK
                                        ,DB_BACKSTORG
                                        ,DB_STORG_SPACE
                                        ,DB_TRANS_VLMN
                                        ,CDN_TRANS_VLMN
                                        ,CDN_REQU_CNT
                                        ,WEB_GOODS_KIND
                                        ,WEB_ACCESS
                                        ,MNTING_VM
                                        ,MNTING_ID_CNT
                                        ,BAKUP_CNT
                                        ,BAKUP_STORG
                                        ,MANG_FUNC
                                        ,SECTY_VPN
                                        ,SECTY_SSLVPN
                                        ,ADDED_ETC 
                                       )
                                VALUES ( #{notifyNum}
                                        ,#{notifySeq}
                                        ,#{suplerId}
                                        ,#{applyGbn}

                                        ,#{chkDb}
                                        ,#{chkStorage}
                                        ,#{chkCdn}
                                        ,#{chkWebFirewall}
                                        ,#{chkMonitoring}
                                        ,#{chkBackup}
                                        ,#{chkAddedService}                                                                                

                                        ,#{serverIp} 
                                        ,#{serverNetwork} 
                                        ,#{serverGslb} 
                                        ,#{serverLdbl} 
                                        ,#{serverSnap} 
                                        ,#{serverImg}
                                        ,#{dbIp} 
                                        ,#{dbNetwork} 
                                        ,#{dbAddDisk}
                                        ,#{dbBackStorg} 
                                        ,#{dbStorgSpace} 
                                        ,#{dbTransVlmn}
                                        ,#{cdnTransVlmn} 
                                        ,#{cdnRequCnt} 
                                        ,#{webGoodsKind} 
                                        ,#{webAccess} 
                                        ,#{mntingVm} 
                                        ,#{mntingIdCnt}
                                        ,#{bakupCnt} 
                                        ,#{bakupStorg} 
                                        ,#{mangFunc} 
                                        ,#{sectyVpn} 
                                        ,#{sectySslvpn} 
                                        ,#{addedEtc} 
                                       )
                             
    </insert>

    <!--
     * SQL 명      : _suplerCeart.updateBeforeIaasIAnswer
     * 기능(설명)  : 입찰공고 IaaS 마스터 답변 수정
     * 작   성   자  : (주)엔키소프트
     * 작   성   일  : 2017-01-10
    -->
    <update id="updateBeforeIaasIAnswer">
        /*_suplerCeart.updateBeforeIaasIAnswer*/
        UPDATE TCN_BEFORE_IAAS_I SET CDN_TRANS_VLMN = #{cdnTransVlmn}
		                        , CDN_REQU_CNT   = #{cdnRequCnt}
		                        , WEB_GOODS_KIND = #{webGoodsKind}
		                        , WEB_ACCESS     = #{webAccess}
		                        , MNTING_VM      = #{mntingVm}
		                        , MNTING_ID_CNT  = #{mntingIdCnt}
		                        , BAKUP_CNT      = #{bakupCnt}
		                        , BAKUP_STORG    = #{bakupStorg}
		                        , MANG_FUNC      = #{mangFunc}
		                        , SECTY_VPN      = #{sectyVpn}
		                        , SECTY_SSLVPN   = #{sectySslvpn}
		                        , TECH_SUPT      = #{techSupt}
		                        , FUNC_DMND1     = #{funcDmnd1}
		                        , FUNC_DMND2     = #{funcDmnd2}
		                        , FUNC_DMND3     = #{funcDmnd3}
		                        , FUNC_DMND4     = #{funcDmnd4}
		                        , INTERFACE_DMND = #{interfaceDmnd}
		                        , SECTY_DMND1    = #{sectyDmnd1}
		                        , SECTY_DMND2    = #{sectyDmnd2}
		                        , SECTY_DMND3    = #{sectyDmnd3}
		                        , SECTY_DMND4    = #{sectyDmnd4}
		                        , SECTY_DMND5    = #{sectyDmnd5}
		                        , QUTY_DMND1     = #{qutyDmnd1}
		                        , QUTY_DMND2     = #{qutyDmnd2}
		                        , OPTN_DMND1     = #{optnDmnd1}
		                        , OPTN_DMND2     = #{optnDmnd2}
		                        , PRJT_DMND1     = #{prjtDmnd1}
		                        , PRJT_DMND2     = #{prjtDmnd2}
		                        , PRJT_DMND3     = #{prjtDmnd3}
		                        , ETC_DMND       = #{etcDmnd}
         WHERE NOTIFY_NUM = #{notifyNum}
           AND NOTIFY_SEQ = #{notifySeq}
           AND USER_ID    = #{suplerId}
    </update>

    <!--
     * SQL 명      : _suplerCeart.insertBeforeIaasDsAnswer
     * 기능(설명)  : 입찰공고 IaaS 서버 답변 등록
     * 작   성   자  : (주)엔키소프트
     * 작   성   일  : 2017-01-06
    -->
    <insert id="insertBeforeIaasDsAnswer">
        <selectKey order="BEFORE" keyProperty="applySeq" resultType="int">
            SELECT NVL(MAX(APPLY_SEQ), 0) + 1
              FROM TCN_BEFORE_IAAS_DS
             WHERE NOTIFY_NUM = #{notifyNum}
               AND NOTIFY_SEQ = #{notifySeq}
               AND USER_ID    = #{suplerId}
        </selectKey>
		/*_suplerCeart.insertBeforeIaasDsAnswer*/
		INSERT INTO TCN_BEFORE_IAAS_DS(NOTIFY_NUM
		                          , NOTIFY_SEQ
		                          , USER_ID
		                          , APPLY_SEQ
		                          , SERVER_USE
		                          , SERVER_OS
		                          , SERVER_CPU
		                          , SERVER_MEMORY
		                          , SERVER_DISK
		                          , SERVER_QNTY
		                          , SERVER_IP
		                          , SERVER_NETWORK
		                          , SERVER_GSLB
		                          , SERVER_LDBL
		                          , SERVER_SNAP
		                          , SERVER_IMG)
		                          
		VALUES(#{notifyNum}
		     , #{notifySeq}
		     , #{suplerId}
		     , #{applySeq}
		     , #{serverUse}
		     , #{serverOs}
		     , #{serverCpu}
		     , #{serverMemory}
		     , #{serverDisk}
		     , #{serverQnty}
		     , #{serverIp}
		     , #{serverNetwork}
		     , #{serverGslb}
		     , #{serverLdbl}
		     , #{serverSnap}
		     , #{serverImg}
		     )
    </insert>

    
    <!--
     * SQL 명        : _suplerCeart.updateBeforeIaas2DsAnswer
     * 기능(설명)    : IaaS2 (추가사항)대표서버정보 등록 
     * 작   성   자  : 이홍석
     * 작   성   일  : 2018-03
    -->
    <update id="updateBeforeIaas2DsAnswer">
    
        /*_suplerCeart.updateBeforeIaas2DsAnswer*/
        
        UPDATE TCN_BEFORE_IAAS2_I 
           SET SERVER_USE        = #{serverUse}
              ,SERVER_OS         = #{serverOs}
              ,SERVER_CPU        = #{serverCpu}
              ,SERVER_MEMORY     = #{serverMemory}
              ,SERVER_DISK       = #{serverDisk}
              ,SERVER_QNTY       = #{serverQnty}
                            
         WHERE NOTIFY_NUM = #{notifyNum}
           AND NOTIFY_SEQ = #{notifySeq}
           AND APPLY_GBN  = 'Y'
           
    </update>

    <!--
     * SQL 명        : _suplerCeart.insertBeforeIaas2DsAnswer
     * 기능(설명)    : 입찰공고 IaaS 서버 답변 등록
     * 작   성   자  : 이홍석
     * 작   성   일  : 2018-03
    -->
    <insert id="insertBeforeIaas2DsAnswer">
    
        <selectKey order="BEFORE" keyProperty="serverSeq" resultType="int">
            SELECT NVL(MAX(SERVER_SEQ), 0) + 1
              FROM TCN_BEFORE_IAAS2_DS
             WHERE NOTIFY_NUM = #{notifyNum}
               AND NOTIFY_SEQ = #{notifySeq}
               AND USER_ID    = #{suplerId}
        </selectKey>
        
		/*_suplerCeart.insertBeforeIaas2DsAnswer*/		
		
        INSERT INTO TCN_BEFORE_IAAS2_DS ( NOTIFY_NUM
                                         ,NOTIFY_SEQ
                                         ,USER_ID
                                         ,SERVER_SEQ
                                         
                                         ,SERVER_USE
                                         ,SERVER_OS
                                         ,SERVER_CPU
                                         ,SERVER_MEMORY
                                         ,SERVER_DISK
                                         ,SERVER_QNTY 
                                        )
                                 VALUES ( #{notifyNum}
									     ,#{notifySeq}
									     ,#{suplerId}
									     ,#{serverSeq}
									     
									     ,#{serverUse}
									     ,#{serverOs}
									     ,#{serverCpu}
									     ,#{serverMemory}
									     ,#{serverDisk}
									     ,#{serverQnty}
									     )
									     
    </insert>

    <!--
     * SQL 명      : _suplerCeart.deleteBeforeIaasDsAnswer
     * 기능(설명)  : 입찰공고 IaaS 서버 답변 삭제
     * 작   성   자  : (주)엔키소프트
     * 작   성   일  : 2017-01-10
    -->
    <delete id="deleteBeforeIaasDsAnswer">
		/*_suplerCeart.deleteBeforeIaasDsAnswer*/
		DELETE FROM TCN_BEFORE_IAAS_DS
		 WHERE NOTIFY_NUM = #{notifyNum}
		   AND NOTIFY_SEQ = #{notifySeq}
		   AND USER_ID    = #{suplerId}
    </delete>

    <!--
     * SQL 명      : _suplerCeart.insertBeforeIaasDdAnswer
     * 기능(설명)  : 입찰공고 IaaS DB 답변 등록
     * 작   성   자  : (주)엔키소프트
     * 작   성   일  : 2017-01-06
    -->
    <insert id="insertBeforeIaasDdAnswer">
        <selectKey order="BEFORE" keyProperty="applySeq" resultType="int">
            SELECT NVL(MAX(APPLY_SEQ), 0) + 1
              FROM TCN_BEFORE_IAAS_DD
             WHERE NOTIFY_NUM = #{notifyNum}
               AND NOTIFY_SEQ = #{notifySeq}
               AND USER_ID    = #{suplerId}
        </selectKey>
		/*_suplerCeart.insertBeforeIaasDdAnswer*/
		INSERT INTO TCN_BEFORE_IAAS_DD(NOTIFY_NUM
		                          , NOTIFY_SEQ
		                          , USER_ID
		                          , APPLY_SEQ
		                          , DB_USE
		                          , DB_OS
		                          , DB_CPU
		                          , DB_MEMORY
		                          , DB_DISK
		                          , DB_QNTY
		                          , DB_IP
		                          , DB_NETWORK
		                          , DB_ADD_DISK
		                          , DB_BACK_STORG
		                          , DB_STORG_SPACE
		                          , DB_TRANS_VLMN)
		                          
		VALUES(#{notifyNum}
		     , #{notifySeq}
		     , #{suplerId}
		     , #{applySeq}
		     , #{dbUse}
		     , #{dbOs}
		     , #{dbCpu}
		     , #{dbMemory}
		     , #{dbDisk}
		     , #{dbQnty}
		     , #{dbIp}
		     , #{dbNetwork}
		     , #{dbAddDisk}
		     , #{dbBackStorg}
		     , #{dbStorgSpace}
		     , #{dbTransVlmn}
		     )
    </insert>
    
    <!--
     * SQL 명        : _suplerCeart.updateBeforeIaas2DdAnswer
     * 기능(설명)    : IaaS2 (추가사항)대표DB정보 등록 
     * 작   성   자  : 이홍석
     * 작   성   일  : 2018-03
    -->
    <update id="updateBeforeIaas2DdAnswer">
    
        /*_suplerCeart.updateBeforeIaas2DdAnswer*/
        
        UPDATE TCN_BEFORE_IAAS2_I 
           SET DB_USE            = #{dbUse}
              ,DB_OS             = #{dbOs}
              ,DB_CPU            = #{dbCpu}
              ,DB_MEMORY         = #{dbMemory}
              ,DB_DISK           = #{dbDisk}
              ,DB_QNTY           = #{dbQnty}
              
         WHERE NOTIFY_NUM = #{notifyNum}
           AND NOTIFY_SEQ = #{notifySeq}
           AND APPLY_GBN  = 'Y'
           
    </update>

    <!--
     * SQL 명        : _suplerCeart.insertBeforeIaasDdAnswer
     * 기능(설명)    : 입찰공고 IaaS DB 답변 등록
     * 작   성   자  : 이홍석
     * 작   성   일  : 2018-03
    -->
    <insert id="insertBeforeIaas2DdAnswer">
    
        <selectKey order="BEFORE" keyProperty="dbSeq" resultType="int">
            SELECT NVL(MAX(DB_SEQ), 0) + 1
              FROM TCN_BEFORE_IAAS2_DD
             WHERE NOTIFY_NUM = #{notifyNum}
               AND NOTIFY_SEQ = #{notifySeq}
               AND USER_ID    = #{suplerId}
        </selectKey>
        
		/*_suplerCeart.insertBeforeIaas2DdAnswer*/
		
		INSERT INTO TCN_BEFORE_IAAS2_DD ( NOTIFY_NUM
		                                 ,NOTIFY_SEQ
		                                 ,USER_ID
		                                 ,DB_SEQ
		                                 ,DB_USE
		                                 ,DB_OS
		                                 ,DB_CPU
		                                 ,DB_MEMORY
		                                 ,DB_DISK
		                                 ,DB_QNTY 
	                                    )
		                         VALUES ( #{notifyNum}
									     ,#{notifySeq}
									     ,#{suplerId}
									     ,#{dbSeq}
									     ,#{dbUse}
									     ,#{dbOs}
									     ,#{dbCpu}
									     ,#{dbMemory}
									     ,#{dbDisk}
									     ,#{dbQnty}
									    )

    </insert>
    
    <!--
     * SQL 명        : _suplerCeart.insertBeforeScs2Answer
     * 기능(설명)    : 입찰공고 Scs2 답변 등록
     * 작   성   자  : 이홍석
     * 작   성   일  : 2018-03
    -->
    <insert id="insertBeforeScs2Answer">
        
        /*_suplerCeart.insertBeforeScs2Answer*/
        
        INSERT INTO TCN_BEFORE_SCS2_I (  NOTIFY_NUM
		                              , NOTIFY_SEQ
		                              , USER_ID
		                              , APPLY_GBN
		                              
		                              , CNSL_RELM
                                      , CNSL_RELM_ETC
                                      , CNSL_SCOPE
                                      , EXC_AREA
                                      , INDC_WHOLE
                                      , SETUP_MGR
                                      , OPER
                                      , QLITY_TEST
                                      , SCRTY
                                      , EDUCATION
		                              )
                               VALUES ( #{notifyNum}
                                      , #{notifySeq}
                                      , #{suplerId}
                                      , #{applyGbn}
                                        
                                      , #{cnslRelm}
                                      , #{cnslRelmEtc}
                                      , #{cnslScope}
                                      , #{excArea}
                                      , #{indcWhole}
                                      , #{setupMgr}                                      
                                      , #{oper}
                                      , #{qlityTest}
                                      , #{scrty}
                                      , #{education}
                                      )
                                 
    </insert>
    

    <!--
     * SQL 명      : _suplerCeart.deleteBeforeIaasDdAnswer
     * 기능(설명)  : 입찰공고 IaaS DB 답변 삭제
     * 작   성   자  : (주)엔키소프트
     * 작   성   일  : 2017-01-10
    -->
    <delete id="deleteBeforeIaasDdAnswer">
		/*_suplerCeart.deleteBeforeIaasDdAnswer*/
		DELETE FROM TCN_BEFORE_IAAS_DD
		 WHERE NOTIFY_NUM = #{notifyNum}
		   AND NOTIFY_SEQ = #{notifySeq}
		   AND USER_ID    = #{suplerId}
    </delete>
    
    
       <!--
     * SQL 명      : _suplerCeart.buyUserList
     * 기능(설명)  : 구매자선택 팝업
     * 작   성   자  : (주)엔키소프트
     * 작   성   일  : 2017-01-19
    -->
    <select id="buyUserList" parameterType="map" resultType="SuplerServiceVO">
        /*_suplerCeart.buyUserList*/
        SELECT Y.* 
          FROM (SELECT ROWNUM NUM
                     , X.*
                  FROM (  SELECT A.USER_ID AS commUserId
					           , A.USER_NM AS commUserNm
					           , B.CMPNY_NM AS cmpnyNm 
						    FROM OP_USER A, OP_USER_ENTRPRS_OPTION B
						   WHERE 1= 1
						     AND A.USER_ID = B.USER_ID
						     AND USER_TY_CD  IN ('2001','2002','3002')
						     AND USER_STTUS_CD='1001'
						     <choose>
	                             <when test="searchDiv01 == 1001">
	                                 <if test="searchKeyWord != null  and searchKeyWord != ''">
	                                      AND B.CMPNY_NM LIKE '%'||#{searchKeyWord}||'%'
	                                 </if>
	                             </when>
	                             <when test="searchDiv01 == 1002">
	                                 <if test="searchKeyWord != null  and searchKeyWord != ''">
	                                     AND A.USER_NM LIKE '%'||#{searchKeyWord}||'%'
	                                 </if>
	                             </when>
	                         </choose>
	                         <if test="commUserId != null  and commUserId != ''">
	                                     AND A.USER_ID = commUserId
	                          </if>
						   UNION ALL
						  SELECT A.USER_ID AS commUserId
					           , A.USER_NM AS commUserNm
					           , C.ORGN_NM AS cmpnyNm 
						    FROM OP_USER A, OP_USER_PBLINSTT_OPTION B,  TCN_ORGN_INFO_D C
						   WHERE 1= 1
						     AND A.USER_ID = B.USER_ID
						     AND B.ORGN_CODE = C.ORGN_CODE
						     AND B.BUSEO_CODE = C.BUSEO_CODE
						     AND A.USER_TY_CD  ='3001'
						     AND A.USER_STTUS_CD='1001'
					        <choose>
	                             <when test="searchDiv01 == 1001">
	                                 <if test="searchKeyWord != null  and searchKeyWord != ''">
	                                      AND C.ORGN_NM LIKE '%'||#{searchKeyWord}||'%'
	                                 </if>
	                             </when>
	                             <when test="searchDiv01 == 1002">
	                                 <if test="searchKeyWord != null  and searchKeyWord != ''">
	                                     AND A.USER_NM LIKE '%'||#{searchKeyWord}||'%'
	                                 </if>
	                             </when>
	                         </choose>
         					<if test="commUserId != null  and commUserId != ''">
	                                     AND A.USER_ID = commUserId
	                         </if>
			           ) X WHERE ROWNUM &lt;= #{pagingEndNum}
		    ) Y WHERE NUM &gt;= #{pagingStartNum}
    </select>
    
    <select id="buyUserInfo" parameterType="map" resultType="SuplerServiceVO">
        /*_suplerCeart.buyUserInfo*/
			SELECT A.USER_ID AS commUserId
	           , A.USER_NM AS commUserNm
	           , B.CMPNY_NM AS cmpnyNm 
		    FROM OP_USER A, OP_USER_ENTRPRS_OPTION B
		   WHERE 1= 1
		     AND A.USER_ID = B.USER_ID
		     AND USER_TY_CD  IN ('1001','1002','2001','2002')
		     AND USER_STTUS_CD='1001'
		     AND A.USER_ID = #{commUserId}
		   UNION ALL
		  SELECT A.USER_ID AS commUserId
	           , A.USER_NM AS commUserNm
	           , C.ORGN_NM AS cmpnyNm 
		    FROM OP_USER A, OP_USER_PBLINSTT_OPTION B,  TCN_ORGN_INFO_D C
		   WHERE 1= 1
		     AND A.USER_ID = B.USER_ID
		     AND B.ORGN_CODE = C.ORGN_CODE
		     AND B.BUSEO_CODE = C.BUSEO_CODE
		     AND A.USER_TY_CD  IN ('3001','3002')
		     AND A.USER_STTUS_CD='1001'
	         AND A.USER_ID = #{commUserId}
    </select>
    
    
    <select id="buyUserListCount" parameterType="map" resultType="int"> 
        /*_suplerCeart.buyUserListCount*/
        SELECT COUNT(1) AS totalCount 
          FROM (  SELECT A.USER_ID AS commUserId
				        , A.USER_NM AS commUserNm
				        , B.CMPNY_NM AS cmpnyNm 
				       
				  FROM OP_USER A, OP_USER_ENTRPRS_OPTION B
				 WHERE 1= 1
				   AND A.USER_ID = B.USER_ID
				   AND USER_TY_CD  IN ('2001','2002','3002')
				   AND USER_STTUS_CD='1001'
				   <choose>
                       <when test="searchDiv01 == 1001">
                           <if test="searchKeyWord != null  and searchKeyWord != ''">
                                AND B.CMPNY_NM LIKE '%'||#{searchKeyWord}||'%'
                           </if>
                       </when>
                       <when test="searchDiv01 == 1002">
                           <if test="searchKeyWord != null  and searchKeyWord != ''">
                               AND A.USER_NM LIKE '%'||#{searchKeyWord}||'%'
                           </if>
                       </when>
                   </choose>
				 UNION ALL
				SELECT A.USER_ID AS commUserId
				        , A.USER_NM AS commUserNm
				        , C.ORGN_NM AS cmpnyNm 
				       
				  FROM OP_USER A, OP_USER_PBLINSTT_OPTION B,  TCN_ORGN_INFO_D C
				 WHERE 1= 1
				   AND A.USER_ID = B.USER_ID
				   AND B.ORGN_CODE = C.ORGN_CODE
				   AND B.BUSEO_CODE = C.BUSEO_CODE
				   AND A.USER_TY_CD  ='3001'
				   <choose>
                       <when test="searchDiv01 == 1001">
                           <if test="searchKeyWord != null  and searchKeyWord != ''">
                                AND C.ORGN_NM LIKE '%'||#{searchKeyWord}||'%'
                           </if>
                       </when>
                       <when test="searchDiv01 == 1002">
                           <if test="searchKeyWord != null  and searchKeyWord != ''">
                               AND A.USER_NM LIKE '%'||#{searchKeyWord}||'%'
                           </if>
                       </when>
                   </choose>
				 
      ) 
		    
    </select>
    <select  id="cntrctDtlInfo" parameterType="map" resultType="SuplerCntrctVO">
  	 	/*_suplerCeart.cntrctDtlInfo*/
        SELECT A.CNTRCT_SN                             AS cntrctSn
             , A.USER_ID                               AS suplerId
             , A.SVC_NM                                AS svcNm
             , TO_DATE(A.CNTRCT_BEGIN_DE, 'YYYYMMDD')  AS cntrctBeginDe
             , TO_DATE(A.CNTRCT_END_DE, 'YYYYMMDD')    AS cntrctEndDe
             , A.CNTRCTAMOUNT                          AS cntrctamount
             , A.CNTR_COUNT                            AS cntrCount
             , A.PURCHS_INSTT_NM                       AS purchsInsttNm
             , A.SLE_INSTT_NM                          AS sleInsttNm
             , A.GOODS_CODE                            AS goodsCode
             , B.GOODS_NM                              AS goodsNm
             , A.SPLY_FORM                             AS splyForm
             , CASE WHEN A.SPLY_FORM = '1' THEN '월단위'
                    WHEN A.SPLY_FORM = '2' THEN '년단위'
                    WHEN A.SPLY_FORM = '0' THEN '기타'
                                            END splyFormNm
             , A.SPLY_FORM_ETC                         AS splyFormEtc
             , TO_CHAR(A.CNTR_DT, 'YYYY-MM-DD')        AS cntrDt
             , A.CTRTC_SN                              AS ctrtcSn
             , C.LOCAL_ORGINL_NM                       AS ctrtcSnOrgNm
             , C.FILE_ID                               AS ctrtcSnId
             , C.FILE_SIZE                             AS ctrtcSnSize
             , C.FILE_TY                               AS ctrtcSnTy
             , A.CERT_RESULT_CODE                      AS certResultCode
             , A.REGIST_MTHD_CODE                      AS registMthdCode
             , A.COMM_USER_ID                          AS commUserId
             , ifnull(E.USER_NM,F.USER_NM)             AS commUserNm
             , D.USER_NM		  	  				   AS userNm
             <!--  비회원자  정보 -->
             , A.TEMP_USER_SN						   AS userSn	 /*비회원자 순번(코드)*/
             , DECRYPT(F.EMAIL,'P008')				   AS Email 	 /*비회원 이메일*/
             , DECRYPT(F.MBTLNUM, 'P007')			   AS mbtlnum 	 /*비회원 휴대폰*/
             , F.USER_TY_CD							   AS sbscrbTyCd /*구분(3002 공공, 2002 민간)*/ 
             , F.ORGN_CODE							   AS orgnCode   /*기관코드*/
             , F.BUSEO_CODE							   AS buseoCode  /*부서코드*/
             , NVL(( SELECT ORGN_NM FROM tcn_orgn_info_d O WHERE  F.ORGN_CODE	 = O.ORGN_CODE  and F.ORGN_CODE	 = O.BUSEO_CODE LIMIT 1 ), F.ORGN_CODE) AS orgnNm 
             , NVL(( SELECT ORGN_NM_ST FROM tcn_orgn_info_d O WHERE F.ORGN_CODE	 = O.ORGN_CODE and F.BUSEO_CODE	 = O.BUSEO_CODE LIMIT 1 ), F.BUSEO_CODE) AS buseoNm
             , F.USER_TY_CD							   AS sbscrbTyCd
              , F.CMPNY_NM							   AS cmpnyNm
          FROM  TCM_CNTRCT_MANAGE_I A
	          , TST_GOOD_INFO_I B
	          , OP_FILE C
	          , (  SELECT  A.USER_ID
				         , A.USER_NM 
				         , B.CMPNY_NM
				     FROM OP_USER A, OP_USER_ENTRPRS_OPTION B
			     	WHERE 1 =1 
				      AND A.USER_ID = B.USER_ID
					  AND A.USER_STTUS_CD='1001'
	             ) D  /*회원자저보 가져오기*/
	          ,OP_USER E
	          ,TCM_CNTRCT_TEMP_USER F 
      WHERE 1 = 1
          AND A.GOODS_CODE = B.GOODS_CODE(+)
          AND A.CTRTC_SN = C.FILE_SEQ(+)
          AND A.COMM_USER_ID = E.USER_ID(+)
          AND A.TEMP_USER_SN = F.USER_SN(+)
          <!-- AND E.USER_STTUS_CD='1001' -->
          AND A.USER_ID = D.USER_ID(+)
          AND A.CNTRCT_SN = #{cntrctSn}
  	</select>
  	
<!--  계약체결 서비스 상세 -->
  	 <select  id="cntrctDetail" parameterType="map" resultType="SuplerCntrctVO">
  	 	/*_suplerCeart.cntrctDetail*/
        SELECT A.CNTRCT_SN                             AS cntrctSn				/*계약번호*/
        	 , A.CNTR_NUM	                           AS cntrNum
             , A.USER_ID                               AS suplerId				
             , A.SVC_NM                                AS svcNm					/*사업명*/
             , TO_CHAR(A.CNTR_DT, 'YYYY-MM-DD')        AS cntrDt				/*계약체결일*/
             , TO_DATE(A.CNTRCT_BEGIN_DE, 'YYYYMMDD')  AS cntrctBeginDe			/*계약기간-시작*/
             , TO_DATE(A.CNTRCT_END_DE, 'YYYYMMDD')    AS cntrctEndDe			/*계약기간-종료*/
             , (CASE WHEN B.BUSEO_CODE = 'ZZZZZZZ' THEN '2002' 
               ELSE '3002' END)						   AS sbscrbTyCd			/*계약정보의 이용자구분 */
             , B.BUSEO_CODE							   AS orgnCode				/*계약정보의 기관코드 */
             , B.ORGN_NM							   AS orgnNm				/*계약정보의 기관명 혹은 회사명 */
             , A.PURCHS_INSTT_NM                       AS purchsInsttNm			/*이용기관명*/
             , A.CTRTC_SN                              AS ctrtcSn				/*계약서 첨부 일련번호*/
             ,  IFNULL(A.USER_SE,3)					   AS userSe				/*이용자구분*/
             , A.SPORT_AT							   AS sportAt		
             , C.REALORGNM							   AS realOrgNm
             , C.REALBUESOCNT						   AS realBuesoCnt
          FROM  TCM_CNTRCT_MANAGE_I A
	         LEFT JOIN TCM_RL_USER_I B ON A.CNTRCT_SN = B.CNTRCT_SN AND RL_CNTRCT_INSTT_AT =  'N'
	         LEFT JOIN (SELECT MIN(ORGN_NM) AS REALORGNM, 
	         				   COUNT(CNTRCT_SN)-1 AS REALBUESOCNT, CNTRCT_SN  
	         		      FROM TCM_RL_USER_I 
	         		     WHERE RL_CNTRCT_INSTT_AT =  'Y'
	         		  GROUP BY  CNTRCT_SN) C ON A.CNTRCT_SN = C.CNTRCT_SN 
      WHERE 1 = 1
        AND A.CNTRCT_SN = #{cntrctSn}
  	</select>
  	
<!--  계약체결 서비스 리스트 -->
  	<select  id="cntrctGoodsList" parameterType="map" resultType="SuplerCntrctGoodsVO">
  		/*_suplerCeart.cntrctGoodsList*/
		 SELECT A.CNTRCT_SVC_SN 	AS cntrctSvcSn, 
				A.CNTRCT_SN 	  	AS cntrctSn,
				A.GOODS_CODE		AS goodsCode,
				B.GOODS_NM 			AS goodsName,
				A.SPLY_FORM 		AS splyForm,
				A.SPLY_FORM_ETC		AS splyFormEtc, 
				A.CNTRCT_COUNT		AS cntrctCount, 
				A.CNTRCT_AMOUNT		AS cntrctAmount
		   FROM TCM_CNTRCT_SERVICE_I A
      LEFT JOIN TST_GOOD_INFO_I B	   ON A.GOODS_CODE = B.GOODS_CODE
		  WHERE A.CNTRCT_SN = #{cntrctSn}
	  ORDER BY CNTRCT_SVC_SN ASC
  	</select>
  	
<!--  계약체결 서비스 등록/업데이트 -->
    <update id="mergeCntrctGoodsInfo"  parameterType="SuplerCntrctGoodsVO">
    /*_suplerCeart.mergeCntrctGoodsInfo*/
        MERGE INTO TCM_CNTRCT_SERVICE_I A
             USING (SELECT #{cntrctSn} AS CNTRCT_SN, #{cntrctSvcSn} AS CNTRCT_SVC_SN ) S
           ON ( A.CNTRCT_SN = S.CNTRCT_SN AND A.CNTRCT_SVC_SN = S.CNTRCT_SVC_SN)
        WHEN MATCHED
        THEN
           UPDATE SET A.SPLY_FORM       = #{splyForm}
                    , A.SPLY_FORM_ETC 	= #{splyFormEtc}
                    , A.CNTRCT_AMOUNT 	= REPLACE(#{cntrctAmount},',','')
        WHEN NOT MATCHED
        THEN
           INSERT     (  A.CNTRCT_SN,
                         A.GOODS_CODE,
                         A.SPLY_FORM,
                         A.SPLY_FORM_ETC,
                         A.CNTRCT_AMOUNT)
               VALUES   (#{cntrctSn},
                         #{goodsCode},
                         #{splyForm},
                         #{splyFormEtc},
                         REPLACE(#{cntrctAmount},',','')) 
    </update>
    
<!--  계약체결 서비스 삭제 -->
    <delete id="cntrctGoodsNotDelete"  parameterType="SuplerCntrctGoodsVO">
    /*_suplerCeart.cntrctGoodsDelete*/
  		DELETE FROM TCM_CNTRCT_SERVICE_I
  		 WHERE CNTRCT_SN =  #{cntrctSn} 
  		  AND CNTRCT_SVC_SN 
  			<foreach collection="cntrctSvcSns" item="sn" index="index"	separator="," open="NOT IN (" close=") ">
				TRIM(#{sn})
			</foreach>
  	</delete>
  	
  	  <!--
     * SQL 명      : _suplerCeart.insertSuplerCntrctCmpl
     * 기능(설명)  : 계약관리정보 등록
     * 작   성   자  : (주)엔키소프트
     * 작   성   일  : 2017-01-19
    -->
    <insert id="insertSuplerCntrctCmpl">
    /*_suplerCeart.insertSuplerCntrctCmpl*/
    	INSERT INTO TCM_CNTRCT_MANAGE_I
      (
         USER_ID						/* 마스터아이디(공급자) */
       , SVC_NM 						/* 사업명*/
       , BUSEO_CODE					/* 기관코드*/
       , CNTR_DT			
       , CNTRCT_BEGIN_DE
       , CNTRCT_END_DE	
       , PURCHS_INSTT_NM 		/*이용회사명*/
       , SLE_INSTT_NM 			/*판매회사명*/ 
       , CTRTC_SN						/*계약서파일*/
       , COMM_USER_ID
       , REGIST_ID		
       , REGIST_DT		
       , DELETE_AT		
       , CNTR_NUM		
       , REGIST_MTHD_CODE
       , CNTRCTAMOUNT 
      )
      VALUES
      (
         #{suplerId}
       , #{svcNm}
       , #{buseoCode}
       , #{cntrDt}
       , REPLACE(#{cntrctBeginDe}, '-', '')
       , REPLACE(#{cntrctEndDe}, '-', '')
       , #{purchsInsttNm}
       , #{sleInsttNm}
       , #{ctrtcSn}
       , #{commUserId}
       , #{registId}
       , SYSDATETIME
       , 'Y'
       , SELECT	TO_CHAR(SYSDATE,'YYYY-MM')||LPAD(IFNULL(MAX(SUBSTR(CNTR_NUM ,8 ,12)),0)+1,4,'0') FROM	TCM_CNTRCT_MANAGE_I WHERE  SUBSTR(CNTR_NUM ,1 ,7) =  TO_CHAR(SYSDATE,'YYYY-MM'), 1001, 0)
        <selectKey order="AFTER" keyProperty="cntrctSn" resultType="int">
		     SELECT LAST_INSERT_ID()
				</selectKey>
    </insert>

	<update id="mergeRLuserInfo" parameterType="SuplerCntrctVO">
	/*_suplerCeart.mergeRLuserInfo*/
		MERGE INTO TCM_RL_USER_I A
    USING (SELECT #{cntrctSn} AS CNTRCT_SN,  #{rlCntrctInsttAt} AS RL_CNTRCT_INSTT_AT) S
       ON ( A.CNTRCT_SN  = S.CNTRCT_SN AND  A.RL_CNTRCT_INSTT_AT = S.RL_CNTRCT_INSTT_AT)
     WHEN MATCHED THEN
          UPDATE 
             SET BUSEO_CODE =	#{buseoCode},
    		  		   ORGN_NM	 =  #{buseoNm}
     WHEN NOT MATCHED THEN
          INSERT
          ( 
             A.CNTRCT_SN
           , A.BUSEO_CODE
           , A.ORGN_NM
           , A.RL_CNTRCT_INSTT_AT
          )
          VALUES
          (
             #{cntrctSn}
           , #{buseoCode}
           , #{buseoNm}
           , #{rlCntrctInsttAt}
          )
    </update>
    
    <delete id="deleteRLuserInfo" parameterType="SuplerCntrctVO">
    	DELETE FROM TCM_RL_USER_I
    	 WHERE CNTRCT_SN  =  #{cntrctSn} 
    		<if test="buseoCode != null  and buseoCode != ''">
    			AND BUSEO_CODE = #{buseoCode}
    		</if>
    		<if test="buseoCode == null  or buseoCode == ''">
    			AND BUSEO_CODE != #{buseoCode}
    		</if>
    		AND RL_CNTRCT_INSTT_AT ='Y'
    </delete>
    
   
	<delete id="deleteRLuserInitInfo" parameterType="SuplerCntrctVO">
    	DELETE FROM TCM_RL_USER_I
    	 WHERE CNTRCT_SN  =  #{cntrctSn} 
    		AND RL_CNTRCT_INSTT_AT ='Y'
    </delete>
    <!--
     * SQL 명      : _suplerCeart.updateSuplerCntrctCmpl
     * 기능(설명)  : 계약관리정보 수정
     * 작   성   자  : (주)엔키소프트
     * 작   성   일  : 2017-01-19
    -->
    <update id="updateSuplerCntrctCmpl">
        /*_suplerCeart.updateSuplerCntrctCmpl*/
        UPDATE TCM_CNTRCT_MANAGE_I SET USER_ID         = #{suplerId}
                                     , SVC_NM          = #{svcNm}
                                     , CNTRCT_BEGIN_DE = REPLACE(#{cntrctBeginDe}, '-', '')
                                     , CNTRCT_END_DE   = REPLACE(#{cntrctEndDe}, '-', '')
                                     , CNTR_DT         = #{cntrDt}
                                     , PURCHS_INSTT_NM = #{purchsInsttNm}
                                     , CTRTC_SN        = #{ctrtcSn}
                                     , USER_SE		   = #{userSe}
                                     , SPORT_AT		   = #{sportAt}
                                     , UPDT_ID         = #{suplerId}
                                     , UPDT_DT         = SYSDATETIME
                                     <!--
                                     , CNTRCTAMOUNT    = #{cntrctamount}
                                     , GOODS_CODE      = #{goodsCode}
                                    
                                     , SPLY_FORM       = #{splyForm}
                                     , SPLY_FORM_ETC   = #{splyFormEtc}
                                     , CNTR_COUNT      = #{cntrCount}
                                     , TEMP_USER_SN    = #{userSn} -->
         WHERE CNTRCT_SN = #{cntrctSn}
    </update>
    <update id="updateSuplerCntrctCmpl2">
        /*_suplerCeart.updateSuplerCntrctCmpl2*/
        UPDATE TCM_CNTRCT_MANAGE_I SET USER_ID         = #{suplerId}
                                     , SVC_NM          = #{svcNm}
                                     , CNTRCT_BEGIN_DE = REPLACE(#{cntrctBeginDe}, '-', '')
                                     , CNTRCT_END_DE   = REPLACE(#{cntrctEndDe}, '-', '')
                                     , CNTR_DT         = #{cntrDt}
                                     , PURCHS_INSTT_NM = #{purchsInsttNm}
                                     , CTRTC_SN        = #{ctrtcSn}
                                     , USER_SE		   = #{userSe}
                                     , SPORT_AT		   = #{sportAt}
                                     , UPDT_ID         = #{updtId}
                                     , UPDT_DT         = SYSDATETIME
                                     <!--
                                     , CNTRCTAMOUNT    = #{cntrctamount}
                                     , GOODS_CODE      = #{goodsCode}
                                    
                                     , SPLY_FORM       = #{splyForm}
                                     , SPLY_FORM_ETC   = #{splyFormEtc}
                                     , CNTR_COUNT      = #{cntrCount}
                                     , TEMP_USER_SN    = #{userSn} -->
         WHERE CNTRCT_SN = #{cntrctSn}
    </update>
    
    <select id="selectCntrcnUserInfor" parameterType="registerUserVO" resultType="registerUserVO">
        /* _register.selectCntrcnUserInfor */
        SELECT <if test="userTyCd != 3001 and userTyCd != 3002">
	              'ZZZZZZZ' AS buseoCode
	              ,B.CMPNY_NM AS orgnNm
           	   </if>
              <if test="userTyCd == 3001 or userTyCd == 3002">
	              B.BUSEO_CODE AS buseoCode
	           	  ,NVL((
					  	SELECT  ORGN_NM
					  	FROM tcn_orgn_info_d D
					  	WHERE B.ORGN_CODE  = D.ORGN_CODE
					  	  AND B.BUSEO_CODE = D.BUSEO_CODE
					  	LIMIT 1
				  	   ), B.ORGN_CODE) AS orgnNm
			  </if>
          FROM OP_USER A
          LEFT JOIN
               ${tableId} B
            ON B.USER_ID = A.USER_ID
         WHERE A.USER_ID = #{userId}
    </select>
    
	<!-- * 기능(설명)  : 수기계약 입력시 비회원자 정보등록 
	2017-12-12 TCM_RL_USER_I으로 이관하면서 사용하지 않는 테이블 
	-->
	
    <!--    <insert id="insertSuplerTempUser">
        <selectKey order="BEFORE" keyProperty="userSn" resultType="int">
            SELECT NVL(MAX(USER_SN), 0) + 1 FROM TCM_CNTRCT_TEMP_USER 
        </selectKey>
        /*_suplerCeart.insertSuplerTempUser*/
        INSERT INTO TCM_CNTRCT_TEMP_USER(USER_SN 	임시아이디
                                      , USER_NM		담당자명
                                      , EMAIL		이메일
                                      , MBTLNUM		휴대폰전화
                                      , USER_TY_CD	구분(공고기관/민간기업)
                                      , ORGN_CODE	공공코드
                                      , BUSEO_CODE	부서코드
                                      , CMPNY_NM	회사명
                                      , REGIST_ID	등록일
                                      , REGIST_DT)	등록날짜
                                 VALUES(#{userSn}
                                      , #{userNm}
                                      , encrypt(#{email}, 'P008')
                                      , encrypt(#{mbtlnum}, 'P007')
                                      , #{sbscrbTyCd}
                                      , #{orgnCode}
                                      , #{buseoCode}
                                      , #{cmpnyNm}
                                      , #{suplerId}
                                      , SYSDATETIME
                                     )
  	  </insert>
    
     <update id="updateSuplerTempUser">
        /*_suplerCeart.updateSuplerTempUser*/
        UPDATE TCM_CNTRCT_TEMP_USER SET USER_NM         = #{userNm}
                                      , EMAIL			= encrypt(#{email}, 'P008')
                                      , MBTLNUM			= encrypt(#{mbtlnum}, 'P007')
                                      , USER_TY_CD		=  #{sbscrbTyCd}
                                      , ORGN_CODE		=  #{orgnCode}
                                      , BUSEO_CODE		=  #{buseoCode}
                                      , CMPNY_NM		=  #{cmpnyNm}
                                      , UPDT_ID			=  #{suplerId}
                                      , UPDT_DT			= SYSDATETIME
         WHERE USER_SN = #{userSn}
    </update> -->
	<select id="selectCntrctGoodsInfoCount" parameterType="map" resultType="int">
		select * from TCM_CNTRCT_MANAGE_I
	</select>    
    <insert id="InsertImmeServiceRegist">
    /*_suplerCeart.InsertImmeServiceRegist*/
    
        <selectKey order="BEFORE" keyProperty="goodsCode" resultType="string">
            SELECT '1111' || imme_goods_seq.NEXT_VALUE
        </selectKey>
    
        INSERT INTO TST_GOOD_INFO_I
        			(
						goods_code
						,user_id
						,lang_code
						,goods_nm
						,goods_regist_sttus
						,goods_actvty_at
						,regist_id
						,regist_dt        			
        			)
          VALUES	
          			(
          				#{goodsCode}
          				,'kwonc'
          				,'00'
          				,#{goodsNm}
          				,'1007'
          				,'N'
          				,'ceartmanager01'
          				,SYSDATETIME
          			)
        			
    </insert>
	
</mapper>